<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="sw1kwon">
<meta name="dcterms.date" content="2025-07-15">

<title>Governor Elections 6th (v0) – Elections</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-0626ff4d7a71b55c8707dcae1d04a9b6.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-3f453be5ec2ee49e579b43b94346acdb.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Elections</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com"> <i class="bi bi-twitter" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Governor Elections 6th (v0)</h1>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>sw1kwon </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">July 15, 2025</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#th_2014" id="toc-th_2014" class="nav-link active" data-scroll-target="#th_2014">6th_2014</a>
  <ul class="collapse">
  <li><a href="#raw-data" id="toc-raw-data" class="nav-link" data-scroll-target="#raw-data">Raw Data</a>
  <ul class="collapse">
  <li><a href="#section" id="toc-section" class="nav-link" data-scroll-target="#section">1</a></li>
  <li><a href="#section-1" id="toc-section-1" class="nav-link" data-scroll-target="#section-1">2</a></li>
  <li><a href="#section-2" id="toc-section-2" class="nav-link" data-scroll-target="#section-2">3</a></li>
  <li><a href="#section-3" id="toc-section-3" class="nav-link" data-scroll-target="#section-3">4</a></li>
  <li><a href="#section-4" id="toc-section-4" class="nav-link" data-scroll-target="#section-4">5</a></li>
  <li><a href="#section-5" id="toc-section-5" class="nav-link" data-scroll-target="#section-5">6</a></li>
  </ul></li>
  <li><a href="#seoul-3" id="toc-seoul-3" class="nav-link" data-scroll-target="#seoul-3">Seoul (3)</a></li>
  <li><a href="#busan-6" id="toc-busan-6" class="nav-link" data-scroll-target="#busan-6">Busan (6)</a></li>
  <li><a href="#daegu-4" id="toc-daegu-4" class="nav-link" data-scroll-target="#daegu-4">Daegu (4)</a></li>
  <li><a href="#incheon-1" id="toc-incheon-1" class="nav-link" data-scroll-target="#incheon-1">Incheon (1)</a></li>
  <li><a href="#gwangju-3" id="toc-gwangju-3" class="nav-link" data-scroll-target="#gwangju-3">Gwangju (3)</a></li>
  <li><a href="#daejeon-3" id="toc-daejeon-3" class="nav-link" data-scroll-target="#daejeon-3">Daejeon (3)</a></li>
  <li><a href="#ulsan-1" id="toc-ulsan-1" class="nav-link" data-scroll-target="#ulsan-1">Ulsan (1)</a></li>
  <li><a href="#sejong-5" id="toc-sejong-5" class="nav-link" data-scroll-target="#sejong-5">Sejong (5)</a></li>
  <li><a href="#gyeonggi-1" id="toc-gyeonggi-1" class="nav-link" data-scroll-target="#gyeonggi-1">Gyeonggi (1)</a></li>
  <li><a href="#gangwon-1" id="toc-gangwon-1" class="nav-link" data-scroll-target="#gangwon-1">Gangwon (1)</a></li>
  <li><a href="#chungbuk-5" id="toc-chungbuk-5" class="nav-link" data-scroll-target="#chungbuk-5">Chungbuk (5)</a></li>
  <li><a href="#chungnam-1" id="toc-chungnam-1" class="nav-link" data-scroll-target="#chungnam-1">Chungnam (1)</a></li>
  <li><a href="#jeonbuk-1" id="toc-jeonbuk-1" class="nav-link" data-scroll-target="#jeonbuk-1">Jeonbuk (1)</a></li>
  <li><a href="#jeonnam-1" id="toc-jeonnam-1" class="nav-link" data-scroll-target="#jeonnam-1">Jeonnam (1)</a></li>
  <li><a href="#gyeongbuk-2" id="toc-gyeongbuk-2" class="nav-link" data-scroll-target="#gyeongbuk-2">Gyeongbuk (2)</a></li>
  <li><a href="#gyeongnam-1" id="toc-gyeongnam-1" class="nav-link" data-scroll-target="#gyeongnam-1">Gyeongnam (1)</a></li>
  <li><a href="#jeju-2" id="toc-jeju-2" class="nav-link" data-scroll-target="#jeju-2">Jeju (2)</a></li>
  </ul></li>
  <li><a href="#batch-csv-files-to-zip" id="toc-batch-csv-files-to-zip" class="nav-link" data-scroll-target="#batch-csv-files-to-zip">Batch CSV Files to ZIP</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<section id="th_2014" class="level1">
<h1>6th_2014</h1>
<section id="raw-data" class="level2">
<h2 class="anchored" data-anchor-id="raw-data">Raw Data</h2>
<section id="section" class="level3">
<h3 class="anchored" data-anchor-id="section">1</h3>
<div id="cell-4" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> convert_github_url_to_raw(github_url):</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co">    깃허브 blob URL을 raw URL로 변환</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co">    Parameters:</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co">    -----------</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co">    github_url : str</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co">        깃허브 파일 URL</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns:</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co">    --------</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co">    str</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="co">        raw URL (pandas가 직접 읽을 수 있는 형태)</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="st">'/blob/'</span> <span class="kw">in</span> github_url:</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> github_url.replace(<span class="st">'/blob/'</span>, <span class="st">'/raw/'</span>)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> github_url</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> process_6th_governor_election1(</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>    file_path_or_url,</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>    header_rows<span class="op">=</span>(<span class="dv">2</span>, <span class="dv">4</span>),  <span class="co"># 엑셀 기준 행 번호 (2행부터 4행까지)</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>    filter_column<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>    filter_value<span class="op">=</span><span class="va">None</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="co">    선거 데이터를 유연하게 처리하는 함수</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a><span class="co">    Parameters:</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="co">    -----------</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a><span class="co">    file_path_or_url : str</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a><span class="co">        로컬 파일 경로 또는 GitHub URL</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a><span class="co">    header_rows : tuple</span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a><span class="co">        헤더로 사용할 행 범위 (엑셀 기준 행 번호)</span></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a><span class="co">        예: (2, 4) = 2행부터 4행까지</span></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a><span class="co">    filter_column : str, optional</span></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a><span class="co">        필터링할 컬럼명 (예: '읍면동명')</span></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a><span class="co">    filter_value : str, optional</span></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a><span class="co">        필터링할 값 (예: '합계')</span></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns:</span></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a><span class="co">    --------</span></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a><span class="co">    pandas.DataFrame</span></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a><span class="co">        처리된 데이터프레임</span></span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a><span class="co">    Example:</span></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a><span class="co">    --------</span></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a><span class="co">    # 2~4행을 헤더로, '읍면동명'이 '합계'인 행만 추출</span></span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a><span class="co">    df = process_6th_governor_election1(</span></span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a><span class="co">        'https://github.com/.../강원도지사선거.xlsx',</span></span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a><span class="co">        header_rows=(2, 4),</span></span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a><span class="co">        filter_column='읍면동명',</span></span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a><span class="co">        filter_value='합계'</span></span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a><span class="co">    )</span></span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>    <span class="co"># GitHub URL인 경우 raw URL로 변환</span></span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> file_path_or_url.startswith(<span class="st">'https://github.com'</span>):</span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>        file_path_or_url <span class="op">=</span> convert_github_url_to_raw(file_path_or_url)</span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 파일을 header 없이 읽기</span></span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>    df_raw <span class="op">=</span> pd.read_excel(file_path_or_url, header<span class="op">=</span><span class="va">None</span>)</span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 엑셀 행 번호를 파이썬 인덱스로 변환 (엑셀은 1부터, 파이썬은 0부터)</span></span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>    start_idx <span class="op">=</span> header_rows[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>    end_idx <span class="op">=</span> header_rows[<span class="dv">1</span>] <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 지정된 행들을 가져와서 컬럼명 생성</span></span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a>    header_rows_data <span class="op">=</span> []</span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(start_idx, end_idx <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a>        header_rows_data.append(df_raw.iloc[i].fillna(<span class="st">'_'</span>).astype(<span class="bu">str</span>))</span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 컬럼명 생성</span></span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a>    new_columns <span class="op">=</span> []</span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> col_idx <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(header_rows_data[<span class="dv">0</span>])):</span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a>        parts <span class="op">=</span> []</span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 각 행의 값이 '_'가 아닌 경우만 추가</span></span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> row_data <span class="kw">in</span> header_rows_data:</span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> row_data[col_idx] <span class="op">!=</span> <span class="st">'_'</span>:</span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a>                parts.append(row_data[col_idx])</span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a>        <span class="co"># parts가 비어있으면 '_', 아니면 '_'로 연결</span></span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> parts:</span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a>            new_columns.append(<span class="st">'_'</span>.join(parts))</span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true" tabindex="-1"></a>            new_columns.append(<span class="st">'_'</span>)</span>
<span id="cb1-90"><a href="#cb1-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-91"><a href="#cb1-91" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 데이터프레임 재구성 (헤더 다음 행부터 데이터로 사용)</span></span>
<span id="cb1-92"><a href="#cb1-92" aria-hidden="true" tabindex="-1"></a>    data_start_idx <span class="op">=</span> end_idx <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb1-93"><a href="#cb1-93" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> df_raw.iloc[data_start_idx:].copy()</span>
<span id="cb1-94"><a href="#cb1-94" aria-hidden="true" tabindex="-1"></a>    df.columns <span class="op">=</span> new_columns</span>
<span id="cb1-95"><a href="#cb1-95" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> df.reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb1-96"><a href="#cb1-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-97"><a href="#cb1-97" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"헤더 행: </span><span class="sc">{</span>header_rows[<span class="dv">0</span>]<span class="sc">}</span><span class="ss">행 ~ </span><span class="sc">{</span>header_rows[<span class="dv">1</span>]<span class="sc">}</span><span class="ss">행"</span>)</span>
<span id="cb1-98"><a href="#cb1-98" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"생성된 컬럼 수: </span><span class="sc">{</span><span class="bu">len</span>(new_columns)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb1-99"><a href="#cb1-99" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"데이터 행 수: </span><span class="sc">{</span><span class="bu">len</span>(df)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb1-100"><a href="#cb1-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-101"><a href="#cb1-101" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 컬럼명 샘플 출력</span></span>
<span id="cb1-102"><a href="#cb1-102" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">생성된 컬럼명 (처음 10개):"</span>)</span>
<span id="cb1-103"><a href="#cb1-103" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, col <span class="kw">in</span> <span class="bu">enumerate</span>(new_columns[:<span class="dv">10</span>]):</span>
<span id="cb1-104"><a href="#cb1-104" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>col<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb1-105"><a href="#cb1-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-106"><a href="#cb1-106" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 필터링 적용</span></span>
<span id="cb1-107"><a href="#cb1-107" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> filter_column <span class="kw">and</span> filter_value:</span>
<span id="cb1-108"><a href="#cb1-108" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 필터링할 컬럼 찾기</span></span>
<span id="cb1-109"><a href="#cb1-109" aria-hidden="true" tabindex="-1"></a>        matching_col <span class="op">=</span> <span class="va">None</span></span>
<span id="cb1-110"><a href="#cb1-110" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> col <span class="kw">in</span> df.columns:</span>
<span id="cb1-111"><a href="#cb1-111" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> filter_column <span class="kw">in</span> col:</span>
<span id="cb1-112"><a href="#cb1-112" aria-hidden="true" tabindex="-1"></a>                matching_col <span class="op">=</span> col</span>
<span id="cb1-113"><a href="#cb1-113" aria-hidden="true" tabindex="-1"></a>                <span class="cf">break</span></span>
<span id="cb1-114"><a href="#cb1-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-115"><a href="#cb1-115" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> matching_col:</span>
<span id="cb1-116"><a href="#cb1-116" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">'</span><span class="sc">{</span>filter_column<span class="sc">}</span><span class="ss">' 컬럼 발견: </span><span class="sc">{</span>matching_col<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb1-117"><a href="#cb1-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-118"><a href="#cb1-118" aria-hidden="true" tabindex="-1"></a>            <span class="co"># 필터링 적용</span></span>
<span id="cb1-119"><a href="#cb1-119" aria-hidden="true" tabindex="-1"></a>            filtered_df <span class="op">=</span> df[df[matching_col] <span class="op">==</span> filter_value].copy()</span>
<span id="cb1-120"><a href="#cb1-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-121"><a href="#cb1-121" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"필터링 전: </span><span class="sc">{</span><span class="bu">len</span>(df)<span class="sc">}</span><span class="ss">행 → 필터링 후: </span><span class="sc">{</span><span class="bu">len</span>(filtered_df)<span class="sc">}</span><span class="ss">행"</span>)</span>
<span id="cb1-122"><a href="#cb1-122" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"'</span><span class="sc">{</span>matching_col<span class="sc">}</span><span class="ss">' == '</span><span class="sc">{</span>filter_value<span class="sc">}</span><span class="ss">'인 행만 추출"</span>)</span>
<span id="cb1-123"><a href="#cb1-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-124"><a href="#cb1-124" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> filtered_df</span>
<span id="cb1-125"><a href="#cb1-125" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb1-126"><a href="#cb1-126" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">경고: '</span><span class="sc">{</span>filter_column<span class="sc">}</span><span class="ss">'을 포함하는 컬럼을 찾을 수 없습니다."</span>)</span>
<span id="cb1-127"><a href="#cb1-127" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">"필터링 없이 전체 데이터를 반환합니다."</span>)</span>
<span id="cb1-128"><a href="#cb1-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-129"><a href="#cb1-129" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df</span>
<span id="cb1-130"><a href="#cb1-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-131"><a href="#cb1-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-132"><a href="#cb1-132" aria-hidden="true" tabindex="-1"></a><span class="co"># 사용 예시</span></span>
<span id="cb1-133"><a href="#cb1-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-134"><a href="#cb1-134" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. 강원도지사선거 - 2~4행을 헤더로, '읍면동명'이 '합 계'인 행만</span></span>
<span id="cb1-135"><a href="#cb1-135" aria-hidden="true" tabindex="-1"></a><span class="co"># url = "https://github.com/.../강원도지사선거.xlsx"</span></span>
<span id="cb1-136"><a href="#cb1-136" aria-hidden="true" tabindex="-1"></a><span class="co"># summary_df = process_6th_governor_election1(</span></span>
<span id="cb1-137"><a href="#cb1-137" aria-hidden="true" tabindex="-1"></a><span class="co">#     url,</span></span>
<span id="cb1-138"><a href="#cb1-138" aria-hidden="true" tabindex="-1"></a><span class="co">#     header_rows=(2, 4),</span></span>
<span id="cb1-139"><a href="#cb1-139" aria-hidden="true" tabindex="-1"></a><span class="co">#     filter_column='읍면동명',</span></span>
<span id="cb1-140"><a href="#cb1-140" aria-hidden="true" tabindex="-1"></a><span class="co">#     filter_value='합 계'</span></span>
<span id="cb1-141"><a href="#cb1-141" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span>
<span id="cb1-142"><a href="#cb1-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-143"><a href="#cb1-143" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. 다른 파일 - 1~3행을 헤더로, 필터링 없이</span></span>
<span id="cb1-144"><a href="#cb1-144" aria-hidden="true" tabindex="-1"></a><span class="co"># df_all = process_6th_governor_election1(</span></span>
<span id="cb1-145"><a href="#cb1-145" aria-hidden="true" tabindex="-1"></a><span class="co">#     'other_file.xlsx',</span></span>
<span id="cb1-146"><a href="#cb1-146" aria-hidden="true" tabindex="-1"></a><span class="co">#     header_rows=(1, 3)</span></span>
<span id="cb1-147"><a href="#cb1-147" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span>
<span id="cb1-148"><a href="#cb1-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-149"><a href="#cb1-149" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. 로컬 파일 - 기본값 사용</span></span>
<span id="cb1-150"><a href="#cb1-150" aria-hidden="true" tabindex="-1"></a><span class="co"># df = process_6th_governor_election1('강원도지사선거.xlsx')</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="section-1" class="level3">
<h3 class="anchored" data-anchor-id="section-1">2</h3>
<div id="cell-6" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> convert_github_url_to_raw(github_url):</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co">    깃허브 blob URL을 raw URL로 변환</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co">    Parameters:</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="co">    -----------</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="co">    github_url : str</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="co">        깃허브 파일 URL</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns:</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="co">    --------</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="co">    str</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="co">        raw URL (pandas가 직접 읽을 수 있는 형태)</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="st">'/blob/'</span> <span class="kw">in</span> github_url:</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> github_url.replace(<span class="st">'/blob/'</span>, <span class="st">'/raw/'</span>)</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> github_url</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> process_6th_governor_election2(</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>    file_path_or_url,</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>    header_rows<span class="op">=</span>(<span class="dv">2</span>, <span class="dv">4</span>),  <span class="co"># 엑셀 기준 행 번호 (2행부터 4행까지)</span></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>    filter_column<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>    filter_value<span class="op">=</span><span class="va">None</span></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a><span class="co">    선거 데이터를 유연하게 처리하는 함수 (복수 필터값 지원)</span></span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a><span class="co">    Parameters:</span></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a><span class="co">    -----------</span></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a><span class="co">    file_path_or_url : str</span></span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a><span class="co">        로컬 파일 경로 또는 GitHub URL</span></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a><span class="co">    header_rows : tuple</span></span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a><span class="co">        헤더로 사용할 행 범위 (엑셀 기준 행 번호)</span></span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a><span class="co">        예: (2, 4) = 2행부터 4행까지</span></span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a><span class="co">    filter_column : str, optional</span></span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a><span class="co">        필터링할 컬럼명 (예: '읍면동명')</span></span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a><span class="co">    filter_value : str, list, or None, optional</span></span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a><span class="co">        필터링할 값 또는 값들의 리스트</span></span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a><span class="co">        - str: 단일 값 (예: '합계')</span></span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a><span class="co">        - list: 복수 값 (예: [np.nan, '합계'])</span></span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a><span class="co">        - None: NaN 값만 필터링</span></span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns:</span></span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a><span class="co">    --------</span></span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a><span class="co">    pandas.DataFrame</span></span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a><span class="co">        처리된 데이터프레임</span></span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a><span class="co">    Example:</span></span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a><span class="co">    --------</span></span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a><span class="co">    # NaN과 '합계' 모두 포함</span></span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a><span class="co">    df = process_6th_governor_election2(</span></span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a><span class="co">        '경상북도.xlsx',</span></span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true" tabindex="-1"></a><span class="co">        header_rows=(2, 4),</span></span>
<span id="cb2-58"><a href="#cb2-58" aria-hidden="true" tabindex="-1"></a><span class="co">        filter_column='읍면동명',</span></span>
<span id="cb2-59"><a href="#cb2-59" aria-hidden="true" tabindex="-1"></a><span class="co">        filter_value=[np.nan, '합계']</span></span>
<span id="cb2-60"><a href="#cb2-60" aria-hidden="true" tabindex="-1"></a><span class="co">    )</span></span>
<span id="cb2-61"><a href="#cb2-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-62"><a href="#cb2-62" aria-hidden="true" tabindex="-1"></a><span class="co">    # NaN 값만 포함</span></span>
<span id="cb2-63"><a href="#cb2-63" aria-hidden="true" tabindex="-1"></a><span class="co">    df = process_6th_governor_election2(</span></span>
<span id="cb2-64"><a href="#cb2-64" aria-hidden="true" tabindex="-1"></a><span class="co">        '경상북도.xlsx',</span></span>
<span id="cb2-65"><a href="#cb2-65" aria-hidden="true" tabindex="-1"></a><span class="co">        header_rows=(2, 4),</span></span>
<span id="cb2-66"><a href="#cb2-66" aria-hidden="true" tabindex="-1"></a><span class="co">        filter_column='읍면동명',</span></span>
<span id="cb2-67"><a href="#cb2-67" aria-hidden="true" tabindex="-1"></a><span class="co">        filter_value=None</span></span>
<span id="cb2-68"><a href="#cb2-68" aria-hidden="true" tabindex="-1"></a><span class="co">    )</span></span>
<span id="cb2-69"><a href="#cb2-69" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb2-70"><a href="#cb2-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-71"><a href="#cb2-71" aria-hidden="true" tabindex="-1"></a>    <span class="co"># GitHub URL인 경우 raw URL로 변환</span></span>
<span id="cb2-72"><a href="#cb2-72" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> file_path_or_url.startswith(<span class="st">'https://github.com'</span>):</span>
<span id="cb2-73"><a href="#cb2-73" aria-hidden="true" tabindex="-1"></a>        file_path_or_url <span class="op">=</span> convert_github_url_to_raw(file_path_or_url)</span>
<span id="cb2-74"><a href="#cb2-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-75"><a href="#cb2-75" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 파일을 header 없이 읽기</span></span>
<span id="cb2-76"><a href="#cb2-76" aria-hidden="true" tabindex="-1"></a>    df_raw <span class="op">=</span> pd.read_excel(file_path_or_url, header<span class="op">=</span><span class="va">None</span>)</span>
<span id="cb2-77"><a href="#cb2-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-78"><a href="#cb2-78" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 엑셀 행 번호를 파이썬 인덱스로 변환 (엑셀은 1부터, 파이썬은 0부터)</span></span>
<span id="cb2-79"><a href="#cb2-79" aria-hidden="true" tabindex="-1"></a>    start_idx <span class="op">=</span> header_rows[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb2-80"><a href="#cb2-80" aria-hidden="true" tabindex="-1"></a>    end_idx <span class="op">=</span> header_rows[<span class="dv">1</span>] <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb2-81"><a href="#cb2-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-82"><a href="#cb2-82" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 지정된 행들을 가져와서 컬럼명 생성</span></span>
<span id="cb2-83"><a href="#cb2-83" aria-hidden="true" tabindex="-1"></a>    header_rows_data <span class="op">=</span> []</span>
<span id="cb2-84"><a href="#cb2-84" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(start_idx, end_idx <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb2-85"><a href="#cb2-85" aria-hidden="true" tabindex="-1"></a>        header_rows_data.append(df_raw.iloc[i].fillna(<span class="st">'_'</span>).astype(<span class="bu">str</span>))</span>
<span id="cb2-86"><a href="#cb2-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-87"><a href="#cb2-87" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 컬럼명 생성</span></span>
<span id="cb2-88"><a href="#cb2-88" aria-hidden="true" tabindex="-1"></a>    new_columns <span class="op">=</span> []</span>
<span id="cb2-89"><a href="#cb2-89" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> col_idx <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(header_rows_data[<span class="dv">0</span>])):</span>
<span id="cb2-90"><a href="#cb2-90" aria-hidden="true" tabindex="-1"></a>        parts <span class="op">=</span> []</span>
<span id="cb2-91"><a href="#cb2-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-92"><a href="#cb2-92" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 각 행의 값이 '_'가 아닌 경우만 추가</span></span>
<span id="cb2-93"><a href="#cb2-93" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> row_data <span class="kw">in</span> header_rows_data:</span>
<span id="cb2-94"><a href="#cb2-94" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> row_data[col_idx] <span class="op">!=</span> <span class="st">'_'</span>:</span>
<span id="cb2-95"><a href="#cb2-95" aria-hidden="true" tabindex="-1"></a>                parts.append(row_data[col_idx])</span>
<span id="cb2-96"><a href="#cb2-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-97"><a href="#cb2-97" aria-hidden="true" tabindex="-1"></a>        <span class="co"># parts가 비어있으면 '_', 아니면 '_'로 연결</span></span>
<span id="cb2-98"><a href="#cb2-98" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> parts:</span>
<span id="cb2-99"><a href="#cb2-99" aria-hidden="true" tabindex="-1"></a>            new_columns.append(<span class="st">'_'</span>.join(parts))</span>
<span id="cb2-100"><a href="#cb2-100" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb2-101"><a href="#cb2-101" aria-hidden="true" tabindex="-1"></a>            new_columns.append(<span class="st">'_'</span>)</span>
<span id="cb2-102"><a href="#cb2-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-103"><a href="#cb2-103" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 데이터프레임 재구성 (헤더 다음 행부터 데이터로 사용)</span></span>
<span id="cb2-104"><a href="#cb2-104" aria-hidden="true" tabindex="-1"></a>    data_start_idx <span class="op">=</span> end_idx <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb2-105"><a href="#cb2-105" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> df_raw.iloc[data_start_idx:].copy()</span>
<span id="cb2-106"><a href="#cb2-106" aria-hidden="true" tabindex="-1"></a>    df.columns <span class="op">=</span> new_columns</span>
<span id="cb2-107"><a href="#cb2-107" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> df.reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb2-108"><a href="#cb2-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-109"><a href="#cb2-109" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"헤더 행: </span><span class="sc">{</span>header_rows[<span class="dv">0</span>]<span class="sc">}</span><span class="ss">행 ~ </span><span class="sc">{</span>header_rows[<span class="dv">1</span>]<span class="sc">}</span><span class="ss">행"</span>)</span>
<span id="cb2-110"><a href="#cb2-110" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"생성된 컬럼 수: </span><span class="sc">{</span><span class="bu">len</span>(new_columns)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb2-111"><a href="#cb2-111" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"데이터 행 수: </span><span class="sc">{</span><span class="bu">len</span>(df)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb2-112"><a href="#cb2-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-113"><a href="#cb2-113" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 컬럼명 샘플 출력</span></span>
<span id="cb2-114"><a href="#cb2-114" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">생성된 컬럼명 (처음 10개):"</span>)</span>
<span id="cb2-115"><a href="#cb2-115" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, col <span class="kw">in</span> <span class="bu">enumerate</span>(new_columns[:<span class="dv">10</span>]):</span>
<span id="cb2-116"><a href="#cb2-116" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>col<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb2-117"><a href="#cb2-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-118"><a href="#cb2-118" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 필터링 적용</span></span>
<span id="cb2-119"><a href="#cb2-119" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> filter_column <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb2-120"><a href="#cb2-120" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 필터링할 컬럼 찾기</span></span>
<span id="cb2-121"><a href="#cb2-121" aria-hidden="true" tabindex="-1"></a>        matching_col <span class="op">=</span> <span class="va">None</span></span>
<span id="cb2-122"><a href="#cb2-122" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> col <span class="kw">in</span> df.columns:</span>
<span id="cb2-123"><a href="#cb2-123" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> filter_column <span class="kw">in</span> col:</span>
<span id="cb2-124"><a href="#cb2-124" aria-hidden="true" tabindex="-1"></a>                matching_col <span class="op">=</span> col</span>
<span id="cb2-125"><a href="#cb2-125" aria-hidden="true" tabindex="-1"></a>                <span class="cf">break</span></span>
<span id="cb2-126"><a href="#cb2-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-127"><a href="#cb2-127" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> matching_col:</span>
<span id="cb2-128"><a href="#cb2-128" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">'</span><span class="sc">{</span>filter_column<span class="sc">}</span><span class="ss">' 컬럼 발견: </span><span class="sc">{</span>matching_col<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb2-129"><a href="#cb2-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-130"><a href="#cb2-130" aria-hidden="true" tabindex="-1"></a>            <span class="co"># filter_value 처리</span></span>
<span id="cb2-131"><a href="#cb2-131" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> filter_value <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb2-132"><a href="#cb2-132" aria-hidden="true" tabindex="-1"></a>                <span class="co"># None인 경우 NaN만 필터링</span></span>
<span id="cb2-133"><a href="#cb2-133" aria-hidden="true" tabindex="-1"></a>                filtered_df <span class="op">=</span> df[df[matching_col].isna()].copy()</span>
<span id="cb2-134"><a href="#cb2-134" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f"필터링: NaN 값만 추출"</span>)</span>
<span id="cb2-135"><a href="#cb2-135" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> <span class="bu">isinstance</span>(filter_value, <span class="bu">list</span>):</span>
<span id="cb2-136"><a href="#cb2-136" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 리스트인 경우 복수 값 필터링</span></span>
<span id="cb2-137"><a href="#cb2-137" aria-hidden="true" tabindex="-1"></a>                <span class="co"># NaN 값과 일반 값을 분리해서 처리</span></span>
<span id="cb2-138"><a href="#cb2-138" aria-hidden="true" tabindex="-1"></a>                conditions <span class="op">=</span> []</span>
<span id="cb2-139"><a href="#cb2-139" aria-hidden="true" tabindex="-1"></a>                non_nan_values <span class="op">=</span> []</span>
<span id="cb2-140"><a href="#cb2-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-141"><a href="#cb2-141" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> val <span class="kw">in</span> filter_value:</span>
<span id="cb2-142"><a href="#cb2-142" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> pd.isna(val):</span>
<span id="cb2-143"><a href="#cb2-143" aria-hidden="true" tabindex="-1"></a>                        conditions.append(df[matching_col].isna())</span>
<span id="cb2-144"><a href="#cb2-144" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">else</span>:</span>
<span id="cb2-145"><a href="#cb2-145" aria-hidden="true" tabindex="-1"></a>                        non_nan_values.append(val)</span>
<span id="cb2-146"><a href="#cb2-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-147"><a href="#cb2-147" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 일반 값들에 대한 조건 추가</span></span>
<span id="cb2-148"><a href="#cb2-148" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> non_nan_values:</span>
<span id="cb2-149"><a href="#cb2-149" aria-hidden="true" tabindex="-1"></a>                    conditions.append(df[matching_col].isin(non_nan_values))</span>
<span id="cb2-150"><a href="#cb2-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-151"><a href="#cb2-151" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 모든 조건을 OR로 결합</span></span>
<span id="cb2-152"><a href="#cb2-152" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> conditions:</span>
<span id="cb2-153"><a href="#cb2-153" aria-hidden="true" tabindex="-1"></a>                    combined_condition <span class="op">=</span> conditions[<span class="dv">0</span>]</span>
<span id="cb2-154"><a href="#cb2-154" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">for</span> condition <span class="kw">in</span> conditions[<span class="dv">1</span>:]:</span>
<span id="cb2-155"><a href="#cb2-155" aria-hidden="true" tabindex="-1"></a>                        combined_condition <span class="op">=</span> combined_condition <span class="op">|</span> condition</span>
<span id="cb2-156"><a href="#cb2-156" aria-hidden="true" tabindex="-1"></a>                    filtered_df <span class="op">=</span> df[combined_condition].copy()</span>
<span id="cb2-157"><a href="#cb2-157" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb2-158"><a href="#cb2-158" aria-hidden="true" tabindex="-1"></a>                    filtered_df <span class="op">=</span> df.copy()</span>
<span id="cb2-159"><a href="#cb2-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-160"><a href="#cb2-160" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f"필터링: </span><span class="sc">{</span>filter_value<span class="sc">}</span><span class="ss"> 값들 중 하나인 행 추출"</span>)</span>
<span id="cb2-161"><a href="#cb2-161" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb2-162"><a href="#cb2-162" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 단일 값인 경우</span></span>
<span id="cb2-163"><a href="#cb2-163" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> pd.isna(filter_value):</span>
<span id="cb2-164"><a href="#cb2-164" aria-hidden="true" tabindex="-1"></a>                    filtered_df <span class="op">=</span> df[df[matching_col].isna()].copy()</span>
<span id="cb2-165"><a href="#cb2-165" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb2-166"><a href="#cb2-166" aria-hidden="true" tabindex="-1"></a>                    filtered_df <span class="op">=</span> df[df[matching_col] <span class="op">==</span> filter_value].copy()</span>
<span id="cb2-167"><a href="#cb2-167" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f"필터링: '</span><span class="sc">{</span>matching_col<span class="sc">}</span><span class="ss">' == '</span><span class="sc">{</span>filter_value<span class="sc">}</span><span class="ss">'인 행 추출"</span>)</span>
<span id="cb2-168"><a href="#cb2-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-169"><a href="#cb2-169" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"필터링 전: </span><span class="sc">{</span><span class="bu">len</span>(df)<span class="sc">}</span><span class="ss">행 → 필터링 후: </span><span class="sc">{</span><span class="bu">len</span>(filtered_df)<span class="sc">}</span><span class="ss">행"</span>)</span>
<span id="cb2-170"><a href="#cb2-170" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> filtered_df</span>
<span id="cb2-171"><a href="#cb2-171" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb2-172"><a href="#cb2-172" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">경고: '</span><span class="sc">{</span>filter_column<span class="sc">}</span><span class="ss">'을 포함하는 컬럼을 찾을 수 없습니다."</span>)</span>
<span id="cb2-173"><a href="#cb2-173" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">"필터링 없이 전체 데이터를 반환합니다."</span>)</span>
<span id="cb2-174"><a href="#cb2-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-175"><a href="#cb2-175" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df</span>
<span id="cb2-176"><a href="#cb2-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-177"><a href="#cb2-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-178"><a href="#cb2-178" aria-hidden="true" tabindex="-1"></a><span class="co"># 사용 예시</span></span>
<span id="cb2-179"><a href="#cb2-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-180"><a href="#cb2-180" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. 경상북도.xlsx - NaN과 '합계' 모두 포함</span></span>
<span id="cb2-181"><a href="#cb2-181" aria-hidden="true" tabindex="-1"></a><span class="co"># df_multi = process_6th_governor_election2(</span></span>
<span id="cb2-182"><a href="#cb2-182" aria-hidden="true" tabindex="-1"></a><span class="co">#     '경상북도.xlsx',</span></span>
<span id="cb2-183"><a href="#cb2-183" aria-hidden="true" tabindex="-1"></a><span class="co">#     header_rows=(2, 4),</span></span>
<span id="cb2-184"><a href="#cb2-184" aria-hidden="true" tabindex="-1"></a><span class="co">#     filter_column='읍면동명',</span></span>
<span id="cb2-185"><a href="#cb2-185" aria-hidden="true" tabindex="-1"></a><span class="co">#     filter_value=[np.nan, '합계']</span></span>
<span id="cb2-186"><a href="#cb2-186" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span>
<span id="cb2-187"><a href="#cb2-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-188"><a href="#cb2-188" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. NaN 값만 필터링</span></span>
<span id="cb2-189"><a href="#cb2-189" aria-hidden="true" tabindex="-1"></a><span class="co"># df_nan_only = process_6th_governor_election2(</span></span>
<span id="cb2-190"><a href="#cb2-190" aria-hidden="true" tabindex="-1"></a><span class="co">#     '경상북도.xlsx',</span></span>
<span id="cb2-191"><a href="#cb2-191" aria-hidden="true" tabindex="-1"></a><span class="co">#     header_rows=(2, 4),</span></span>
<span id="cb2-192"><a href="#cb2-192" aria-hidden="true" tabindex="-1"></a><span class="co">#     filter_column='읍면동명',</span></span>
<span id="cb2-193"><a href="#cb2-193" aria-hidden="true" tabindex="-1"></a><span class="co">#     filter_value=None  # None은 NaN만 필터링</span></span>
<span id="cb2-194"><a href="#cb2-194" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span>
<span id="cb2-195"><a href="#cb2-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-196"><a href="#cb2-196" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. 여러 값 필터링 (NaN, '합계', '소계')</span></span>
<span id="cb2-197"><a href="#cb2-197" aria-hidden="true" tabindex="-1"></a><span class="co"># df_multiple = process_6th_governor_election2(</span></span>
<span id="cb2-198"><a href="#cb2-198" aria-hidden="true" tabindex="-1"></a><span class="co">#     '경상북도.xlsx',</span></span>
<span id="cb2-199"><a href="#cb2-199" aria-hidden="true" tabindex="-1"></a><span class="co">#     header_rows=(2, 4),</span></span>
<span id="cb2-200"><a href="#cb2-200" aria-hidden="true" tabindex="-1"></a><span class="co">#     filter_column='읍면동명',</span></span>
<span id="cb2-201"><a href="#cb2-201" aria-hidden="true" tabindex="-1"></a><span class="co">#     filter_value=[np.nan, '합계', '소계']</span></span>
<span id="cb2-202"><a href="#cb2-202" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span>
<span id="cb2-203"><a href="#cb2-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-204"><a href="#cb2-204" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. 단일 값 필터링 (기존 방식과 동일)</span></span>
<span id="cb2-205"><a href="#cb2-205" aria-hidden="true" tabindex="-1"></a><span class="co"># df_single = process_6th_governor_election2(</span></span>
<span id="cb2-206"><a href="#cb2-206" aria-hidden="true" tabindex="-1"></a><span class="co">#     '경상북도.xlsx',</span></span>
<span id="cb2-207"><a href="#cb2-207" aria-hidden="true" tabindex="-1"></a><span class="co">#     header_rows=(2, 4),</span></span>
<span id="cb2-208"><a href="#cb2-208" aria-hidden="true" tabindex="-1"></a><span class="co">#     filter_column='읍면동명',</span></span>
<span id="cb2-209"><a href="#cb2-209" aria-hidden="true" tabindex="-1"></a><span class="co">#     filter_value='합계'</span></span>
<span id="cb2-210"><a href="#cb2-210" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="section-2" class="level3">
<h3 class="anchored" data-anchor-id="section-2">3</h3>
<div id="cell-8" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> convert_github_url_to_raw(github_url):</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co">    깃허브 blob URL을 raw URL로 변환</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co">    Parameters:</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="co">    -----------</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="co">    github_url : str</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="co">        깃허브 파일 URL</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns:</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="co">    --------</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="co">    str</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="co">        raw URL (pandas가 직접 읽을 수 있는 형태)</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="st">'/blob/'</span> <span class="kw">in</span> github_url:</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> github_url.replace(<span class="st">'/blob/'</span>, <span class="st">'/raw/'</span>)</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> github_url</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> process_6th_governor_election3(</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>    file_path_or_url,</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>    header_rows<span class="op">=</span>(<span class="dv">2</span>, <span class="dv">4</span>),  <span class="co"># 엑셀 기준 행 번호 (2행부터 4행까지)</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>    filter_column<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>    filter_value<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>    add_sheet_name_column<span class="op">=</span><span class="va">True</span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a><span class="co">    여러 시트가 있는 선거 데이터를 처리하는 함수</span></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a><span class="co">    Parameters:</span></span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a><span class="co">    -----------</span></span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a><span class="co">    file_path_or_url : str</span></span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a><span class="co">        로컬 파일 경로 또는 GitHub URL</span></span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a><span class="co">    header_rows : tuple</span></span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a><span class="co">        헤더로 사용할 행 범위 (엑셀 기준 행 번호)</span></span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a><span class="co">        예: (2, 4) = 2행부터 4행까지</span></span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a><span class="co">    filter_column : str, optional</span></span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a><span class="co">        필터링할 컬럼명 (예: '읍면동명')</span></span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a><span class="co">    filter_value : str, optional</span></span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a><span class="co">        필터링할 값 (예: '합계')</span></span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a><span class="co">    add_sheet_name_column : bool</span></span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a><span class="co">        시트명을 첫 번째 열로 추가할지 여부 (기본값: True)</span></span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns:</span></span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a><span class="co">    --------</span></span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a><span class="co">    pandas.DataFrame</span></span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a><span class="co">        모든 시트를 합친 데이터프레임</span></span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a><span class="co">    Example:</span></span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a><span class="co">    --------</span></span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a><span class="co">    # 모든 시트에서 2~4행을 헤더로, '읍면동명'이 '합계'인 행만 추출</span></span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a><span class="co">    df = process_6th_governor_election3(</span></span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a><span class="co">        'https://github.com/.../서울특별시.xls',</span></span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a><span class="co">        header_rows=(2, 4),</span></span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a><span class="co">        filter_column='읍면동명',</span></span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a><span class="co">        filter_value='합계'</span></span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a><span class="co">    )</span></span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a>    <span class="co"># GitHub URL인 경우 raw URL로 변환</span></span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> file_path_or_url.startswith(<span class="st">'https://github.com'</span>):</span>
<span id="cb3-64"><a href="#cb3-64" aria-hidden="true" tabindex="-1"></a>        file_path_or_url <span class="op">=</span> convert_github_url_to_raw(file_path_or_url)</span>
<span id="cb3-65"><a href="#cb3-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-66"><a href="#cb3-66" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 모든 시트 이름 가져오기</span></span>
<span id="cb3-67"><a href="#cb3-67" aria-hidden="true" tabindex="-1"></a>    excel_file <span class="op">=</span> pd.ExcelFile(file_path_or_url)</span>
<span id="cb3-68"><a href="#cb3-68" aria-hidden="true" tabindex="-1"></a>    sheet_names <span class="op">=</span> excel_file.sheet_names</span>
<span id="cb3-69"><a href="#cb3-69" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"발견된 시트: </span><span class="sc">{</span><span class="bu">len</span>(sheet_names)<span class="sc">}</span><span class="ss">개"</span>)</span>
<span id="cb3-70"><a href="#cb3-70" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"시트 이름: </span><span class="sc">{</span>sheet_names<span class="sc">}</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb3-71"><a href="#cb3-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-72"><a href="#cb3-72" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 각 시트의 결과를 저장할 리스트</span></span>
<span id="cb3-73"><a href="#cb3-73" aria-hidden="true" tabindex="-1"></a>    all_dfs <span class="op">=</span> []</span>
<span id="cb3-74"><a href="#cb3-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-75"><a href="#cb3-75" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 각 시트 처리</span></span>
<span id="cb3-76"><a href="#cb3-76" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> sheet_idx, sheet_name <span class="kw">in</span> <span class="bu">enumerate</span>(sheet_names):</span>
<span id="cb3-77"><a href="#cb3-77" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="sc">{</span><span class="st">'='</span><span class="op">*</span><span class="dv">50</span><span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb3-78"><a href="#cb3-78" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"시트 </span><span class="sc">{</span>sheet_idx<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">/</span><span class="sc">{</span><span class="bu">len</span>(sheet_names)<span class="sc">}</span><span class="ss">: '</span><span class="sc">{</span>sheet_name<span class="sc">}</span><span class="ss">' 처리 중..."</span>)</span>
<span id="cb3-79"><a href="#cb3-79" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span><span class="st">'='</span><span class="op">*</span><span class="dv">50</span><span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb3-80"><a href="#cb3-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-81"><a href="#cb3-81" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 파일을 header 없이 읽기</span></span>
<span id="cb3-82"><a href="#cb3-82" aria-hidden="true" tabindex="-1"></a>        df_raw <span class="op">=</span> pd.read_excel(file_path_or_url, sheet_name<span class="op">=</span>sheet_name, header<span class="op">=</span><span class="va">None</span>)</span>
<span id="cb3-83"><a href="#cb3-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-84"><a href="#cb3-84" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 빈 시트 체크</span></span>
<span id="cb3-85"><a href="#cb3-85" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> df_raw.empty <span class="kw">or</span> <span class="bu">len</span>(df_raw) <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb3-86"><a href="#cb3-86" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"'</span><span class="sc">{</span>sheet_name<span class="sc">}</span><span class="ss">' 시트가 비어있습니다. 건너뜁니다."</span>)</span>
<span id="cb3-87"><a href="#cb3-87" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span></span>
<span id="cb3-88"><a href="#cb3-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-89"><a href="#cb3-89" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 엑셀 행 번호를 파이썬 인덱스로 변환</span></span>
<span id="cb3-90"><a href="#cb3-90" aria-hidden="true" tabindex="-1"></a>        start_idx <span class="op">=</span> header_rows[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb3-91"><a href="#cb3-91" aria-hidden="true" tabindex="-1"></a>        end_idx <span class="op">=</span> header_rows[<span class="dv">1</span>] <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb3-92"><a href="#cb3-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-93"><a href="#cb3-93" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 헤더 행이 충분한지 확인</span></span>
<span id="cb3-94"><a href="#cb3-94" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(df_raw) <span class="op">&lt;=</span> end_idx:</span>
<span id="cb3-95"><a href="#cb3-95" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"'</span><span class="sc">{</span>sheet_name<span class="sc">}</span><span class="ss">' 시트의 행이 부족합니다. 건너뜁니다."</span>)</span>
<span id="cb3-96"><a href="#cb3-96" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span></span>
<span id="cb3-97"><a href="#cb3-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-98"><a href="#cb3-98" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 지정된 행들을 가져와서 컬럼명 생성</span></span>
<span id="cb3-99"><a href="#cb3-99" aria-hidden="true" tabindex="-1"></a>        header_rows_data <span class="op">=</span> []</span>
<span id="cb3-100"><a href="#cb3-100" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(start_idx, end_idx <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb3-101"><a href="#cb3-101" aria-hidden="true" tabindex="-1"></a>            header_rows_data.append(df_raw.iloc[i].fillna(<span class="st">'_'</span>).astype(<span class="bu">str</span>))</span>
<span id="cb3-102"><a href="#cb3-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-103"><a href="#cb3-103" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 컬럼명 생성</span></span>
<span id="cb3-104"><a href="#cb3-104" aria-hidden="true" tabindex="-1"></a>        new_columns <span class="op">=</span> []</span>
<span id="cb3-105"><a href="#cb3-105" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> col_idx <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(header_rows_data[<span class="dv">0</span>])):</span>
<span id="cb3-106"><a href="#cb3-106" aria-hidden="true" tabindex="-1"></a>            parts <span class="op">=</span> []</span>
<span id="cb3-107"><a href="#cb3-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-108"><a href="#cb3-108" aria-hidden="true" tabindex="-1"></a>            <span class="co"># 각 행의 값이 '_'가 아닌 경우만 추가</span></span>
<span id="cb3-109"><a href="#cb3-109" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> row_data <span class="kw">in</span> header_rows_data:</span>
<span id="cb3-110"><a href="#cb3-110" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> row_data[col_idx] <span class="op">!=</span> <span class="st">'_'</span>:</span>
<span id="cb3-111"><a href="#cb3-111" aria-hidden="true" tabindex="-1"></a>                    parts.append(row_data[col_idx])</span>
<span id="cb3-112"><a href="#cb3-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-113"><a href="#cb3-113" aria-hidden="true" tabindex="-1"></a>            <span class="co"># parts가 비어있으면 '_', 아니면 '_'로 연결</span></span>
<span id="cb3-114"><a href="#cb3-114" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> parts:</span>
<span id="cb3-115"><a href="#cb3-115" aria-hidden="true" tabindex="-1"></a>                new_columns.append(<span class="st">'_'</span>.join(parts))</span>
<span id="cb3-116"><a href="#cb3-116" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb3-117"><a href="#cb3-117" aria-hidden="true" tabindex="-1"></a>                new_columns.append(<span class="st">'_'</span>)</span>
<span id="cb3-118"><a href="#cb3-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-119"><a href="#cb3-119" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 데이터프레임 재구성</span></span>
<span id="cb3-120"><a href="#cb3-120" aria-hidden="true" tabindex="-1"></a>        data_start_idx <span class="op">=</span> end_idx <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb3-121"><a href="#cb3-121" aria-hidden="true" tabindex="-1"></a>        df <span class="op">=</span> df_raw.iloc[data_start_idx:].copy()</span>
<span id="cb3-122"><a href="#cb3-122" aria-hidden="true" tabindex="-1"></a>        df.columns <span class="op">=</span> new_columns</span>
<span id="cb3-123"><a href="#cb3-123" aria-hidden="true" tabindex="-1"></a>        df <span class="op">=</span> df.reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb3-124"><a href="#cb3-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-125"><a href="#cb3-125" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"데이터 행 수: </span><span class="sc">{</span><span class="bu">len</span>(df)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb3-126"><a href="#cb3-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-127"><a href="#cb3-127" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 필터링 적용</span></span>
<span id="cb3-128"><a href="#cb3-128" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> filter_column <span class="kw">and</span> filter_value:</span>
<span id="cb3-129"><a href="#cb3-129" aria-hidden="true" tabindex="-1"></a>            <span class="co"># 필터링할 컬럼 찾기</span></span>
<span id="cb3-130"><a href="#cb3-130" aria-hidden="true" tabindex="-1"></a>            matching_col <span class="op">=</span> <span class="va">None</span></span>
<span id="cb3-131"><a href="#cb3-131" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> col <span class="kw">in</span> df.columns:</span>
<span id="cb3-132"><a href="#cb3-132" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> filter_column <span class="kw">in</span> col:</span>
<span id="cb3-133"><a href="#cb3-133" aria-hidden="true" tabindex="-1"></a>                    matching_col <span class="op">=</span> col</span>
<span id="cb3-134"><a href="#cb3-134" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">break</span></span>
<span id="cb3-135"><a href="#cb3-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-136"><a href="#cb3-136" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> matching_col:</span>
<span id="cb3-137"><a href="#cb3-137" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 필터링 적용</span></span>
<span id="cb3-138"><a href="#cb3-138" aria-hidden="true" tabindex="-1"></a>                df <span class="op">=</span> df[df[matching_col] <span class="op">==</span> filter_value].copy()</span>
<span id="cb3-139"><a href="#cb3-139" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f"필터링 적용: '</span><span class="sc">{</span>matching_col<span class="sc">}</span><span class="ss">' == '</span><span class="sc">{</span>filter_value<span class="sc">}</span><span class="ss">' → </span><span class="sc">{</span><span class="bu">len</span>(df)<span class="sc">}</span><span class="ss">행"</span>)</span>
<span id="cb3-140"><a href="#cb3-140" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb3-141"><a href="#cb3-141" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f"경고: '</span><span class="sc">{</span>filter_column<span class="sc">}</span><span class="ss">'을 포함하는 컬럼을 찾을 수 없습니다."</span>)</span>
<span id="cb3-142"><a href="#cb3-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-143"><a href="#cb3-143" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 시트명 열 추가</span></span>
<span id="cb3-144"><a href="#cb3-144" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> add_sheet_name_column <span class="kw">and</span> <span class="bu">len</span>(df) <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb3-145"><a href="#cb3-145" aria-hidden="true" tabindex="-1"></a>            df.insert(<span class="dv">0</span>, <span class="st">'시트명'</span>, sheet_name)</span>
<span id="cb3-146"><a href="#cb3-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-147"><a href="#cb3-147" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 결과 리스트에 추가</span></span>
<span id="cb3-148"><a href="#cb3-148" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(df) <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb3-149"><a href="#cb3-149" aria-hidden="true" tabindex="-1"></a>            all_dfs.append(df)</span>
<span id="cb3-150"><a href="#cb3-150" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"'</span><span class="sc">{</span>sheet_name<span class="sc">}</span><span class="ss">' 시트 처리 완료: </span><span class="sc">{</span><span class="bu">len</span>(df)<span class="sc">}</span><span class="ss">행 추가됨"</span>)</span>
<span id="cb3-151"><a href="#cb3-151" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb3-152"><a href="#cb3-152" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"'</span><span class="sc">{</span>sheet_name<span class="sc">}</span><span class="ss">' 시트에 데이터가 없습니다."</span>)</span>
<span id="cb3-153"><a href="#cb3-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-154"><a href="#cb3-154" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 모든 데이터프레임 합치기</span></span>
<span id="cb3-155"><a href="#cb3-155" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> all_dfs:</span>
<span id="cb3-156"><a href="#cb3-156" aria-hidden="true" tabindex="-1"></a>        combined_df <span class="op">=</span> pd.concat(all_dfs, ignore_index<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb3-157"><a href="#cb3-157" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="sc">{</span><span class="st">'='</span><span class="op">*</span><span class="dv">50</span><span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb3-158"><a href="#cb3-158" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"최종 결과: 총 </span><span class="sc">{</span><span class="bu">len</span>(combined_df)<span class="sc">}</span><span class="ss">행의 데이터"</span>)</span>
<span id="cb3-159"><a href="#cb3-159" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span><span class="st">'='</span><span class="op">*</span><span class="dv">50</span><span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb3-160"><a href="#cb3-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-161"><a href="#cb3-161" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> combined_df</span>
<span id="cb3-162"><a href="#cb3-162" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb3-163"><a href="#cb3-163" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">처리된 데이터가 없습니다."</span>)</span>
<span id="cb3-164"><a href="#cb3-164" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> pd.DataFrame()</span>
<span id="cb3-165"><a href="#cb3-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-166"><a href="#cb3-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-167"><a href="#cb3-167" aria-hidden="true" tabindex="-1"></a><span class="co"># 사용 예시</span></span>
<span id="cb3-168"><a href="#cb3-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-169"><a href="#cb3-169" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. 서울특별시.xls - 모든 시트의 합계 데이터만 추출</span></span>
<span id="cb3-170"><a href="#cb3-170" aria-hidden="true" tabindex="-1"></a><span class="co"># url = "https://github.com/.../서울특별시.xls"</span></span>
<span id="cb3-171"><a href="#cb3-171" aria-hidden="true" tabindex="-1"></a><span class="co"># seoul_summary = process_6th_governor_election3(</span></span>
<span id="cb3-172"><a href="#cb3-172" aria-hidden="true" tabindex="-1"></a><span class="co">#     url,</span></span>
<span id="cb3-173"><a href="#cb3-173" aria-hidden="true" tabindex="-1"></a><span class="co">#     header_rows=(2, 4),</span></span>
<span id="cb3-174"><a href="#cb3-174" aria-hidden="true" tabindex="-1"></a><span class="co">#     filter_column='읍면동명',</span></span>
<span id="cb3-175"><a href="#cb3-175" aria-hidden="true" tabindex="-1"></a><span class="co">#     filter_value='합계'</span></span>
<span id="cb3-176"><a href="#cb3-176" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span>
<span id="cb3-177"><a href="#cb3-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-178"><a href="#cb3-178" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. 시트명 열 없이 처리</span></span>
<span id="cb3-179"><a href="#cb3-179" aria-hidden="true" tabindex="-1"></a><span class="co"># df_no_sheet = process_6th_governor_election3(</span></span>
<span id="cb3-180"><a href="#cb3-180" aria-hidden="true" tabindex="-1"></a><span class="co">#     'multi_sheet.xlsx',</span></span>
<span id="cb3-181"><a href="#cb3-181" aria-hidden="true" tabindex="-1"></a><span class="co">#     header_rows=(1, 3),</span></span>
<span id="cb3-182"><a href="#cb3-182" aria-hidden="true" tabindex="-1"></a><span class="co">#     add_sheet_name_column=False</span></span>
<span id="cb3-183"><a href="#cb3-183" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span>
<span id="cb3-184"><a href="#cb3-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-185"><a href="#cb3-185" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. 필터링 없이 모든 데이터 합치기</span></span>
<span id="cb3-186"><a href="#cb3-186" aria-hidden="true" tabindex="-1"></a><span class="co"># df_all = process_6th_governor_election3(</span></span>
<span id="cb3-187"><a href="#cb3-187" aria-hidden="true" tabindex="-1"></a><span class="co">#     'election_data.xls',</span></span>
<span id="cb3-188"><a href="#cb3-188" aria-hidden="true" tabindex="-1"></a><span class="co">#     header_rows=(2, 2)  # 2행만 헤더로 사용</span></span>
<span id="cb3-189"><a href="#cb3-189" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="section-3" class="level3">
<h3 class="anchored" data-anchor-id="section-3">4</h3>
<div id="cell-10" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> convert_github_url_to_raw(github_url):</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co">    깃허브 blob URL을 raw URL로 변환</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co">    Parameters:</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co">    -----------</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="co">    github_url : str</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="co">        깃허브 파일 URL</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns:</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="co">    --------</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="co">    str</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="co">        raw URL (pandas가 직접 읽을 수 있는 형태)</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="st">'/blob/'</span> <span class="kw">in</span> github_url:</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> github_url.replace(<span class="st">'/blob/'</span>, <span class="st">'/raw/'</span>)</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> github_url</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> process_6th_governor_election4(</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>    file_path_or_url,</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>    header_rows<span class="op">=</span>(<span class="dv">2</span>, <span class="dv">4</span>),  <span class="co"># 엑셀 기준 행 번호 (2행부터 4행까지)</span></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>    filter_column<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>    filter_value<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>    row_range<span class="op">=</span><span class="va">None</span>  <span class="co"># 읽을 행 범위 (엑셀 기준)</span></span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a><span class="co">    선거 데이터를 유연하게 처리하는 함수</span></span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a><span class="co">    Parameters:</span></span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a><span class="co">    -----------</span></span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a><span class="co">    file_path_or_url : str</span></span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a><span class="co">        로컬 파일 경로 또는 GitHub URL</span></span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a><span class="co">    header_rows : tuple</span></span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a><span class="co">        헤더로 사용할 행 범위 (엑셀 기준 행 번호)</span></span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a><span class="co">        예: (2, 4) = 2행부터 4행까지</span></span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a><span class="co">    filter_column : str, optional</span></span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a><span class="co">        필터링할 컬럼명 (예: '읍면동명')</span></span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a><span class="co">    filter_value : str, optional</span></span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a><span class="co">        필터링할 값 (예: '합계')</span></span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a><span class="co">    row_range : tuple, optional</span></span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a><span class="co">        읽을 행 범위 (엑셀 기준 행 번호)</span></span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a><span class="co">        예: (1, 13) = 1행부터 13행까지만 읽기</span></span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a><span class="co">        None이면 전체 파일 읽기</span></span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-48"><a href="#cb4-48" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns:</span></span>
<span id="cb4-49"><a href="#cb4-49" aria-hidden="true" tabindex="-1"></a><span class="co">    --------</span></span>
<span id="cb4-50"><a href="#cb4-50" aria-hidden="true" tabindex="-1"></a><span class="co">    pandas.DataFrame</span></span>
<span id="cb4-51"><a href="#cb4-51" aria-hidden="true" tabindex="-1"></a><span class="co">        처리된 데이터프레임</span></span>
<span id="cb4-52"><a href="#cb4-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-53"><a href="#cb4-53" aria-hidden="true" tabindex="-1"></a><span class="co">    Example:</span></span>
<span id="cb4-54"><a href="#cb4-54" aria-hidden="true" tabindex="-1"></a><span class="co">    --------</span></span>
<span id="cb4-55"><a href="#cb4-55" aria-hidden="true" tabindex="-1"></a><span class="co">    # 1~13행만 읽어서 2~4행을 헤더로, '읍면동명'이 '합계'인 행만 추출</span></span>
<span id="cb4-56"><a href="#cb4-56" aria-hidden="true" tabindex="-1"></a><span class="co">    df = process_6th_governor_election4(</span></span>
<span id="cb4-57"><a href="#cb4-57" aria-hidden="true" tabindex="-1"></a><span class="co">        '대구광역시.xls',</span></span>
<span id="cb4-58"><a href="#cb4-58" aria-hidden="true" tabindex="-1"></a><span class="co">        header_rows=(2, 4),</span></span>
<span id="cb4-59"><a href="#cb4-59" aria-hidden="true" tabindex="-1"></a><span class="co">        filter_column='읍면동명',</span></span>
<span id="cb4-60"><a href="#cb4-60" aria-hidden="true" tabindex="-1"></a><span class="co">        filter_value='합계',</span></span>
<span id="cb4-61"><a href="#cb4-61" aria-hidden="true" tabindex="-1"></a><span class="co">        row_range=(1, 13)</span></span>
<span id="cb4-62"><a href="#cb4-62" aria-hidden="true" tabindex="-1"></a><span class="co">    )</span></span>
<span id="cb4-63"><a href="#cb4-63" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb4-64"><a href="#cb4-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-65"><a href="#cb4-65" aria-hidden="true" tabindex="-1"></a>    <span class="co"># GitHub URL인 경우 raw URL로 변환</span></span>
<span id="cb4-66"><a href="#cb4-66" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> file_path_or_url.startswith(<span class="st">'https://github.com'</span>):</span>
<span id="cb4-67"><a href="#cb4-67" aria-hidden="true" tabindex="-1"></a>        file_path_or_url <span class="op">=</span> convert_github_url_to_raw(file_path_or_url)</span>
<span id="cb4-68"><a href="#cb4-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-69"><a href="#cb4-69" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 파일을 header 없이 읽기</span></span>
<span id="cb4-70"><a href="#cb4-70" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> row_range:</span>
<span id="cb4-71"><a href="#cb4-71" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 행 범위가 지정된 경우</span></span>
<span id="cb4-72"><a href="#cb4-72" aria-hidden="true" tabindex="-1"></a>        start_row <span class="op">=</span> row_range[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">1</span>  <span class="co"># 엑셀 행 번호를 파이썬 인덱스로 변환</span></span>
<span id="cb4-73"><a href="#cb4-73" aria-hidden="true" tabindex="-1"></a>        end_row <span class="op">=</span> row_range[<span class="dv">1</span>]  <span class="co"># 엑셀의 13행까지 = 파이썬의 인덱스 12까지</span></span>
<span id="cb4-74"><a href="#cb4-74" aria-hidden="true" tabindex="-1"></a>        nrows <span class="op">=</span> end_row <span class="op">-</span> start_row</span>
<span id="cb4-75"><a href="#cb4-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-76"><a href="#cb4-76" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"파일에서 </span><span class="sc">{</span>row_range[<span class="dv">0</span>]<span class="sc">}</span><span class="ss">행부터 </span><span class="sc">{</span>row_range[<span class="dv">1</span>]<span class="sc">}</span><span class="ss">행까지만 읽습니다."</span>)</span>
<span id="cb4-77"><a href="#cb4-77" aria-hidden="true" tabindex="-1"></a>        df_raw <span class="op">=</span> pd.read_excel(file_path_or_url, header<span class="op">=</span><span class="va">None</span>, skiprows<span class="op">=</span>start_row, nrows<span class="op">=</span>nrows)</span>
<span id="cb4-78"><a href="#cb4-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-79"><a href="#cb4-79" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 헤더 인덱스 조정 (skiprows를 사용했으므로)</span></span>
<span id="cb4-80"><a href="#cb4-80" aria-hidden="true" tabindex="-1"></a>        adjusted_start_idx <span class="op">=</span> header_rows[<span class="dv">0</span>] <span class="op">-</span> row_range[<span class="dv">0</span>]</span>
<span id="cb4-81"><a href="#cb4-81" aria-hidden="true" tabindex="-1"></a>        adjusted_end_idx <span class="op">=</span> header_rows[<span class="dv">1</span>] <span class="op">-</span> row_range[<span class="dv">0</span>]</span>
<span id="cb4-82"><a href="#cb4-82" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb4-83"><a href="#cb4-83" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 전체 파일 읽기</span></span>
<span id="cb4-84"><a href="#cb4-84" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"파일 전체를 읽습니다."</span>)</span>
<span id="cb4-85"><a href="#cb4-85" aria-hidden="true" tabindex="-1"></a>        df_raw <span class="op">=</span> pd.read_excel(file_path_or_url, header<span class="op">=</span><span class="va">None</span>)</span>
<span id="cb4-86"><a href="#cb4-86" aria-hidden="true" tabindex="-1"></a>        adjusted_start_idx <span class="op">=</span> header_rows[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb4-87"><a href="#cb4-87" aria-hidden="true" tabindex="-1"></a>        adjusted_end_idx <span class="op">=</span> header_rows[<span class="dv">1</span>] <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb4-88"><a href="#cb4-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-89"><a href="#cb4-89" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 지정된 행들을 가져와서 컬럼명 생성</span></span>
<span id="cb4-90"><a href="#cb4-90" aria-hidden="true" tabindex="-1"></a>    header_rows_data <span class="op">=</span> []</span>
<span id="cb4-91"><a href="#cb4-91" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(adjusted_start_idx, adjusted_end_idx <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb4-92"><a href="#cb4-92" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> i <span class="op">&lt;</span> <span class="dv">0</span> <span class="kw">or</span> i <span class="op">&gt;=</span> <span class="bu">len</span>(df_raw):</span>
<span id="cb4-93"><a href="#cb4-93" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"경고: 헤더 행 인덱스 </span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">가 범위를 벗어났습니다."</span>)</span>
<span id="cb4-94"><a href="#cb4-94" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span></span>
<span id="cb4-95"><a href="#cb4-95" aria-hidden="true" tabindex="-1"></a>        header_rows_data.append(df_raw.iloc[i].fillna(<span class="st">'_'</span>).astype(<span class="bu">str</span>))</span>
<span id="cb4-96"><a href="#cb4-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-97"><a href="#cb4-97" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 컬럼명 생성</span></span>
<span id="cb4-98"><a href="#cb4-98" aria-hidden="true" tabindex="-1"></a>    new_columns <span class="op">=</span> []</span>
<span id="cb4-99"><a href="#cb4-99" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> col_idx <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(header_rows_data[<span class="dv">0</span>])):</span>
<span id="cb4-100"><a href="#cb4-100" aria-hidden="true" tabindex="-1"></a>        parts <span class="op">=</span> []</span>
<span id="cb4-101"><a href="#cb4-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-102"><a href="#cb4-102" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 각 행의 값이 '_'가 아닌 경우만 추가</span></span>
<span id="cb4-103"><a href="#cb4-103" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> row_data <span class="kw">in</span> header_rows_data:</span>
<span id="cb4-104"><a href="#cb4-104" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> row_data[col_idx] <span class="op">!=</span> <span class="st">'_'</span>:</span>
<span id="cb4-105"><a href="#cb4-105" aria-hidden="true" tabindex="-1"></a>                parts.append(row_data[col_idx])</span>
<span id="cb4-106"><a href="#cb4-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-107"><a href="#cb4-107" aria-hidden="true" tabindex="-1"></a>        <span class="co"># parts가 비어있으면 '_', 아니면 '_'로 연결</span></span>
<span id="cb4-108"><a href="#cb4-108" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> parts:</span>
<span id="cb4-109"><a href="#cb4-109" aria-hidden="true" tabindex="-1"></a>            new_columns.append(<span class="st">'_'</span>.join(parts))</span>
<span id="cb4-110"><a href="#cb4-110" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb4-111"><a href="#cb4-111" aria-hidden="true" tabindex="-1"></a>            new_columns.append(<span class="st">'_'</span>)</span>
<span id="cb4-112"><a href="#cb4-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-113"><a href="#cb4-113" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 데이터프레임 재구성 (헤더 다음 행부터 데이터로 사용)</span></span>
<span id="cb4-114"><a href="#cb4-114" aria-hidden="true" tabindex="-1"></a>    data_start_idx <span class="op">=</span> adjusted_end_idx <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb4-115"><a href="#cb4-115" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> data_start_idx <span class="op">&lt;</span> <span class="bu">len</span>(df_raw):</span>
<span id="cb4-116"><a href="#cb4-116" aria-hidden="true" tabindex="-1"></a>        df <span class="op">=</span> df_raw.iloc[data_start_idx:].copy()</span>
<span id="cb4-117"><a href="#cb4-117" aria-hidden="true" tabindex="-1"></a>        df.columns <span class="op">=</span> new_columns</span>
<span id="cb4-118"><a href="#cb4-118" aria-hidden="true" tabindex="-1"></a>        df <span class="op">=</span> df.reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb4-119"><a href="#cb4-119" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb4-120"><a href="#cb4-120" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"경고: 데이터 행이 없습니다."</span>)</span>
<span id="cb4-121"><a href="#cb4-121" aria-hidden="true" tabindex="-1"></a>        df <span class="op">=</span> pd.DataFrame(columns<span class="op">=</span>new_columns)</span>
<span id="cb4-122"><a href="#cb4-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-123"><a href="#cb4-123" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"헤더 행: </span><span class="sc">{</span>header_rows[<span class="dv">0</span>]<span class="sc">}</span><span class="ss">행 ~ </span><span class="sc">{</span>header_rows[<span class="dv">1</span>]<span class="sc">}</span><span class="ss">행"</span>)</span>
<span id="cb4-124"><a href="#cb4-124" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"생성된 컬럼 수: </span><span class="sc">{</span><span class="bu">len</span>(new_columns)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb4-125"><a href="#cb4-125" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"데이터 행 수: </span><span class="sc">{</span><span class="bu">len</span>(df)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb4-126"><a href="#cb4-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-127"><a href="#cb4-127" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 컬럼명 샘플 출력</span></span>
<span id="cb4-128"><a href="#cb4-128" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">생성된 컬럼명 (처음 10개):"</span>)</span>
<span id="cb4-129"><a href="#cb4-129" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, col <span class="kw">in</span> <span class="bu">enumerate</span>(new_columns[:<span class="dv">10</span>]):</span>
<span id="cb4-130"><a href="#cb4-130" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>col<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb4-131"><a href="#cb4-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-132"><a href="#cb4-132" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 필터링 적용</span></span>
<span id="cb4-133"><a href="#cb4-133" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> filter_column <span class="kw">and</span> filter_value:</span>
<span id="cb4-134"><a href="#cb4-134" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 필터링할 컬럼 찾기</span></span>
<span id="cb4-135"><a href="#cb4-135" aria-hidden="true" tabindex="-1"></a>        matching_col <span class="op">=</span> <span class="va">None</span></span>
<span id="cb4-136"><a href="#cb4-136" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> col <span class="kw">in</span> df.columns:</span>
<span id="cb4-137"><a href="#cb4-137" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> filter_column <span class="kw">in</span> col:</span>
<span id="cb4-138"><a href="#cb4-138" aria-hidden="true" tabindex="-1"></a>                matching_col <span class="op">=</span> col</span>
<span id="cb4-139"><a href="#cb4-139" aria-hidden="true" tabindex="-1"></a>                <span class="cf">break</span></span>
<span id="cb4-140"><a href="#cb4-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-141"><a href="#cb4-141" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> matching_col:</span>
<span id="cb4-142"><a href="#cb4-142" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">'</span><span class="sc">{</span>filter_column<span class="sc">}</span><span class="ss">' 컬럼 발견: </span><span class="sc">{</span>matching_col<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb4-143"><a href="#cb4-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-144"><a href="#cb4-144" aria-hidden="true" tabindex="-1"></a>            <span class="co"># 필터링 적용</span></span>
<span id="cb4-145"><a href="#cb4-145" aria-hidden="true" tabindex="-1"></a>            filtered_df <span class="op">=</span> df[df[matching_col] <span class="op">==</span> filter_value].copy()</span>
<span id="cb4-146"><a href="#cb4-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-147"><a href="#cb4-147" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"필터링 전: </span><span class="sc">{</span><span class="bu">len</span>(df)<span class="sc">}</span><span class="ss">행 → 필터링 후: </span><span class="sc">{</span><span class="bu">len</span>(filtered_df)<span class="sc">}</span><span class="ss">행"</span>)</span>
<span id="cb4-148"><a href="#cb4-148" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"'</span><span class="sc">{</span>matching_col<span class="sc">}</span><span class="ss">' == '</span><span class="sc">{</span>filter_value<span class="sc">}</span><span class="ss">'인 행만 추출"</span>)</span>
<span id="cb4-149"><a href="#cb4-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-150"><a href="#cb4-150" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> filtered_df</span>
<span id="cb4-151"><a href="#cb4-151" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb4-152"><a href="#cb4-152" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">경고: '</span><span class="sc">{</span>filter_column<span class="sc">}</span><span class="ss">'을 포함하는 컬럼을 찾을 수 없습니다."</span>)</span>
<span id="cb4-153"><a href="#cb4-153" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">"필터링 없이 전체 데이터를 반환합니다."</span>)</span>
<span id="cb4-154"><a href="#cb4-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-155"><a href="#cb4-155" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df</span>
<span id="cb4-156"><a href="#cb4-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-157"><a href="#cb4-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-158"><a href="#cb4-158" aria-hidden="true" tabindex="-1"></a><span class="co"># 사용 예시</span></span>
<span id="cb4-159"><a href="#cb4-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-160"><a href="#cb4-160" aria-hidden="true" tabindex="-1"></a><span class="co"># df = process_6th_governor_election4(</span></span>
<span id="cb4-161"><a href="#cb4-161" aria-hidden="true" tabindex="-1"></a><span class="co">#     "https://github.com/.../대구광역시.xls",</span></span>
<span id="cb4-162"><a href="#cb4-162" aria-hidden="true" tabindex="-1"></a><span class="co">#     header_rows=(3, 4),  # 엑셀 기준 행 번호 (2행부터 4행까지)</span></span>
<span id="cb4-163"><a href="#cb4-163" aria-hidden="true" tabindex="-1"></a><span class="co">#     filter_column=None,</span></span>
<span id="cb4-164"><a href="#cb4-164" aria-hidden="true" tabindex="-1"></a><span class="co">#     filter_value=None,</span></span>
<span id="cb4-165"><a href="#cb4-165" aria-hidden="true" tabindex="-1"></a><span class="co">#     row_range=(1,13)  # 읽을 행 범위 (엑셀 기준)</span></span>
<span id="cb4-166"><a href="#cb4-166" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="section-4" class="level3">
<h3 class="anchored" data-anchor-id="section-4">5</h3>
<div id="cell-12" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> convert_github_url_to_raw(github_url):</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co">    깃허브 blob URL을 raw URL로 변환</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co">    Parameters:</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co">    -----------</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co">    github_url : str</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co">        깃허브 파일 URL</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns:</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="co">    --------</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="co">    str</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="co">        raw URL (pandas가 직접 읽을 수 있는 형태)</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="st">'/blob/'</span> <span class="kw">in</span> github_url:</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> github_url.replace(<span class="st">'/blob/'</span>, <span class="st">'/raw/'</span>)</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> github_url</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> process_6th_governor_election5(</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>    file_path_or_url,</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>    header_rows<span class="op">=</span>(<span class="dv">2</span>, <span class="dv">4</span>),  <span class="co"># 엑셀 기준 행 번호 (2행부터 4행까지)</span></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>    filter_column<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>    filter_value<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>    add_sheet_name_column<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>    sheet_names<span class="op">=</span><span class="va">None</span>  <span class="co"># 특정 시트만 처리하고 싶을 때 사용</span></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a><span class="co">    여러 시트가 있는 선거 데이터를 처리하는 함수</span></span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a><span class="co">    Parameters:</span></span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a><span class="co">    -----------</span></span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a><span class="co">    file_path_or_url : str</span></span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a><span class="co">        로컬 파일 경로 또는 GitHub URL</span></span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a><span class="co">    header_rows : tuple</span></span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a><span class="co">        헤더로 사용할 행 범위 (엑셀 기준 행 번호)</span></span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a><span class="co">        예: (2, 4) = 2행부터 4행까지</span></span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a><span class="co">    filter_column : str, optional</span></span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a><span class="co">        필터링할 컬럼명 (예: '읍면동명')</span></span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a><span class="co">    filter_value : str, optional</span></span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a><span class="co">        필터링할 값 (예: '합계')</span></span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a><span class="co">    add_sheet_name_column : bool</span></span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a><span class="co">        시트명을 첫 번째 열로 추가할지 여부 (기본값: True)</span></span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a><span class="co">    sheet_names : str or list, optional</span></span>
<span id="cb5-47"><a href="#cb5-47" aria-hidden="true" tabindex="-1"></a><span class="co">        처리할 시트명. None이면 모든 시트 처리</span></span>
<span id="cb5-48"><a href="#cb5-48" aria-hidden="true" tabindex="-1"></a><span class="co">        - str: 단일 시트명 (예: '세종특별자치시장')</span></span>
<span id="cb5-49"><a href="#cb5-49" aria-hidden="true" tabindex="-1"></a><span class="co">        - list: 여러 시트명 (예: ['세종특별자치시장', '세종시의원'])</span></span>
<span id="cb5-50"><a href="#cb5-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-51"><a href="#cb5-51" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns:</span></span>
<span id="cb5-52"><a href="#cb5-52" aria-hidden="true" tabindex="-1"></a><span class="co">    --------</span></span>
<span id="cb5-53"><a href="#cb5-53" aria-hidden="true" tabindex="-1"></a><span class="co">    pandas.DataFrame</span></span>
<span id="cb5-54"><a href="#cb5-54" aria-hidden="true" tabindex="-1"></a><span class="co">        지정된 시트들을 합친 데이터프레임</span></span>
<span id="cb5-55"><a href="#cb5-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-56"><a href="#cb5-56" aria-hidden="true" tabindex="-1"></a><span class="co">    Example:</span></span>
<span id="cb5-57"><a href="#cb5-57" aria-hidden="true" tabindex="-1"></a><span class="co">    --------</span></span>
<span id="cb5-58"><a href="#cb5-58" aria-hidden="true" tabindex="-1"></a><span class="co">    # 특정 시트만 처리</span></span>
<span id="cb5-59"><a href="#cb5-59" aria-hidden="true" tabindex="-1"></a><span class="co">    df = process_6th_governor_election5(</span></span>
<span id="cb5-60"><a href="#cb5-60" aria-hidden="true" tabindex="-1"></a><span class="co">        'election.xlsx',</span></span>
<span id="cb5-61"><a href="#cb5-61" aria-hidden="true" tabindex="-1"></a><span class="co">        header_rows=(2, 4),</span></span>
<span id="cb5-62"><a href="#cb5-62" aria-hidden="true" tabindex="-1"></a><span class="co">        filter_column='읍면동명',</span></span>
<span id="cb5-63"><a href="#cb5-63" aria-hidden="true" tabindex="-1"></a><span class="co">        filter_value='합계',</span></span>
<span id="cb5-64"><a href="#cb5-64" aria-hidden="true" tabindex="-1"></a><span class="co">        sheet_names='세종특별자치시장'  # 한 시트만</span></span>
<span id="cb5-65"><a href="#cb5-65" aria-hidden="true" tabindex="-1"></a><span class="co">    )</span></span>
<span id="cb5-66"><a href="#cb5-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-67"><a href="#cb5-67" aria-hidden="true" tabindex="-1"></a><span class="co">    # 여러 시트 처리</span></span>
<span id="cb5-68"><a href="#cb5-68" aria-hidden="true" tabindex="-1"></a><span class="co">    df = process_6th_governor_election5(</span></span>
<span id="cb5-69"><a href="#cb5-69" aria-hidden="true" tabindex="-1"></a><span class="co">        'election.xlsx',</span></span>
<span id="cb5-70"><a href="#cb5-70" aria-hidden="true" tabindex="-1"></a><span class="co">        sheet_names=['세종특별자치시장', '세종시의원']  # 두 시트만</span></span>
<span id="cb5-71"><a href="#cb5-71" aria-hidden="true" tabindex="-1"></a><span class="co">    )</span></span>
<span id="cb5-72"><a href="#cb5-72" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb5-73"><a href="#cb5-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-74"><a href="#cb5-74" aria-hidden="true" tabindex="-1"></a>    <span class="co"># GitHub URL인 경우 raw URL로 변환</span></span>
<span id="cb5-75"><a href="#cb5-75" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> file_path_or_url.startswith(<span class="st">'https://github.com'</span>):</span>
<span id="cb5-76"><a href="#cb5-76" aria-hidden="true" tabindex="-1"></a>        file_path_or_url <span class="op">=</span> convert_github_url_to_raw(file_path_or_url)</span>
<span id="cb5-77"><a href="#cb5-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-78"><a href="#cb5-78" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 모든 시트 이름 가져오기</span></span>
<span id="cb5-79"><a href="#cb5-79" aria-hidden="true" tabindex="-1"></a>    excel_file <span class="op">=</span> pd.ExcelFile(file_path_or_url)</span>
<span id="cb5-80"><a href="#cb5-80" aria-hidden="true" tabindex="-1"></a>    all_sheet_names <span class="op">=</span> excel_file.sheet_names</span>
<span id="cb5-81"><a href="#cb5-81" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"파일의 전체 시트: </span><span class="sc">{</span><span class="bu">len</span>(all_sheet_names)<span class="sc">}</span><span class="ss">개"</span>)</span>
<span id="cb5-82"><a href="#cb5-82" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"시트 목록: </span><span class="sc">{</span>all_sheet_names<span class="sc">}</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb5-83"><a href="#cb5-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-84"><a href="#cb5-84" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 처리할 시트 결정</span></span>
<span id="cb5-85"><a href="#cb5-85" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> sheet_names <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb5-86"><a href="#cb5-86" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 모든 시트 처리</span></span>
<span id="cb5-87"><a href="#cb5-87" aria-hidden="true" tabindex="-1"></a>        sheets_to_process <span class="op">=</span> all_sheet_names</span>
<span id="cb5-88"><a href="#cb5-88" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"모든 시트를 처리합니다."</span>)</span>
<span id="cb5-89"><a href="#cb5-89" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb5-90"><a href="#cb5-90" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 특정 시트만 처리</span></span>
<span id="cb5-91"><a href="#cb5-91" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">isinstance</span>(sheet_names, <span class="bu">str</span>):</span>
<span id="cb5-92"><a href="#cb5-92" aria-hidden="true" tabindex="-1"></a>            sheets_to_process <span class="op">=</span> [sheet_names]</span>
<span id="cb5-93"><a href="#cb5-93" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb5-94"><a href="#cb5-94" aria-hidden="true" tabindex="-1"></a>            sheets_to_process <span class="op">=</span> sheet_names</span>
<span id="cb5-95"><a href="#cb5-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-96"><a href="#cb5-96" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 존재하는 시트인지 확인</span></span>
<span id="cb5-97"><a href="#cb5-97" aria-hidden="true" tabindex="-1"></a>        invalid_sheets <span class="op">=</span> [s <span class="cf">for</span> s <span class="kw">in</span> sheets_to_process <span class="cf">if</span> s <span class="kw">not</span> <span class="kw">in</span> all_sheet_names]</span>
<span id="cb5-98"><a href="#cb5-98" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> invalid_sheets:</span>
<span id="cb5-99"><a href="#cb5-99" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"경고: 다음 시트가 존재하지 않습니다: </span><span class="sc">{</span>invalid_sheets<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb5-100"><a href="#cb5-100" aria-hidden="true" tabindex="-1"></a>            sheets_to_process <span class="op">=</span> [s <span class="cf">for</span> s <span class="kw">in</span> sheets_to_process <span class="cf">if</span> s <span class="kw">in</span> all_sheet_names]</span>
<span id="cb5-101"><a href="#cb5-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-102"><a href="#cb5-102" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> sheets_to_process:</span>
<span id="cb5-103"><a href="#cb5-103" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">"처리할 유효한 시트가 없습니다."</span>)</span>
<span id="cb5-104"><a href="#cb5-104" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> pd.DataFrame()</span>
<span id="cb5-105"><a href="#cb5-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-106"><a href="#cb5-106" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"선택된 시트 </span><span class="sc">{</span><span class="bu">len</span>(sheets_to_process)<span class="sc">}</span><span class="ss">개를 처리합니다: </span><span class="sc">{</span>sheets_to_process<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb5-107"><a href="#cb5-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-108"><a href="#cb5-108" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 각 시트의 결과를 저장할 리스트</span></span>
<span id="cb5-109"><a href="#cb5-109" aria-hidden="true" tabindex="-1"></a>    all_dfs <span class="op">=</span> []</span>
<span id="cb5-110"><a href="#cb5-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-111"><a href="#cb5-111" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 선택된 시트만 처리</span></span>
<span id="cb5-112"><a href="#cb5-112" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> sheet_idx, sheet_name <span class="kw">in</span> <span class="bu">enumerate</span>(sheets_to_process):</span>
<span id="cb5-113"><a href="#cb5-113" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="sc">{</span><span class="st">'='</span><span class="op">*</span><span class="dv">50</span><span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb5-114"><a href="#cb5-114" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"시트 </span><span class="sc">{</span>sheet_idx<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">/</span><span class="sc">{</span><span class="bu">len</span>(sheets_to_process)<span class="sc">}</span><span class="ss">: '</span><span class="sc">{</span>sheet_name<span class="sc">}</span><span class="ss">' 처리 중..."</span>)</span>
<span id="cb5-115"><a href="#cb5-115" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span><span class="st">'='</span><span class="op">*</span><span class="dv">50</span><span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb5-116"><a href="#cb5-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-117"><a href="#cb5-117" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 파일을 header 없이 읽기</span></span>
<span id="cb5-118"><a href="#cb5-118" aria-hidden="true" tabindex="-1"></a>        df_raw <span class="op">=</span> pd.read_excel(file_path_or_url, sheet_name<span class="op">=</span>sheet_name, header<span class="op">=</span><span class="va">None</span>)</span>
<span id="cb5-119"><a href="#cb5-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-120"><a href="#cb5-120" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 빈 시트 체크</span></span>
<span id="cb5-121"><a href="#cb5-121" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> df_raw.empty <span class="kw">or</span> <span class="bu">len</span>(df_raw) <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb5-122"><a href="#cb5-122" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"'</span><span class="sc">{</span>sheet_name<span class="sc">}</span><span class="ss">' 시트가 비어있습니다. 건너뜁니다."</span>)</span>
<span id="cb5-123"><a href="#cb5-123" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span></span>
<span id="cb5-124"><a href="#cb5-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-125"><a href="#cb5-125" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 엑셀 행 번호를 파이썬 인덱스로 변환</span></span>
<span id="cb5-126"><a href="#cb5-126" aria-hidden="true" tabindex="-1"></a>        start_idx <span class="op">=</span> header_rows[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb5-127"><a href="#cb5-127" aria-hidden="true" tabindex="-1"></a>        end_idx <span class="op">=</span> header_rows[<span class="dv">1</span>] <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb5-128"><a href="#cb5-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-129"><a href="#cb5-129" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 헤더 행이 충분한지 확인</span></span>
<span id="cb5-130"><a href="#cb5-130" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(df_raw) <span class="op">&lt;=</span> end_idx:</span>
<span id="cb5-131"><a href="#cb5-131" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"'</span><span class="sc">{</span>sheet_name<span class="sc">}</span><span class="ss">' 시트의 행이 부족합니다. 건너뜁니다."</span>)</span>
<span id="cb5-132"><a href="#cb5-132" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span></span>
<span id="cb5-133"><a href="#cb5-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-134"><a href="#cb5-134" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 지정된 행들을 가져와서 컬럼명 생성</span></span>
<span id="cb5-135"><a href="#cb5-135" aria-hidden="true" tabindex="-1"></a>        header_rows_data <span class="op">=</span> []</span>
<span id="cb5-136"><a href="#cb5-136" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(start_idx, end_idx <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb5-137"><a href="#cb5-137" aria-hidden="true" tabindex="-1"></a>            header_rows_data.append(df_raw.iloc[i].fillna(<span class="st">'_'</span>).astype(<span class="bu">str</span>))</span>
<span id="cb5-138"><a href="#cb5-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-139"><a href="#cb5-139" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 컬럼명 생성</span></span>
<span id="cb5-140"><a href="#cb5-140" aria-hidden="true" tabindex="-1"></a>        new_columns <span class="op">=</span> []</span>
<span id="cb5-141"><a href="#cb5-141" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> col_idx <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(header_rows_data[<span class="dv">0</span>])):</span>
<span id="cb5-142"><a href="#cb5-142" aria-hidden="true" tabindex="-1"></a>            parts <span class="op">=</span> []</span>
<span id="cb5-143"><a href="#cb5-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-144"><a href="#cb5-144" aria-hidden="true" tabindex="-1"></a>            <span class="co"># 각 행의 값이 '_'가 아닌 경우만 추가</span></span>
<span id="cb5-145"><a href="#cb5-145" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> row_data <span class="kw">in</span> header_rows_data:</span>
<span id="cb5-146"><a href="#cb5-146" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> row_data[col_idx] <span class="op">!=</span> <span class="st">'_'</span>:</span>
<span id="cb5-147"><a href="#cb5-147" aria-hidden="true" tabindex="-1"></a>                    parts.append(row_data[col_idx])</span>
<span id="cb5-148"><a href="#cb5-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-149"><a href="#cb5-149" aria-hidden="true" tabindex="-1"></a>            <span class="co"># parts가 비어있으면 '_', 아니면 '_'로 연결</span></span>
<span id="cb5-150"><a href="#cb5-150" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> parts:</span>
<span id="cb5-151"><a href="#cb5-151" aria-hidden="true" tabindex="-1"></a>                new_columns.append(<span class="st">'_'</span>.join(parts))</span>
<span id="cb5-152"><a href="#cb5-152" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb5-153"><a href="#cb5-153" aria-hidden="true" tabindex="-1"></a>                new_columns.append(<span class="st">'_'</span>)</span>
<span id="cb5-154"><a href="#cb5-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-155"><a href="#cb5-155" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 데이터프레임 재구성</span></span>
<span id="cb5-156"><a href="#cb5-156" aria-hidden="true" tabindex="-1"></a>        data_start_idx <span class="op">=</span> end_idx <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb5-157"><a href="#cb5-157" aria-hidden="true" tabindex="-1"></a>        df <span class="op">=</span> df_raw.iloc[data_start_idx:].copy()</span>
<span id="cb5-158"><a href="#cb5-158" aria-hidden="true" tabindex="-1"></a>        df.columns <span class="op">=</span> new_columns</span>
<span id="cb5-159"><a href="#cb5-159" aria-hidden="true" tabindex="-1"></a>        df <span class="op">=</span> df.reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb5-160"><a href="#cb5-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-161"><a href="#cb5-161" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"데이터 행 수: </span><span class="sc">{</span><span class="bu">len</span>(df)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb5-162"><a href="#cb5-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-163"><a href="#cb5-163" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 필터링 적용</span></span>
<span id="cb5-164"><a href="#cb5-164" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> filter_column <span class="kw">and</span> filter_value:</span>
<span id="cb5-165"><a href="#cb5-165" aria-hidden="true" tabindex="-1"></a>            <span class="co"># 필터링할 컬럼 찾기</span></span>
<span id="cb5-166"><a href="#cb5-166" aria-hidden="true" tabindex="-1"></a>            matching_col <span class="op">=</span> <span class="va">None</span></span>
<span id="cb5-167"><a href="#cb5-167" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> col <span class="kw">in</span> df.columns:</span>
<span id="cb5-168"><a href="#cb5-168" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> filter_column <span class="kw">in</span> col:</span>
<span id="cb5-169"><a href="#cb5-169" aria-hidden="true" tabindex="-1"></a>                    matching_col <span class="op">=</span> col</span>
<span id="cb5-170"><a href="#cb5-170" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">break</span></span>
<span id="cb5-171"><a href="#cb5-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-172"><a href="#cb5-172" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> matching_col:</span>
<span id="cb5-173"><a href="#cb5-173" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 필터링 적용</span></span>
<span id="cb5-174"><a href="#cb5-174" aria-hidden="true" tabindex="-1"></a>                df <span class="op">=</span> df[df[matching_col] <span class="op">==</span> filter_value].copy()</span>
<span id="cb5-175"><a href="#cb5-175" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f"필터링 적용: '</span><span class="sc">{</span>matching_col<span class="sc">}</span><span class="ss">' == '</span><span class="sc">{</span>filter_value<span class="sc">}</span><span class="ss">' → </span><span class="sc">{</span><span class="bu">len</span>(df)<span class="sc">}</span><span class="ss">행"</span>)</span>
<span id="cb5-176"><a href="#cb5-176" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb5-177"><a href="#cb5-177" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f"경고: '</span><span class="sc">{</span>filter_column<span class="sc">}</span><span class="ss">'을 포함하는 컬럼을 찾을 수 없습니다."</span>)</span>
<span id="cb5-178"><a href="#cb5-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-179"><a href="#cb5-179" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 시트명 열 추가</span></span>
<span id="cb5-180"><a href="#cb5-180" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> add_sheet_name_column <span class="kw">and</span> <span class="bu">len</span>(df) <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb5-181"><a href="#cb5-181" aria-hidden="true" tabindex="-1"></a>            df.insert(<span class="dv">0</span>, <span class="st">'시트명'</span>, sheet_name)</span>
<span id="cb5-182"><a href="#cb5-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-183"><a href="#cb5-183" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 결과 리스트에 추가</span></span>
<span id="cb5-184"><a href="#cb5-184" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(df) <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb5-185"><a href="#cb5-185" aria-hidden="true" tabindex="-1"></a>            all_dfs.append(df)</span>
<span id="cb5-186"><a href="#cb5-186" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"'</span><span class="sc">{</span>sheet_name<span class="sc">}</span><span class="ss">' 시트 처리 완료: </span><span class="sc">{</span><span class="bu">len</span>(df)<span class="sc">}</span><span class="ss">행 추가됨"</span>)</span>
<span id="cb5-187"><a href="#cb5-187" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb5-188"><a href="#cb5-188" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"'</span><span class="sc">{</span>sheet_name<span class="sc">}</span><span class="ss">' 시트에 데이터가 없습니다."</span>)</span>
<span id="cb5-189"><a href="#cb5-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-190"><a href="#cb5-190" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 모든 데이터프레임 합치기</span></span>
<span id="cb5-191"><a href="#cb5-191" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> all_dfs:</span>
<span id="cb5-192"><a href="#cb5-192" aria-hidden="true" tabindex="-1"></a>        combined_df <span class="op">=</span> pd.concat(all_dfs, ignore_index<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb5-193"><a href="#cb5-193" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="sc">{</span><span class="st">'='</span><span class="op">*</span><span class="dv">50</span><span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb5-194"><a href="#cb5-194" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"최종 결과: 총 </span><span class="sc">{</span><span class="bu">len</span>(combined_df)<span class="sc">}</span><span class="ss">행의 데이터"</span>)</span>
<span id="cb5-195"><a href="#cb5-195" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span><span class="st">'='</span><span class="op">*</span><span class="dv">50</span><span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb5-196"><a href="#cb5-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-197"><a href="#cb5-197" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> combined_df</span>
<span id="cb5-198"><a href="#cb5-198" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb5-199"><a href="#cb5-199" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">처리된 데이터가 없습니다."</span>)</span>
<span id="cb5-200"><a href="#cb5-200" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> pd.DataFrame()</span>
<span id="cb5-201"><a href="#cb5-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-202"><a href="#cb5-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-203"><a href="#cb5-203" aria-hidden="true" tabindex="-1"></a><span class="co"># 사용 예시</span></span>
<span id="cb5-204"><a href="#cb5-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-205"><a href="#cb5-205" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. 특정 시트 하나만 처리</span></span>
<span id="cb5-206"><a href="#cb5-206" aria-hidden="true" tabindex="-1"></a><span class="co"># sejong_mayor = process_6th_governor_election5(</span></span>
<span id="cb5-207"><a href="#cb5-207" aria-hidden="true" tabindex="-1"></a><span class="co">#     '제6회 전국동시지방선거 읍면동별 개표자료세종.xlsx',</span></span>
<span id="cb5-208"><a href="#cb5-208" aria-hidden="true" tabindex="-1"></a><span class="co">#     header_rows=(2, 4),</span></span>
<span id="cb5-209"><a href="#cb5-209" aria-hidden="true" tabindex="-1"></a><span class="co">#     filter_column='읍면동명',</span></span>
<span id="cb5-210"><a href="#cb5-210" aria-hidden="true" tabindex="-1"></a><span class="co">#     filter_value='합계',</span></span>
<span id="cb5-211"><a href="#cb5-211" aria-hidden="true" tabindex="-1"></a><span class="co">#     sheet_names='세종특별자치시장'  # 시장 선거 데이터만</span></span>
<span id="cb5-212"><a href="#cb5-212" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span>
<span id="cb5-213"><a href="#cb5-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-214"><a href="#cb5-214" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. 여러 특정 시트 처리</span></span>
<span id="cb5-215"><a href="#cb5-215" aria-hidden="true" tabindex="-1"></a><span class="co"># sejong_elections = process_6th_governor_election5(</span></span>
<span id="cb5-216"><a href="#cb5-216" aria-hidden="true" tabindex="-1"></a><span class="co">#     'sejong_election.xlsx',</span></span>
<span id="cb5-217"><a href="#cb5-217" aria-hidden="true" tabindex="-1"></a><span class="co">#     header_rows=(2, 4),</span></span>
<span id="cb5-218"><a href="#cb5-218" aria-hidden="true" tabindex="-1"></a><span class="co">#     sheet_names=['세종특별자치시장', '세종시의원', '세종교육감']</span></span>
<span id="cb5-219"><a href="#cb5-219" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span>
<span id="cb5-220"><a href="#cb5-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-221"><a href="#cb5-221" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. 모든 시트 처리 (sheet_names=None 또는 생략)</span></span>
<span id="cb5-222"><a href="#cb5-222" aria-hidden="true" tabindex="-1"></a><span class="co"># all_data = process_6th_governor_election5(</span></span>
<span id="cb5-223"><a href="#cb5-223" aria-hidden="true" tabindex="-1"></a><span class="co">#     'election.xlsx',</span></span>
<span id="cb5-224"><a href="#cb5-224" aria-hidden="true" tabindex="-1"></a><span class="co">#     header_rows=(2, 4)</span></span>
<span id="cb5-225"><a href="#cb5-225" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="section-5" class="level3">
<h3 class="anchored" data-anchor-id="section-5">6</h3>
<div id="cell-14" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> convert_github_url_to_raw(github_url):</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co">    깃허브 blob URL을 raw URL로 변환</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="co">    Parameters:</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="co">    -----------</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="co">    github_url : str</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="co">        깃허브 파일 URL</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns:</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="co">    --------</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="co">    str</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a><span class="co">        raw URL (pandas가 직접 읽을 수 있는 형태)</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="st">'/blob/'</span> <span class="kw">in</span> github_url:</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> github_url.replace(<span class="st">'/blob/'</span>, <span class="st">'/raw/'</span>)</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> github_url</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> process_5th_governor_election6(</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>    file_path_or_url,</span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>    header_rows<span class="op">=</span>(<span class="dv">3</span>, <span class="dv">4</span>),  <span class="co"># 엑셀 기준 행 번호 (3행부터 4행까지)</span></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>    filter_column<span class="op">=</span><span class="st">'읍면동명'</span>,</span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>    filter_value<span class="op">=</span><span class="st">'합계'</span>,</span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>    extract_district<span class="op">=</span><span class="va">True</span></span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a><span class="co">    제5회 선거 데이터를 처리하는 함수 (구시군명 자동 추출)</span></span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a><span class="co">    Parameters:</span></span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a><span class="co">    -----------</span></span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a><span class="co">    file_path_or_url : str</span></span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a><span class="co">        로컬 파일 경로 또는 GitHub URL</span></span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a><span class="co">    header_rows : tuple</span></span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a><span class="co">        헤더로 사용할 행 범위 (엑셀 기준 행 번호)</span></span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a><span class="co">        예: (3, 4) = 3행부터 4행까지</span></span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a><span class="co">    filter_column : str</span></span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a><span class="co">        필터링할 컬럼명 (기본값: '읍면동명')</span></span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a><span class="co">    filter_value : str</span></span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true" tabindex="-1"></a><span class="co">        필터링할 값 (기본값: '합계')</span></span>
<span id="cb6-45"><a href="#cb6-45" aria-hidden="true" tabindex="-1"></a><span class="co">    extract_district : bool</span></span>
<span id="cb6-46"><a href="#cb6-46" aria-hidden="true" tabindex="-1"></a><span class="co">        구시군명을 추출할지 여부 (기본값: True)</span></span>
<span id="cb6-47"><a href="#cb6-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-48"><a href="#cb6-48" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns:</span></span>
<span id="cb6-49"><a href="#cb6-49" aria-hidden="true" tabindex="-1"></a><span class="co">    --------</span></span>
<span id="cb6-50"><a href="#cb6-50" aria-hidden="true" tabindex="-1"></a><span class="co">    pandas.DataFrame</span></span>
<span id="cb6-51"><a href="#cb6-51" aria-hidden="true" tabindex="-1"></a><span class="co">        처리된 데이터프레임</span></span>
<span id="cb6-52"><a href="#cb6-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-53"><a href="#cb6-53" aria-hidden="true" tabindex="-1"></a><span class="co">    Example:</span></span>
<span id="cb6-54"><a href="#cb6-54" aria-hidden="true" tabindex="-1"></a><span class="co">    --------</span></span>
<span id="cb6-55"><a href="#cb6-55" aria-hidden="true" tabindex="-1"></a><span class="co">    # 부산시장개표진행상황읍면동별.xlsx 처리</span></span>
<span id="cb6-56"><a href="#cb6-56" aria-hidden="true" tabindex="-1"></a><span class="co">    df = process_5th_governor_election6(</span></span>
<span id="cb6-57"><a href="#cb6-57" aria-hidden="true" tabindex="-1"></a><span class="co">        '부산시장개표진행상황읍면동별.xlsx',</span></span>
<span id="cb6-58"><a href="#cb6-58" aria-hidden="true" tabindex="-1"></a><span class="co">        header_rows=(3, 4),</span></span>
<span id="cb6-59"><a href="#cb6-59" aria-hidden="true" tabindex="-1"></a><span class="co">        filter_column='읍면동명',</span></span>
<span id="cb6-60"><a href="#cb6-60" aria-hidden="true" tabindex="-1"></a><span class="co">        filter_value='합계'</span></span>
<span id="cb6-61"><a href="#cb6-61" aria-hidden="true" tabindex="-1"></a><span class="co">    )</span></span>
<span id="cb6-62"><a href="#cb6-62" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb6-63"><a href="#cb6-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-64"><a href="#cb6-64" aria-hidden="true" tabindex="-1"></a>    <span class="co"># GitHub URL인 경우 raw URL로 변환</span></span>
<span id="cb6-65"><a href="#cb6-65" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> file_path_or_url.startswith(<span class="st">'https://github.com'</span>):</span>
<span id="cb6-66"><a href="#cb6-66" aria-hidden="true" tabindex="-1"></a>        file_path_or_url <span class="op">=</span> convert_github_url_to_raw(file_path_or_url)</span>
<span id="cb6-67"><a href="#cb6-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-68"><a href="#cb6-68" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 파일을 header 없이 읽기</span></span>
<span id="cb6-69"><a href="#cb6-69" aria-hidden="true" tabindex="-1"></a>    df_raw <span class="op">=</span> pd.read_excel(file_path_or_url, header<span class="op">=</span><span class="va">None</span>)</span>
<span id="cb6-70"><a href="#cb6-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-71"><a href="#cb6-71" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 엑셀 행 번호를 파이썬 인덱스로 변환</span></span>
<span id="cb6-72"><a href="#cb6-72" aria-hidden="true" tabindex="-1"></a>    start_idx <span class="op">=</span> header_rows[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb6-73"><a href="#cb6-73" aria-hidden="true" tabindex="-1"></a>    end_idx <span class="op">=</span> header_rows[<span class="dv">1</span>] <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb6-74"><a href="#cb6-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-75"><a href="#cb6-75" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 지정된 행들을 가져와서 컬럼명 생성</span></span>
<span id="cb6-76"><a href="#cb6-76" aria-hidden="true" tabindex="-1"></a>    header_rows_data <span class="op">=</span> []</span>
<span id="cb6-77"><a href="#cb6-77" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(start_idx, end_idx <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb6-78"><a href="#cb6-78" aria-hidden="true" tabindex="-1"></a>        header_rows_data.append(df_raw.iloc[i].fillna(<span class="st">'_'</span>).astype(<span class="bu">str</span>))</span>
<span id="cb6-79"><a href="#cb6-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-80"><a href="#cb6-80" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 컬럼명 생성</span></span>
<span id="cb6-81"><a href="#cb6-81" aria-hidden="true" tabindex="-1"></a>    new_columns <span class="op">=</span> []</span>
<span id="cb6-82"><a href="#cb6-82" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> col_idx <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(header_rows_data[<span class="dv">0</span>])):</span>
<span id="cb6-83"><a href="#cb6-83" aria-hidden="true" tabindex="-1"></a>        parts <span class="op">=</span> []</span>
<span id="cb6-84"><a href="#cb6-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-85"><a href="#cb6-85" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 각 행의 값이 '_'가 아닌 경우만 추가</span></span>
<span id="cb6-86"><a href="#cb6-86" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> row_data <span class="kw">in</span> header_rows_data:</span>
<span id="cb6-87"><a href="#cb6-87" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> row_data[col_idx] <span class="op">!=</span> <span class="st">'_'</span>:</span>
<span id="cb6-88"><a href="#cb6-88" aria-hidden="true" tabindex="-1"></a>                parts.append(row_data[col_idx])</span>
<span id="cb6-89"><a href="#cb6-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-90"><a href="#cb6-90" aria-hidden="true" tabindex="-1"></a>        <span class="co"># parts가 비어있으면 '_', 아니면 '_'로 연결</span></span>
<span id="cb6-91"><a href="#cb6-91" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> parts:</span>
<span id="cb6-92"><a href="#cb6-92" aria-hidden="true" tabindex="-1"></a>            new_columns.append(<span class="st">'_'</span>.join(parts))</span>
<span id="cb6-93"><a href="#cb6-93" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb6-94"><a href="#cb6-94" aria-hidden="true" tabindex="-1"></a>            new_columns.append(<span class="st">'_'</span>)</span>
<span id="cb6-95"><a href="#cb6-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-96"><a href="#cb6-96" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 데이터프레임 재구성 (헤더 다음 행부터 데이터로 사용)</span></span>
<span id="cb6-97"><a href="#cb6-97" aria-hidden="true" tabindex="-1"></a>    data_start_idx <span class="op">=</span> end_idx <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb6-98"><a href="#cb6-98" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> df_raw.iloc[data_start_idx:].copy()</span>
<span id="cb6-99"><a href="#cb6-99" aria-hidden="true" tabindex="-1"></a>    df.columns <span class="op">=</span> new_columns</span>
<span id="cb6-100"><a href="#cb6-100" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> df.reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb6-101"><a href="#cb6-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-102"><a href="#cb6-102" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"헤더 행: </span><span class="sc">{</span>header_rows[<span class="dv">0</span>]<span class="sc">}</span><span class="ss">행 ~ </span><span class="sc">{</span>header_rows[<span class="dv">1</span>]<span class="sc">}</span><span class="ss">행"</span>)</span>
<span id="cb6-103"><a href="#cb6-103" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"생성된 컬럼 수: </span><span class="sc">{</span><span class="bu">len</span>(new_columns)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb6-104"><a href="#cb6-104" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"데이터 행 수: </span><span class="sc">{</span><span class="bu">len</span>(df)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb6-105"><a href="#cb6-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-106"><a href="#cb6-106" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 필터링할 컬럼 찾기</span></span>
<span id="cb6-107"><a href="#cb6-107" aria-hidden="true" tabindex="-1"></a>    matching_col <span class="op">=</span> <span class="va">None</span></span>
<span id="cb6-108"><a href="#cb6-108" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> col <span class="kw">in</span> df.columns:</span>
<span id="cb6-109"><a href="#cb6-109" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> filter_column <span class="kw">in</span> col:</span>
<span id="cb6-110"><a href="#cb6-110" aria-hidden="true" tabindex="-1"></a>            matching_col <span class="op">=</span> col</span>
<span id="cb6-111"><a href="#cb6-111" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span></span>
<span id="cb6-112"><a href="#cb6-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-113"><a href="#cb6-113" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> matching_col:</span>
<span id="cb6-114"><a href="#cb6-114" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">경고: '</span><span class="sc">{</span>filter_column<span class="sc">}</span><span class="ss">'을 포함하는 컬럼을 찾을 수 없습니다."</span>)</span>
<span id="cb6-115"><a href="#cb6-115" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> df</span>
<span id="cb6-116"><a href="#cb6-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-117"><a href="#cb6-117" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">'</span><span class="sc">{</span>filter_column<span class="sc">}</span><span class="ss">' 컬럼 발견: </span><span class="sc">{</span>matching_col<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb6-118"><a href="#cb6-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-119"><a href="#cb6-119" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 구시군명 추출을 위한 준비</span></span>
<span id="cb6-120"><a href="#cb6-120" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> extract_district:</span>
<span id="cb6-121"><a href="#cb6-121" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 원본 데이터에서 구시군명 추출</span></span>
<span id="cb6-122"><a href="#cb6-122" aria-hidden="true" tabindex="-1"></a>        district_info <span class="op">=</span> {}</span>
<span id="cb6-123"><a href="#cb6-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-124"><a href="#cb6-124" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 전체 원본 데이터에서 패턴 찾기</span></span>
<span id="cb6-125"><a href="#cb6-125" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> idx <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(df_raw)):</span>
<span id="cb6-126"><a href="#cb6-126" aria-hidden="true" tabindex="-1"></a>            cell_value <span class="op">=</span> <span class="bu">str</span>(df_raw.iloc[idx, <span class="dv">0</span>])  <span class="co"># 첫 번째 열 확인</span></span>
<span id="cb6-127"><a href="#cb6-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-128"><a href="#cb6-128" aria-hidden="true" tabindex="-1"></a>            <span class="co"># [지역][구분][구시군명] 패턴 찾기</span></span>
<span id="cb6-129"><a href="#cb6-129" aria-hidden="true" tabindex="-1"></a>            pattern <span class="op">=</span> <span class="vs">r'\[([^\]]+)\]\[([^\]]+)\]\[([^\]]+)\]'</span></span>
<span id="cb6-130"><a href="#cb6-130" aria-hidden="true" tabindex="-1"></a>            match <span class="op">=</span> re.match(pattern, cell_value)</span>
<span id="cb6-131"><a href="#cb6-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-132"><a href="#cb6-132" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> match:</span>
<span id="cb6-133"><a href="#cb6-133" aria-hidden="true" tabindex="-1"></a>                current_district <span class="op">=</span> match.group(<span class="dv">3</span>)  <span class="co"># 세 번째 대괄호 내용</span></span>
<span id="cb6-134"><a href="#cb6-134" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 해당 행 이후의 '합계' 행들에 적용</span></span>
<span id="cb6-135"><a href="#cb6-135" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> future_idx <span class="kw">in</span> <span class="bu">range</span>(idx <span class="op">+</span> <span class="dv">1</span>, <span class="bu">min</span>(idx <span class="op">+</span> <span class="dv">50</span>, <span class="bu">len</span>(df_raw))):</span>
<span id="cb6-136"><a href="#cb6-136" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> future_idx <span class="op">-</span> data_start_idx <span class="op">&gt;=</span> <span class="dv">0</span> <span class="kw">and</span> future_idx <span class="op">-</span> data_start_idx <span class="op">&lt;</span> <span class="bu">len</span>(df):</span>
<span id="cb6-137"><a href="#cb6-137" aria-hidden="true" tabindex="-1"></a>                        district_info[future_idx <span class="op">-</span> data_start_idx] <span class="op">=</span> current_district</span>
<span id="cb6-138"><a href="#cb6-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-139"><a href="#cb6-139" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 필터링 적용</span></span>
<span id="cb6-140"><a href="#cb6-140" aria-hidden="true" tabindex="-1"></a>    filtered_indices <span class="op">=</span> df[df[matching_col] <span class="op">==</span> filter_value].index.tolist()</span>
<span id="cb6-141"><a href="#cb6-141" aria-hidden="true" tabindex="-1"></a>    filtered_df <span class="op">=</span> df[df[matching_col] <span class="op">==</span> filter_value].copy()</span>
<span id="cb6-142"><a href="#cb6-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-143"><a href="#cb6-143" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 구시군명 열 추가</span></span>
<span id="cb6-144"><a href="#cb6-144" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> extract_district <span class="kw">and</span> filtered_indices:</span>
<span id="cb6-145"><a href="#cb6-145" aria-hidden="true" tabindex="-1"></a>        district_names <span class="op">=</span> []</span>
<span id="cb6-146"><a href="#cb6-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-147"><a href="#cb6-147" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> idx <span class="kw">in</span> filtered_indices:</span>
<span id="cb6-148"><a href="#cb6-148" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> idx <span class="kw">in</span> district_info:</span>
<span id="cb6-149"><a href="#cb6-149" aria-hidden="true" tabindex="-1"></a>                district_names.append(district_info[idx])</span>
<span id="cb6-150"><a href="#cb6-150" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb6-151"><a href="#cb6-151" aria-hidden="true" tabindex="-1"></a>                <span class="co"># district_info에 없는 경우 해당 행 위의 패턴 직접 찾기</span></span>
<span id="cb6-152"><a href="#cb6-152" aria-hidden="true" tabindex="-1"></a>                found <span class="op">=</span> <span class="va">False</span></span>
<span id="cb6-153"><a href="#cb6-153" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> back_idx <span class="kw">in</span> <span class="bu">range</span>(idx <span class="op">+</span> data_start_idx <span class="op">-</span> <span class="dv">1</span>, <span class="bu">max</span>(<span class="dv">0</span>, idx <span class="op">+</span> data_start_idx <span class="op">-</span> <span class="dv">10</span>), <span class="op">-</span><span class="dv">1</span>):</span>
<span id="cb6-154"><a href="#cb6-154" aria-hidden="true" tabindex="-1"></a>                    cell_value <span class="op">=</span> <span class="bu">str</span>(df_raw.iloc[back_idx, <span class="dv">0</span>])</span>
<span id="cb6-155"><a href="#cb6-155" aria-hidden="true" tabindex="-1"></a>                    pattern <span class="op">=</span> <span class="vs">r'\[([^\]]+)\]\[([^\]]+)\]\[([^\]]+)\]'</span></span>
<span id="cb6-156"><a href="#cb6-156" aria-hidden="true" tabindex="-1"></a>                    match <span class="op">=</span> re.match(pattern, cell_value)</span>
<span id="cb6-157"><a href="#cb6-157" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> match:</span>
<span id="cb6-158"><a href="#cb6-158" aria-hidden="true" tabindex="-1"></a>                        district_names.append(match.group(<span class="dv">3</span>))</span>
<span id="cb6-159"><a href="#cb6-159" aria-hidden="true" tabindex="-1"></a>                        found <span class="op">=</span> <span class="va">True</span></span>
<span id="cb6-160"><a href="#cb6-160" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">break</span></span>
<span id="cb6-161"><a href="#cb6-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-162"><a href="#cb6-162" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="kw">not</span> found:</span>
<span id="cb6-163"><a href="#cb6-163" aria-hidden="true" tabindex="-1"></a>                    district_names.append(<span class="st">'알수없음'</span>)</span>
<span id="cb6-164"><a href="#cb6-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-165"><a href="#cb6-165" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 구시군명 열을 맨 앞에 추가</span></span>
<span id="cb6-166"><a href="#cb6-166" aria-hidden="true" tabindex="-1"></a>        filtered_df.insert(<span class="dv">0</span>, <span class="st">'구시군명'</span>, district_names)</span>
<span id="cb6-167"><a href="#cb6-167" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">구시군명 열 추가 완료"</span>)</span>
<span id="cb6-168"><a href="#cb6-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-169"><a href="#cb6-169" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">필터링 전: </span><span class="sc">{</span><span class="bu">len</span>(df)<span class="sc">}</span><span class="ss">행 → 필터링 후: </span><span class="sc">{</span><span class="bu">len</span>(filtered_df)<span class="sc">}</span><span class="ss">행"</span>)</span>
<span id="cb6-170"><a href="#cb6-170" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"'</span><span class="sc">{</span>matching_col<span class="sc">}</span><span class="ss">' == '</span><span class="sc">{</span>filter_value<span class="sc">}</span><span class="ss">'인 행만 추출"</span>)</span>
<span id="cb6-171"><a href="#cb6-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-172"><a href="#cb6-172" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 첫 몇 행 출력하여 확인</span></span>
<span id="cb6-173"><a href="#cb6-173" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(filtered_df) <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb6-174"><a href="#cb6-174" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">결과 데이터 샘플:"</span>)</span>
<span id="cb6-175"><a href="#cb6-175" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(filtered_df.head())</span>
<span id="cb6-176"><a href="#cb6-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-177"><a href="#cb6-177" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> filtered_df</span>
<span id="cb6-178"><a href="#cb6-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-179"><a href="#cb6-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-180"><a href="#cb6-180" aria-hidden="true" tabindex="-1"></a><span class="co"># 사용 예시</span></span>
<span id="cb6-181"><a href="#cb6-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-182"><a href="#cb6-182" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. 부산시장개표진행상황읍면동별.xlsx 처리</span></span>
<span id="cb6-183"><a href="#cb6-183" aria-hidden="true" tabindex="-1"></a><span class="co"># busan_df = process_5th_governor_election6(</span></span>
<span id="cb6-184"><a href="#cb6-184" aria-hidden="true" tabindex="-1"></a><span class="co">#     '부산시장개표진행상황읍면동별.xlsx',</span></span>
<span id="cb6-185"><a href="#cb6-185" aria-hidden="true" tabindex="-1"></a><span class="co">#     header_rows=(3, 4),</span></span>
<span id="cb6-186"><a href="#cb6-186" aria-hidden="true" tabindex="-1"></a><span class="co">#     filter_column='읍면동명',</span></span>
<span id="cb6-187"><a href="#cb6-187" aria-hidden="true" tabindex="-1"></a><span class="co">#     filter_value='합계'</span></span>
<span id="cb6-188"><a href="#cb6-188" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span>
<span id="cb6-189"><a href="#cb6-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-190"><a href="#cb6-190" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. 구시군명 추출 없이 처리</span></span>
<span id="cb6-191"><a href="#cb6-191" aria-hidden="true" tabindex="-1"></a><span class="co"># df_no_district = process_5th_governor_election6(</span></span>
<span id="cb6-192"><a href="#cb6-192" aria-hidden="true" tabindex="-1"></a><span class="co">#     '부산시장개표진행상황읍면동별.xlsx',</span></span>
<span id="cb6-193"><a href="#cb6-193" aria-hidden="true" tabindex="-1"></a><span class="co">#     header_rows=(3, 4),</span></span>
<span id="cb6-194"><a href="#cb6-194" aria-hidden="true" tabindex="-1"></a><span class="co">#     filter_column='읍면동명',</span></span>
<span id="cb6-195"><a href="#cb6-195" aria-hidden="true" tabindex="-1"></a><span class="co">#     filter_value='합계',</span></span>
<span id="cb6-196"><a href="#cb6-196" aria-hidden="true" tabindex="-1"></a><span class="co">#     extract_district=False</span></span>
<span id="cb6-197"><a href="#cb6-197" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span>
<span id="cb6-198"><a href="#cb6-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-199"><a href="#cb6-199" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. GitHub URL 사용</span></span>
<span id="cb6-200"><a href="#cb6-200" aria-hidden="true" tabindex="-1"></a><span class="co"># github_url = "https://github.com/.../부산시장개표진행상황읍면동별.xlsx"</span></span>
<span id="cb6-201"><a href="#cb6-201" aria-hidden="true" tabindex="-1"></a><span class="co"># df = process_5th_governor_election6(github_url)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="seoul-3" class="level2">
<h2 class="anchored" data-anchor-id="seoul-3">Seoul (3)</h2>
<div id="cell-16" class="cell" data-outputid="593f45e4-ea1d-4c7c-b82a-1f675bcc7d91" data-execution_count="7">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 깃허브 blob URL로 불러오는 경우 (자동으로 raw URL로 변환됨)</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>blob_url6_seoul <span class="op">=</span> <span class="st">'https://github.com/sw1kwon/korean-elections/blob/main/original/Local_Elections_Governor/6th_2014/</span><span class="sc">%E</span><span class="st">C</span><span class="sc">%84%</span><span class="st">9C</span><span class="sc">%E</span><span class="st">C%9A%B8</span><span class="sc">%E</span><span class="st">D%8A%B9</span><span class="sc">%E</span><span class="st">B%B3</span><span class="sc">%84%</span><span class="st">EC%8B%9C.xls'</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>seoul_6th <span class="op">=</span> process_6th_governor_election3(</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    file_path_or_url <span class="op">=</span> blob_url6_seoul,</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    header_rows <span class="op">=</span> (<span class="dv">3</span>, <span class="dv">4</span>),</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    filter_column <span class="op">=</span> <span class="st">'읍면동명'</span>,</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    filter_value <span class="op">=</span> <span class="st">'합계'</span>,</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>    add_sheet_name_column<span class="op">=</span><span class="va">True</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>발견된 시트: 25개
시트 이름: ['01종로구', '02중구', '03용산구', '04성동구', '05광진구', '06동대문구', '07중랑구', '08성북구', '09강북구', '10도봉구', '11노원구', '12은평구', '13서대문구', '14마포구', '15양천구', '16강서구', '17구로구', '18금천구', '19영등포구', '20동작구', '21관악구', '22서초구', '23강남구', '24송파구', '25강동구']


==================================================
시트 1/25: '01종로구' 처리 중...
==================================================
데이터 행 수: 55
필터링 적용: '읍면동명' == '합계' → 1행
'01종로구' 시트 처리 완료: 1행 추가됨

==================================================
시트 2/25: '02중구' 처리 중...
==================================================
데이터 행 수: 49
필터링 적용: '읍면동명' == '합계' → 1행
'02중구' 시트 처리 완료: 1행 추가됨

==================================================
시트 3/25: '03용산구' 처리 중...
==================================================
데이터 행 수: 52
필터링 적용: '읍면동명' == '합계' → 1행
'03용산구' 시트 처리 완료: 1행 추가됨

==================================================
시트 4/25: '04성동구' 처리 중...
==================================================
데이터 행 수: 55
필터링 적용: '읍면동명' == '합계' → 1행
'04성동구' 시트 처리 완료: 1행 추가됨

==================================================
시트 5/25: '05광진구' 처리 중...
==================================================
데이터 행 수: 49
필터링 적용: '읍면동명' == '합계' → 1행
'05광진구' 시트 처리 완료: 1행 추가됨

==================================================
시트 6/25: '06동대문구' 처리 중...
==================================================
데이터 행 수: 46
필터링 적용: '읍면동명' == '합계' → 1행
'06동대문구' 시트 처리 완료: 1행 추가됨

==================================================
시트 7/25: '07중랑구' 처리 중...
==================================================
데이터 행 수: 52
필터링 적용: '읍면동명' == '합계' → 1행
'07중랑구' 시트 처리 완료: 1행 추가됨

==================================================
시트 8/25: '08성북구' 처리 중...
==================================================
데이터 행 수: 64
필터링 적용: '읍면동명' == '합계' → 1행
'08성북구' 시트 처리 완료: 1행 추가됨

==================================================
시트 9/25: '09강북구' 처리 중...
==================================================
데이터 행 수: 43
필터링 적용: '읍면동명' == '합계' → 1행
'09강북구' 시트 처리 완료: 1행 추가됨

==================================================
시트 10/25: '10도봉구' 처리 중...
==================================================
데이터 행 수: 46
필터링 적용: '읍면동명' == '합계' → 1행
'10도봉구' 시트 처리 완료: 1행 추가됨

==================================================
시트 11/25: '11노원구' 처리 중...
==================================================
데이터 행 수: 61
필터링 적용: '읍면동명' == '합계' → 1행
'11노원구' 시트 처리 완료: 1행 추가됨

==================================================
시트 12/25: '12은평구' 처리 중...
==================================================
데이터 행 수: 52
필터링 적용: '읍면동명' == '합계' → 1행
'12은평구' 시트 처리 완료: 1행 추가됨

==================================================
시트 13/25: '13서대문구' 처리 중...
==================================================
데이터 행 수: 46
필터링 적용: '읍면동명' == '합계' → 1행
'13서대문구' 시트 처리 완료: 1행 추가됨

==================================================
시트 14/25: '14마포구' 처리 중...
==================================================
데이터 행 수: 52
필터링 적용: '읍면동명' == '합계' → 1행
'14마포구' 시트 처리 완료: 1행 추가됨

==================================================
시트 15/25: '15양천구' 처리 중...
==================================================
데이터 행 수: 58
필터링 적용: '읍면동명' == '합계' → 1행
'15양천구' 시트 처리 완료: 1행 추가됨

==================================================
시트 16/25: '16강서구' 처리 중...
==================================================
데이터 행 수: 64
필터링 적용: '읍면동명' == '합계' → 1행
'16강서구' 시트 처리 완료: 1행 추가됨

==================================================
시트 17/25: '17구로구' 처리 중...
==================================================
데이터 행 수: 49
필터링 적용: '읍면동명' == '합계' → 1행
'17구로구' 시트 처리 완료: 1행 추가됨

==================================================
시트 18/25: '18금천구' 처리 중...
==================================================
데이터 행 수: 34
필터링 적용: '읍면동명' == '합계' → 1행
'18금천구' 시트 처리 완료: 1행 추가됨

==================================================
시트 19/25: '19영등포구' 처리 중...
==================================================
데이터 행 수: 58
필터링 적용: '읍면동명' == '합계' → 1행
'19영등포구' 시트 처리 완료: 1행 추가됨

==================================================
시트 20/25: '20동작구' 처리 중...
==================================================
데이터 행 수: 49
필터링 적용: '읍면동명' == '합계' → 1행
'20동작구' 시트 처리 완료: 1행 추가됨

==================================================
시트 21/25: '21관악구' 처리 중...
==================================================
데이터 행 수: 67
필터링 적용: '읍면동명' == '합계' → 1행
'21관악구' 시트 처리 완료: 1행 추가됨

==================================================
시트 22/25: '22서초구' 처리 중...
==================================================
데이터 행 수: 58
필터링 적용: '읍면동명' == '합계' → 1행
'22서초구' 시트 처리 완료: 1행 추가됨

==================================================
시트 23/25: '23강남구' 처리 중...
==================================================
데이터 행 수: 70
필터링 적용: '읍면동명' == '합계' → 1행
'23강남구' 시트 처리 완료: 1행 추가됨

==================================================
시트 24/25: '24송파구' 처리 중...
==================================================
데이터 행 수: 82
필터링 적용: '읍면동명' == '합계' → 1행
'24송파구' 시트 처리 완료: 1행 추가됨

==================================================
시트 25/25: '25강동구' 처리 중...
==================================================
데이터 행 수: 58
필터링 적용: '읍면동명' == '합계' → 1행
'25강동구' 시트 처리 완료: 1행 추가됨

==================================================
최종 결과: 총 25행의 데이터
==================================================</code></pre>
</div>
</div>
<div id="cell-17" class="cell" data-outputid="8a8c59e4-bc96-46c7-dda1-273c39523bc3" data-execution_count="8">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>seoul_6th</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">

  <div id="df-30d865cd-a095-4a98-a498-ccd068fae652" class="colab-df-container">
    <div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">시트명</th>
<th data-quarto-table-cell-role="th">읍면동명</th>
<th data-quarto-table-cell-role="th">구분</th>
<th data-quarto-table-cell-role="th">선거인수</th>
<th data-quarto-table-cell-role="th">투표수</th>
<th data-quarto-table-cell-role="th">후보자별 득표수_새누리당\n정몽준</th>
<th data-quarto-table-cell-role="th">새정치민주연합\n박원순</th>
<th data-quarto-table-cell-role="th">통합진보당\n정태흥</th>
<th data-quarto-table-cell-role="th">새정치당\n홍정식</th>
<th data-quarto-table-cell-role="th">계</th>
<th data-quarto-table-cell-role="th">무효\n투표수</th>
<th data-quarto-table-cell-role="th">기권수</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>01종로구</td>
<td>합계</td>
<td>NaN</td>
<td>136,925</td>
<td>81,113</td>
<td>34,599</td>
<td>45,020</td>
<td>330</td>
<td>238</td>
<td>80,187</td>
<td>926</td>
<td>55,812</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>02중구</td>
<td>합계</td>
<td>NaN</td>
<td>113,235</td>
<td>65,393</td>
<td>28,273</td>
<td>35,662</td>
<td>291</td>
<td>262</td>
<td>64,488</td>
<td>905</td>
<td>47,842</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>03용산구</td>
<td>합계</td>
<td>NaN</td>
<td>204,529</td>
<td>118,198</td>
<td>58,479</td>
<td>57,807</td>
<td>462</td>
<td>365</td>
<td>117,113</td>
<td>1,085</td>
<td>86,331</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>04성동구</td>
<td>합계</td>
<td>NaN</td>
<td>252,308</td>
<td>146,873</td>
<td>62,376</td>
<td>81,645</td>
<td>715</td>
<td>546</td>
<td>145,282</td>
<td>1,591</td>
<td>105,435</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>05광진구</td>
<td>합계</td>
<td>NaN</td>
<td>309,269</td>
<td>177,484</td>
<td>72,160</td>
<td>102,449</td>
<td>832</td>
<td>592</td>
<td>176,033</td>
<td>1,451</td>
<td>131,785</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>06동대문구</td>
<td>합계</td>
<td>NaN</td>
<td>308,318</td>
<td>179,384</td>
<td>76,325</td>
<td>99,568</td>
<td>910</td>
<td>684</td>
<td>177,487</td>
<td>1,897</td>
<td>128,934</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>07중랑구</td>
<td>합계</td>
<td>NaN</td>
<td>351,965</td>
<td>189,523</td>
<td>80,700</td>
<td>104,905</td>
<td>1,050</td>
<td>786</td>
<td>187,441</td>
<td>2,082</td>
<td>162,442</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>08성북구</td>
<td>합계</td>
<td>NaN</td>
<td>394,293</td>
<td>229,201</td>
<td>92,897</td>
<td>131,919</td>
<td>1,187</td>
<td>844</td>
<td>226,847</td>
<td>2,354</td>
<td>165,092</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>09강북구</td>
<td>합계</td>
<td>NaN</td>
<td>284,048</td>
<td>155,350</td>
<td>64,944</td>
<td>87,128</td>
<td>927</td>
<td>693</td>
<td>153,692</td>
<td>1,658</td>
<td>128,698</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>10도봉구</td>
<td>합계</td>
<td>NaN</td>
<td>296,035</td>
<td>173,232</td>
<td>75,252</td>
<td>94,590</td>
<td>978</td>
<td>726</td>
<td>171,546</td>
<td>1,686</td>
<td>122,803</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>11노원구</td>
<td>합계</td>
<td>NaN</td>
<td>471,804</td>
<td>284,532</td>
<td>115,716</td>
<td>163,418</td>
<td>1,598</td>
<td>1,076</td>
<td>281,808</td>
<td>2,724</td>
<td>187,272</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>12은평구</td>
<td>합계</td>
<td>NaN</td>
<td>414,920</td>
<td>233,896</td>
<td>93,022</td>
<td>136,656</td>
<td>1,252</td>
<td>789</td>
<td>231,719</td>
<td>2,177</td>
<td>181,024</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>13서대문구</td>
<td>합계</td>
<td>NaN</td>
<td>266,442</td>
<td>159,840</td>
<td>64,341</td>
<td>92,500</td>
<td>754</td>
<td>609</td>
<td>158,204</td>
<td>1,636</td>
<td>106,602</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13</td>
<td>14마포구</td>
<td>합계</td>
<td>NaN</td>
<td>320,827</td>
<td>195,289</td>
<td>74,548</td>
<td>117,343</td>
<td>935</td>
<td>695</td>
<td>193,521</td>
<td>1,768</td>
<td>125,538</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14</td>
<td>15양천구</td>
<td>합계</td>
<td>NaN</td>
<td>392,385</td>
<td>236,667</td>
<td>97,435</td>
<td>135,186</td>
<td>1,126</td>
<td>808</td>
<td>234,555</td>
<td>2,112</td>
<td>155,718</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">15</td>
<td>16강서구</td>
<td>합계</td>
<td>NaN</td>
<td>470,411</td>
<td>273,853</td>
<td>111,451</td>
<td>157,382</td>
<td>1,390</td>
<td>1,097</td>
<td>271,320</td>
<td>2,533</td>
<td>196,558</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16</td>
<td>17구로구</td>
<td>합계</td>
<td>NaN</td>
<td>355,410</td>
<td>212,735</td>
<td>85,806</td>
<td>123,139</td>
<td>1,025</td>
<td>819</td>
<td>210,789</td>
<td>1,946</td>
<td>142,675</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17</td>
<td>18금천구</td>
<td>합계</td>
<td>NaN</td>
<td>204,435</td>
<td>113,723</td>
<td>45,315</td>
<td>66,005</td>
<td>669</td>
<td>478</td>
<td>112,467</td>
<td>1,256</td>
<td>90,712</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">18</td>
<td>19영등포구</td>
<td>합계</td>
<td>NaN</td>
<td>329,266</td>
<td>194,093</td>
<td>82,509</td>
<td>108,244</td>
<td>905</td>
<td>714</td>
<td>192,372</td>
<td>1,721</td>
<td>135,173</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">19</td>
<td>20동작구</td>
<td>합계</td>
<td>NaN</td>
<td>347,506</td>
<td>214,255</td>
<td>87,813</td>
<td>122,927</td>
<td>854</td>
<td>720</td>
<td>212,314</td>
<td>1,941</td>
<td>133,251</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">20</td>
<td>21관악구</td>
<td>합계</td>
<td>NaN</td>
<td>447,728</td>
<td>259,673</td>
<td>91,832</td>
<td>163,100</td>
<td>1,527</td>
<td>947</td>
<td>257,406</td>
<td>2,267</td>
<td>188,055</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">21</td>
<td>22서초구</td>
<td>합계</td>
<td>NaN</td>
<td>358,576</td>
<td>220,442</td>
<td>114,462</td>
<td>103,328</td>
<td>689</td>
<td>552</td>
<td>219,031</td>
<td>1,411</td>
<td>138,134</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">22</td>
<td>23강남구</td>
<td>합계</td>
<td>NaN</td>
<td>467,534</td>
<td>270,052</td>
<td>145,512</td>
<td>120,645</td>
<td>877</td>
<td>809</td>
<td>267,843</td>
<td>2,209</td>
<td>197,482</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">23</td>
<td>24송파구</td>
<td>합계</td>
<td>NaN</td>
<td>547,101</td>
<td>329,721</td>
<td>150,228</td>
<td>174,892</td>
<td>1,323</td>
<td>987</td>
<td>327,430</td>
<td>2,291</td>
<td>217,380</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">24</td>
<td>25강동구</td>
<td>합계</td>
<td>NaN</td>
<td>396,324</td>
<td>234,375</td>
<td>103,874</td>
<td>126,713</td>
<td>1,032</td>
<td>767</td>
<td>232,386</td>
<td>1,989</td>
<td>161,949</td>
</tr>
</tbody>
</table>

</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-30d865cd-a095-4a98-a498-ccd068fae652')" title="Convert this dataframe to an interactive table." style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"></path>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-30d865cd-a095-4a98-a498-ccd068fae652 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-30d865cd-a095-4a98-a498-ccd068fae652');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-761c1758-dcec-4fc9-9326-c10194c4b023">
      <button class="colab-df-quickchart" onclick="quickchart('df-761c1758-dcec-4fc9-9326-c10194c4b023')" title="Suggest charts" style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"></path>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-761c1758-dcec-4fc9-9326-c10194c4b023 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

  <div id="id_9a649cc4-fd1d-44c2-b048-b00d7c0202d7">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('seoul_6th')" title="Generate code using this dataframe." style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"></path>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_9a649cc4-fd1d-44c2-b048-b00d7c0202d7 button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('seoul_6th');
      }
      })();
    </script>
  </div>

    </div>
  </div>
</div>
</div>
</section>
<section id="busan-6" class="level2">
<h2 class="anchored" data-anchor-id="busan-6">Busan (6)</h2>
<div id="cell-19" class="cell" data-outputid="2c6facbe-2645-42fb-8673-a2517fce59dd" data-execution_count="9">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 깃허브 blob URL로 불러오는 경우 (자동으로 raw URL로 변환됨)</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>blob_url6_busan <span class="op">=</span> <span class="st">'https://github.com/sw1kwon/korean-elections/blob/main/original/Local_Elections_Governor/6th_2014/</span><span class="sc">%E</span><span class="st">B%B6</span><span class="sc">%80%</span><span class="st">EC</span><span class="sc">%82%</span><span class="st">B0-</span><span class="sc">%E</span><span class="st">C%8B%9C</span><span class="sc">%E</span><span class="st">C</span><span class="sc">%9E</span><span class="st">%A5-</span><span class="sc">%E</span><span class="st">A%B0%9C</span><span class="sc">%E</span><span class="st">D</span><span class="sc">%91%</span><span class="st">9C</span><span class="sc">%E</span><span class="st">C%A7</span><span class="sc">%84%</span><span class="st">ED</span><span class="sc">%96%</span><span class="st">89</span><span class="sc">%E</span><span class="st">C</span><span class="sc">%83%</span><span class="st">81</span><span class="sc">%E</span><span class="st">D</span><span class="sc">%99%</span><span class="st">A9(</span><span class="sc">%E</span><span class="st">C%9D%8D</span><span class="sc">%E</span><span class="st">B%A9%B4</span><span class="sc">%E</span><span class="st">B</span><span class="sc">%8F%99%</span><span class="st">EB%B3%84).xlsx'</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>busan_6th <span class="op">=</span> process_5th_governor_election6(</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    file_path_or_url <span class="op">=</span> blob_url6_busan,</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    header_rows <span class="op">=</span> (<span class="dv">3</span>, <span class="dv">4</span>),  <span class="co"># 엑셀 기준 행 번호 (3행부터 4행까지)</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    filter_column <span class="op">=</span> <span class="st">'읍면동명'</span>,</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    filter_value <span class="op">=</span> <span class="st">'합계'</span>,</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    extract_district <span class="op">=</span> <span class="va">True</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>헤더 행: 3행 ~ 4행
생성된 컬럼 수: 9
데이터 행 수: 754

'읍면동명' 컬럼 발견: 읍면동명

구시군명 열 추가 완료

필터링 전: 754행 → 필터링 후: 16행
'읍면동명' == '합계'인 행만 추출

결과 데이터 샘플:
     구시군명 읍면동명   구분     선거인수      투표수 후보자별 득표수_새누리당\n서병수 무소속\n오거돈        계  \
0      중구   합계  NaN   41,868   23,404             12,576   10,057   22,633   
35     서구   합계  NaN  102,694   55,778             29,893   24,088   53,981   
82     동구   합계  NaN   83,350   47,730             25,288   20,693   45,981   
132   영도구   합계  NaN  115,944   60,321             30,436   27,462   57,898   
173  부산진구   합계  NaN  329,022  180,227             88,196   85,731  173,927   

    무효\n투표수      기권수  
0       771   18,464  
35    1,797   46,916  
82    1,749   35,620  
132   2,423   55,623  
173   6,300  148,795  </code></pre>
</div>
</div>
<div id="cell-20" class="cell" data-outputid="0913d0b6-7943-49ea-84d1-a2538372443e" data-execution_count="10">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>busan_6th</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">

  <div id="df-9ec42bf6-c2d0-4691-a20a-ffe784bdbbd2" class="colab-df-container">
    <div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">구시군명</th>
<th data-quarto-table-cell-role="th">읍면동명</th>
<th data-quarto-table-cell-role="th">구분</th>
<th data-quarto-table-cell-role="th">선거인수</th>
<th data-quarto-table-cell-role="th">투표수</th>
<th data-quarto-table-cell-role="th">후보자별 득표수_새누리당\n서병수</th>
<th data-quarto-table-cell-role="th">무소속\n오거돈</th>
<th data-quarto-table-cell-role="th">계</th>
<th data-quarto-table-cell-role="th">무효\n투표수</th>
<th data-quarto-table-cell-role="th">기권수</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>중구</td>
<td>합계</td>
<td>NaN</td>
<td>41,868</td>
<td>23,404</td>
<td>12,576</td>
<td>10,057</td>
<td>22,633</td>
<td>771</td>
<td>18,464</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">35</td>
<td>서구</td>
<td>합계</td>
<td>NaN</td>
<td>102,694</td>
<td>55,778</td>
<td>29,893</td>
<td>24,088</td>
<td>53,981</td>
<td>1,797</td>
<td>46,916</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">82</td>
<td>동구</td>
<td>합계</td>
<td>NaN</td>
<td>83,350</td>
<td>47,730</td>
<td>25,288</td>
<td>20,693</td>
<td>45,981</td>
<td>1,749</td>
<td>35,620</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">132</td>
<td>영도구</td>
<td>합계</td>
<td>NaN</td>
<td>115,944</td>
<td>60,321</td>
<td>30,436</td>
<td>27,462</td>
<td>57,898</td>
<td>2,423</td>
<td>55,623</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">173</td>
<td>부산진구</td>
<td>합계</td>
<td>NaN</td>
<td>329,022</td>
<td>180,227</td>
<td>88,196</td>
<td>85,731</td>
<td>173,927</td>
<td>6,300</td>
<td>148,795</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">250</td>
<td>동래구</td>
<td>합계</td>
<td>NaN</td>
<td>229,691</td>
<td>130,592</td>
<td>64,409</td>
<td>62,544</td>
<td>126,953</td>
<td>3,639</td>
<td>99,099</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">297</td>
<td>남구</td>
<td>합계</td>
<td>NaN</td>
<td>241,177</td>
<td>137,349</td>
<td>66,903</td>
<td>66,081</td>
<td>132,984</td>
<td>4,365</td>
<td>103,828</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">356</td>
<td>북구</td>
<td>합계</td>
<td>NaN</td>
<td>251,760</td>
<td>139,860</td>
<td>65,060</td>
<td>69,774</td>
<td>134,834</td>
<td>5,026</td>
<td>111,900</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">403</td>
<td>해운대구</td>
<td>합계</td>
<td>NaN</td>
<td>342,080</td>
<td>188,267</td>
<td>91,704</td>
<td>91,013</td>
<td>182,717</td>
<td>5,550</td>
<td>153,813</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">465</td>
<td>기장군</td>
<td>합계</td>
<td>NaN</td>
<td>107,360</td>
<td>62,794</td>
<td>29,611</td>
<td>30,625</td>
<td>60,236</td>
<td>2,558</td>
<td>44,566</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">488</td>
<td>사하구</td>
<td>합계</td>
<td>NaN</td>
<td>285,319</td>
<td>152,223</td>
<td>74,278</td>
<td>72,657</td>
<td>146,935</td>
<td>5,288</td>
<td>133,096</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">544</td>
<td>금정구</td>
<td>합계</td>
<td>NaN</td>
<td>212,138</td>
<td>120,177</td>
<td>59,797</td>
<td>56,557</td>
<td>116,354</td>
<td>3,823</td>
<td>91,961</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">603</td>
<td>강서구</td>
<td>합계</td>
<td>NaN</td>
<td>59,758</td>
<td>35,024</td>
<td>16,332</td>
<td>17,199</td>
<td>33,531</td>
<td>1,493</td>
<td>24,734</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">632</td>
<td>연제구</td>
<td>합계</td>
<td>NaN</td>
<td>174,407</td>
<td>99,853</td>
<td>48,384</td>
<td>48,616</td>
<td>97,000</td>
<td>2,853</td>
<td>74,554</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">676</td>
<td>수영구</td>
<td>합계</td>
<td>NaN</td>
<td>149,975</td>
<td>82,961</td>
<td>41,788</td>
<td>39,210</td>
<td>80,998</td>
<td>1,963</td>
<td>67,014</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">714</td>
<td>사상구</td>
<td>합계</td>
<td>NaN</td>
<td>205,636</td>
<td>112,607</td>
<td>53,271</td>
<td>54,918</td>
<td>108,189</td>
<td>4,418</td>
<td>93,029</td>
</tr>
</tbody>
</table>

</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-9ec42bf6-c2d0-4691-a20a-ffe784bdbbd2')" title="Convert this dataframe to an interactive table." style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"></path>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-9ec42bf6-c2d0-4691-a20a-ffe784bdbbd2 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-9ec42bf6-c2d0-4691-a20a-ffe784bdbbd2');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-ba065004-08a6-48ff-999a-75a418dbc465">
      <button class="colab-df-quickchart" onclick="quickchart('df-ba065004-08a6-48ff-999a-75a418dbc465')" title="Suggest charts" style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"></path>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-ba065004-08a6-48ff-999a-75a418dbc465 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

  <div id="id_0b8703bb-ea6f-49a8-bf69-3d4934e8a5c0">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('busan_6th')" title="Generate code using this dataframe." style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"></path>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_0b8703bb-ea6f-49a8-bf69-3d4934e8a5c0 button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('busan_6th');
      }
      })();
    </script>
  </div>

    </div>
  </div>
</div>
</div>
</section>
<section id="daegu-4" class="level2">
<h2 class="anchored" data-anchor-id="daegu-4">Daegu (4)</h2>
<div id="cell-22" class="cell" data-outputid="7b5eb909-254f-4d7c-f1ee-86ccbeda46f7" data-execution_count="11">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 깃허브 blob URL로 불러오는 경우 (자동으로 raw URL로 변환됨)</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>blob_url6_daegu <span class="op">=</span> <span class="st">'https://github.com/sw1kwon/korean-elections/blob/main/original/Local_Elections_Governor/6th_2014/</span><span class="sc">%E</span><span class="st">B%8C</span><span class="sc">%80%</span><span class="st">EA%B5%AC</span><span class="sc">%E</span><span class="st">A%B4</span><span class="sc">%91%</span><span class="st">EC</span><span class="sc">%97%</span><span class="st">AD</span><span class="sc">%E</span><span class="st">C%8B%9C.xls'</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>daegu_6th <span class="op">=</span> process_6th_governor_election4(</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    file_path_or_url <span class="op">=</span> blob_url6_daegu,</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    header_rows <span class="op">=</span> (<span class="dv">3</span>, <span class="dv">4</span>),</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    filter_column <span class="op">=</span> <span class="va">None</span>,</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    filter_value <span class="op">=</span> <span class="va">None</span>,</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>    row_range<span class="op">=</span>(<span class="dv">1</span>,<span class="dv">13</span>)  <span class="co"># 읽을 행 범위 (엑셀 기준)</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>파일에서 1행부터 13행까지만 읽습니다.
헤더 행: 3행 ~ 4행
생성된 컬럼 수: 12
데이터 행 수: 9

생성된 컬럼명 (처음 10개):
0: 대구광역시
1: 구분
2: 선거인수
3: 투표수
4: 후보자별 득표수_새누리당
권영진
5: 새정치민주연합
김부겸
6: 통합진보당
송영우
7: 정의당
이원준
8: 무소속
이정숙
9: 계</code></pre>
</div>
</div>
<div id="cell-23" class="cell" data-outputid="9a60519e-877b-4f1a-bab9-b91ac2e8860b" data-execution_count="12">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>daegu_6th</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">

  <div id="df-e6ac7fec-043b-448e-bb06-c835f327974f" class="colab-df-container">
    <div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">대구광역시</th>
<th data-quarto-table-cell-role="th">구분</th>
<th data-quarto-table-cell-role="th">선거인수</th>
<th data-quarto-table-cell-role="th">투표수</th>
<th data-quarto-table-cell-role="th">후보자별 득표수_새누리당\n권영진</th>
<th data-quarto-table-cell-role="th">새정치민주연합\n김부겸</th>
<th data-quarto-table-cell-role="th">통합진보당\n송영우</th>
<th data-quarto-table-cell-role="th">정의당\n이원준</th>
<th data-quarto-table-cell-role="th">무소속\n이정숙</th>
<th data-quarto-table-cell-role="th">계</th>
<th data-quarto-table-cell-role="th">무효\n투표수</th>
<th data-quarto-table-cell-role="th">기권수</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>합계</td>
<td>NaN</td>
<td>2,012,579</td>
<td>1,052,638</td>
<td>581,175\n(55.95)</td>
<td>418,891\n(40.33)</td>
<td>10,857\n(1.04)</td>
<td>12,922\n(1.24)</td>
<td>14,774\n(1.42)</td>
<td>1,038,619</td>
<td>14,019</td>
<td>959,941</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>중구</td>
<td>NaN</td>
<td>65,996</td>
<td>35,719</td>
<td>20,419\n(58.18)</td>
<td>13,410\n(38.21)</td>
<td>313\n(0.89)</td>
<td>464\n(1.32)</td>
<td>485\n(1.38)</td>
<td>35,091</td>
<td>628</td>
<td>30,277</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>동구</td>
<td>NaN</td>
<td>286,747</td>
<td>151,471</td>
<td>86,217\n(57.80)</td>
<td>56,920\n(38.16)</td>
<td>2,065\n(1.38)</td>
<td>1,724\n(1.15)</td>
<td>2,214\n(1.48)</td>
<td>149,140</td>
<td>2,331</td>
<td>135,276</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>서구</td>
<td>NaN</td>
<td>183,116</td>
<td>91,230</td>
<td>56,272\n(62.85)</td>
<td>29,458\n(32.90)</td>
<td>981\n(1.09)</td>
<td>1,209\n(1.35)</td>
<td>1,609\n(1.79)</td>
<td>89,529</td>
<td>1,701</td>
<td>91,886</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>남구</td>
<td>NaN</td>
<td>142,345</td>
<td>70,076</td>
<td>42,488\n(61.55)</td>
<td>24,071\n(34.87)</td>
<td>631\n(0.91)</td>
<td>817\n(1.18)</td>
<td>1,015\n(1.47)</td>
<td>69,022</td>
<td>1,054</td>
<td>72,269</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>북구</td>
<td>NaN</td>
<td>348,883</td>
<td>179,341</td>
<td>99,100\n(55.97)</td>
<td>70,646\n(39.90)</td>
<td>2,189\n(1.23)</td>
<td>2,359\n(1.33)</td>
<td>2,758\n(1.55)</td>
<td>177,052</td>
<td>2,289</td>
<td>169,542</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>수성구</td>
<td>NaN</td>
<td>359,016</td>
<td>201,364</td>
<td>99,577\n(49.93)</td>
<td>94,715\n(47.49)</td>
<td>1,304\n(0.65)</td>
<td>1,886\n(0.94)</td>
<td>1,950\n(0.97)</td>
<td>199,432</td>
<td>1,932</td>
<td>157,652</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>달서구</td>
<td>NaN</td>
<td>481,475</td>
<td>249,724</td>
<td>134,637\n(54.54)</td>
<td>103,302\n(41.84)</td>
<td>2,324\n(0.94)</td>
<td>3,354\n(1.35)</td>
<td>3,230\n(1.30)</td>
<td>246,847</td>
<td>2,877</td>
<td>231,751</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>달성군</td>
<td>NaN</td>
<td>145,001</td>
<td>73,713</td>
<td>42,465\n(58.56)</td>
<td>26,369\n(36.36)</td>
<td>1,050\n(1.44)</td>
<td>1,109\n(1.52)</td>
<td>1,513\n(2.08)</td>
<td>72,506</td>
<td>1,207</td>
<td>71,288</td>
</tr>
</tbody>
</table>

</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-e6ac7fec-043b-448e-bb06-c835f327974f')" title="Convert this dataframe to an interactive table." style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"></path>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-e6ac7fec-043b-448e-bb06-c835f327974f button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-e6ac7fec-043b-448e-bb06-c835f327974f');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-ba11f8eb-4474-49a4-9541-40eb3d1a6bfe">
      <button class="colab-df-quickchart" onclick="quickchart('df-ba11f8eb-4474-49a4-9541-40eb3d1a6bfe')" title="Suggest charts" style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"></path>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-ba11f8eb-4474-49a4-9541-40eb3d1a6bfe button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

  <div id="id_33ffb479-d990-4906-93e0-633cdac9ba27">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('daegu_6th')" title="Generate code using this dataframe." style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"></path>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_33ffb479-d990-4906-93e0-633cdac9ba27 button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('daegu_6th');
      }
      })();
    </script>
  </div>

    </div>
  </div>
</div>
</div>
</section>
<section id="incheon-1" class="level2">
<h2 class="anchored" data-anchor-id="incheon-1">Incheon (1)</h2>
<div id="cell-25" class="cell" data-outputid="96f9d413-954c-4802-ee3f-d7770758dc2d" data-execution_count="13">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 깃허브 blob URL로 불러오는 경우 (자동으로 raw URL로 변환됨)</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>blob_url6_incheon <span class="op">=</span> <span class="st">'https://github.com/sw1kwon/korean-elections/blob/main/original/Local_Elections_Governor/6th_2014/</span><span class="sc">%E</span><span class="st">C%9D%B8</span><span class="sc">%E</span><span class="st">C%B2%9C</span><span class="sc">%E</span><span class="st">A%B4</span><span class="sc">%91%</span><span class="st">EC</span><span class="sc">%97%</span><span class="st">AD</span><span class="sc">%E</span><span class="st">C%8B%9C.xls'</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>incheon_6th <span class="op">=</span> process_6th_governor_election1(</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    file_path_or_url <span class="op">=</span> blob_url6_incheon,</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    header_rows <span class="op">=</span> (<span class="dv">3</span>, <span class="dv">4</span>),</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>    filter_column <span class="op">=</span> <span class="st">'읍면동명'</span>,</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>    filter_value <span class="op">=</span> <span class="st">'합계'</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>헤더 행: 3행 ~ 4행
생성된 컬럼 수: 11
데이터 행 수: 482

생성된 컬럼명 (처음 10개):
0: 구시군명
1: 읍면동명
2: 구분
3: 선거인수
4: 투표수
5: 후보자별 득표수_새누리당
유정복
6: 새정치민주연합
송영길
7: 통합진보당
신창현
8: 계
9: 무효
투표수

'읍면동명' 컬럼 발견: 읍면동명
필터링 전: 482행 → 필터링 후: 11행
'읍면동명' == '합계'인 행만 추출</code></pre>
</div>
</div>
<div id="cell-26" class="cell" data-outputid="f3b3d47d-882d-40b6-9d17-aa406b62896b" data-execution_count="14">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>incheon_6th</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">

  <div id="df-ee7e78e6-9e1a-4908-bd03-fc09a2e0d278" class="colab-df-container">
    <div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">구시군명</th>
<th data-quarto-table-cell-role="th">읍면동명</th>
<th data-quarto-table-cell-role="th">구분</th>
<th data-quarto-table-cell-role="th">선거인수</th>
<th data-quarto-table-cell-role="th">투표수</th>
<th data-quarto-table-cell-role="th">후보자별 득표수_새누리당\n유정복</th>
<th data-quarto-table-cell-role="th">새정치민주연합\n송영길</th>
<th data-quarto-table-cell-role="th">통합진보당\n신창현</th>
<th data-quarto-table-cell-role="th">계</th>
<th data-quarto-table-cell-role="th">무효\n투표수</th>
<th data-quarto-table-cell-role="th">기권수</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>인천광역시</td>
<td>합계</td>
<td>NaN</td>
<td>2,319,198</td>
<td>1,244,502</td>
<td>615,077</td>
<td>593,555</td>
<td>22,651</td>
<td>1,231,283</td>
<td>13,219</td>
<td>1,074,696</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>중구</td>
<td>합계</td>
<td>NaN</td>
<td>89,767</td>
<td>48,565</td>
<td>26,324</td>
<td>20,788</td>
<td>845</td>
<td>47,957</td>
<td>608</td>
<td>41,202</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">38</td>
<td>동구</td>
<td>합계</td>
<td>NaN</td>
<td>61,693</td>
<td>36,534</td>
<td>19,573</td>
<td>15,605</td>
<td>711</td>
<td>35,889</td>
<td>645</td>
<td>25,159</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">75</td>
<td>남구</td>
<td>합계</td>
<td>NaN</td>
<td>340,427</td>
<td>174,258</td>
<td>92,490</td>
<td>76,984</td>
<td>2,854</td>
<td>172,328</td>
<td>1,930</td>
<td>166,169</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">142</td>
<td>연수구</td>
<td>합계</td>
<td>NaN</td>
<td>238,453</td>
<td>136,706</td>
<td>71,942</td>
<td>61,389</td>
<td>2,154</td>
<td>135,485</td>
<td>1,221</td>
<td>101,747</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">182</td>
<td>남동구</td>
<td>합계</td>
<td>NaN</td>
<td>405,404</td>
<td>215,359</td>
<td>102,688</td>
<td>106,433</td>
<td>4,308</td>
<td>213,429</td>
<td>1,930</td>
<td>190,045</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">243</td>
<td>부평구</td>
<td>합계</td>
<td>NaN</td>
<td>451,971</td>
<td>237,759</td>
<td>108,912</td>
<td>121,970</td>
<td>4,670</td>
<td>235,552</td>
<td>2,207</td>
<td>214,212</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">313</td>
<td>계양구</td>
<td>합계</td>
<td>NaN</td>
<td>274,659</td>
<td>143,387</td>
<td>61,275</td>
<td>78,343</td>
<td>2,562</td>
<td>142,180</td>
<td>1,207</td>
<td>131,272</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">350</td>
<td>서구</td>
<td>합계</td>
<td>NaN</td>
<td>380,611</td>
<td>199,733</td>
<td>98,389</td>
<td>96,162</td>
<td>3,413</td>
<td>197,964</td>
<td>1,769</td>
<td>180,878</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">414</td>
<td>강화군</td>
<td>합계</td>
<td>NaN</td>
<td>58,089</td>
<td>38,611</td>
<td>24,762</td>
<td>11,854</td>
<td>815</td>
<td>37,431</td>
<td>1,180</td>
<td>19,478</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">457</td>
<td>옹진군</td>
<td>합계</td>
<td>NaN</td>
<td>18,124</td>
<td>13,590</td>
<td>8,722</td>
<td>4,027</td>
<td>319</td>
<td>13,068</td>
<td>522</td>
<td>4,534</td>
</tr>
</tbody>
</table>

</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-ee7e78e6-9e1a-4908-bd03-fc09a2e0d278')" title="Convert this dataframe to an interactive table." style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"></path>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-ee7e78e6-9e1a-4908-bd03-fc09a2e0d278 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-ee7e78e6-9e1a-4908-bd03-fc09a2e0d278');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-6a2db261-a850-4945-8753-0d3267d31a0b">
      <button class="colab-df-quickchart" onclick="quickchart('df-6a2db261-a850-4945-8753-0d3267d31a0b')" title="Suggest charts" style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"></path>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-6a2db261-a850-4945-8753-0d3267d31a0b button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

  <div id="id_09e3eff4-0d8f-4e0f-a213-10fbe5c81188">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('incheon_6th')" title="Generate code using this dataframe." style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"></path>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_09e3eff4-0d8f-4e0f-a213-10fbe5c81188 button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('incheon_6th');
      }
      })();
    </script>
  </div>

    </div>
  </div>
</div>
</div>
</section>
<section id="gwangju-3" class="level2">
<h2 class="anchored" data-anchor-id="gwangju-3">Gwangju (3)</h2>
<div id="cell-28" class="cell" data-outputid="73c1dec6-89ec-4cab-9294-316d97fd180e" data-execution_count="15">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 깃허브 blob URL로 불러오는 경우 (자동으로 raw URL로 변환됨)</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>blob_url6_gwangju <span class="op">=</span> <span class="st">'https://github.com/sw1kwon/korean-elections/blob/main/original/Local_Elections_Governor/6th_2014/</span><span class="sc">%E</span><span class="st">A%B4</span><span class="sc">%91%</span><span class="st">EC%A3%BC</span><span class="sc">%E</span><span class="st">A%B4</span><span class="sc">%91%</span><span class="st">EC</span><span class="sc">%97%</span><span class="st">AD</span><span class="sc">%E</span><span class="st">C%8B%9C.xlsx'</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>gwangju_6th <span class="op">=</span> process_6th_governor_election3(</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    file_path_or_url <span class="op">=</span> blob_url6_gwangju,</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>    header_rows <span class="op">=</span> (<span class="dv">3</span>, <span class="dv">4</span>),</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>    filter_column <span class="op">=</span> <span class="st">'읍면동명'</span>,</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>    filter_value <span class="op">=</span> <span class="st">'합계'</span>,</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>    add_sheet_name_column<span class="op">=</span><span class="va">True</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>발견된 시트: 5개
시트 이름: ['동구', '서구', '남구', '북구', '광산구']


==================================================
시트 1/5: '동구' 처리 중...
==================================================
데이터 행 수: 43
필터링 적용: '읍면동명' == '합계' → 1행
'동구' 시트 처리 완료: 1행 추가됨

==================================================
시트 2/5: '서구' 처리 중...
==================================================
데이터 행 수: 58
필터링 적용: '읍면동명' == '합계' → 1행
'서구' 시트 처리 완료: 1행 추가됨

==================================================
시트 3/5: '남구' 처리 중...
==================================================
데이터 행 수: 52
필터링 적용: '읍면동명' == '합계' → 1행
'남구' 시트 처리 완료: 1행 추가됨

==================================================
시트 4/5: '북구' 처리 중...
==================================================
데이터 행 수: 87
필터링 적용: '읍면동명' == '합계' → 1행
'북구' 시트 처리 완료: 1행 추가됨

==================================================
시트 5/5: '광산구' 처리 중...
==================================================
데이터 행 수: 67
필터링 적용: '읍면동명' == '합계' → 1행
'광산구' 시트 처리 완료: 1행 추가됨

==================================================
최종 결과: 총 5행의 데이터
==================================================</code></pre>
</div>
</div>
<div id="cell-29" class="cell" data-outputid="e68cb8a2-0eb0-4c0e-b4bd-4176486a8249" data-execution_count="16">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>gwangju_6th</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">

  <div id="df-a3a3824a-887b-4e2b-8b36-d5859fff578c" class="colab-df-container">
    <div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">시트명</th>
<th data-quarto-table-cell-role="th">읍면동명</th>
<th data-quarto-table-cell-role="th">구분</th>
<th data-quarto-table-cell-role="th">선거인수</th>
<th data-quarto-table-cell-role="th">투표수</th>
<th data-quarto-table-cell-role="th">후보자별 득표수_새누리당\n이정재</th>
<th data-quarto-table-cell-role="th">새정치민주연합\n윤장현</th>
<th data-quarto-table-cell-role="th">통합진보당\n윤민호</th>
<th data-quarto-table-cell-role="th">노동당\n이병훈</th>
<th data-quarto-table-cell-role="th">무소속\n강운태</th>
<th data-quarto-table-cell-role="th">무소속\n이병완</th>
<th data-quarto-table-cell-role="th">계</th>
<th data-quarto-table-cell-role="th">무효\n투표수</th>
<th data-quarto-table-cell-role="th">기권수</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>동구</td>
<td>합계</td>
<td>NaN</td>
<td>86,465</td>
<td>51,253</td>
<td>1,889</td>
<td>28,605</td>
<td>1,238</td>
<td>591</td>
<td>16,551</td>
<td>1,091</td>
<td>49,965</td>
<td>1,288</td>
<td>35,212</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>서구</td>
<td>합계</td>
<td>NaN</td>
<td>242,201</td>
<td>142,219</td>
<td>4,481</td>
<td>82,754</td>
<td>3,700</td>
<td>1,225</td>
<td>43,444</td>
<td>3,932</td>
<td>139,536</td>
<td>2,683</td>
<td>99,982</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>남구</td>
<td>합계</td>
<td>NaN</td>
<td>171997</td>
<td>101811</td>
<td>3160</td>
<td>57010</td>
<td>2357</td>
<td>816</td>
<td>33798</td>
<td>2389</td>
<td>99530</td>
<td>2281</td>
<td>70186</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>북구</td>
<td>합계</td>
<td>NaN</td>
<td>351,880</td>
<td>198,547</td>
<td>6,840</td>
<td>113,138</td>
<td>6,912</td>
<td>2,201</td>
<td>59,878</td>
<td>4,995</td>
<td>193,964</td>
<td>4,583</td>
<td>153,333</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>광산구</td>
<td>합계</td>
<td>NaN</td>
<td>285,875</td>
<td>156,178</td>
<td>5,244</td>
<td>85,696</td>
<td>6,993</td>
<td>1,952</td>
<td>47,995</td>
<td>3,842</td>
<td>151,722</td>
<td>4,456</td>
<td>129,697</td>
</tr>
</tbody>
</table>

</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-a3a3824a-887b-4e2b-8b36-d5859fff578c')" title="Convert this dataframe to an interactive table." style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"></path>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-a3a3824a-887b-4e2b-8b36-d5859fff578c button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-a3a3824a-887b-4e2b-8b36-d5859fff578c');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-ce0792c2-1cef-49bc-8067-8aea7183e1a3">
      <button class="colab-df-quickchart" onclick="quickchart('df-ce0792c2-1cef-49bc-8067-8aea7183e1a3')" title="Suggest charts" style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"></path>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-ce0792c2-1cef-49bc-8067-8aea7183e1a3 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

  <div id="id_a0c1fd6a-bf0e-4f18-ba11-0b1cf234c0e7">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('gwangju_6th')" title="Generate code using this dataframe." style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"></path>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_a0c1fd6a-bf0e-4f18-ba11-0b1cf234c0e7 button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('gwangju_6th');
      }
      })();
    </script>
  </div>

    </div>
  </div>
</div>
</div>
</section>
<section id="daejeon-3" class="level2">
<h2 class="anchored" data-anchor-id="daejeon-3">Daejeon (3)</h2>
<div id="cell-31" class="cell" data-outputid="2838e350-ce0c-4c77-c297-7a68c0f69bbe" data-execution_count="17">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 깃허브 blob URL로 불러오는 경우 (자동으로 raw URL로 변환됨)</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>blob_url6_daejeon <span class="op">=</span> <span class="st">'https://github.com/sw1kwon/korean-elections/blob/main/original/Local_Elections_Governor/6th_2014/</span><span class="sc">%E</span><span class="st">B%8C</span><span class="sc">%80%</span><span class="st">EC%A0</span><span class="sc">%84%</span><span class="st">EA%B4</span><span class="sc">%91%</span><span class="st">EC</span><span class="sc">%97%</span><span class="st">AD</span><span class="sc">%E</span><span class="st">C%8B%9C.xls'</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>daejeon_6th <span class="op">=</span> process_6th_governor_election3(</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    file_path_or_url <span class="op">=</span> blob_url6_daejeon,</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    header_rows <span class="op">=</span> (<span class="dv">3</span>, <span class="dv">4</span>),</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    filter_column <span class="op">=</span> <span class="st">'읍면동명'</span>,</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    filter_value <span class="op">=</span> <span class="st">'합계'</span>,</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>    add_sheet_name_column<span class="op">=</span><span class="va">True</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>발견된 시트: 5개
시트 이름: ['동구', '중구', '서구', '유성구', '대덕구']


==================================================
시트 1/5: '동구' 처리 중...
==================================================
데이터 행 수: 52
필터링 적용: '읍면동명' == '합계' → 1행
'동구' 시트 처리 완료: 1행 추가됨

==================================================
시트 2/5: '중구' 처리 중...
==================================================
데이터 행 수: 55
필터링 적용: '읍면동명' == '합계' → 1행
'중구' 시트 처리 완료: 1행 추가됨

==================================================
시트 3/5: '서구' 처리 중...
==================================================
데이터 행 수: 73
필터링 적용: '읍면동명' == '합계' → 1행
'서구' 시트 처리 완료: 1행 추가됨

==================================================
시트 4/5: '유성구' 처리 중...
==================================================
데이터 행 수: 34
필터링 적용: '읍면동명' == '합계' → 1행
'유성구' 시트 처리 완료: 1행 추가됨

==================================================
시트 5/5: '대덕구' 처리 중...
==================================================
데이터 행 수: 40
필터링 적용: '읍면동명' == '합계' → 1행
'대덕구' 시트 처리 완료: 1행 추가됨

==================================================
최종 결과: 총 5행의 데이터
==================================================</code></pre>
</div>
</div>
<div id="cell-32" class="cell" data-outputid="43f81d86-7f69-455a-c5cb-9f372248369d" data-execution_count="18">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>daejeon_6th</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">

  <div id="df-bf7d5538-efba-42b6-be93-949350468022" class="colab-df-container">
    <div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">시트명</th>
<th data-quarto-table-cell-role="th">읍면동명</th>
<th data-quarto-table-cell-role="th">구분</th>
<th data-quarto-table-cell-role="th">선거인수</th>
<th data-quarto-table-cell-role="th">투표수</th>
<th data-quarto-table-cell-role="th">후보자별 득표수_새누리당\n박성효</th>
<th data-quarto-table-cell-role="th">새정치민주연합\n권선택</th>
<th data-quarto-table-cell-role="th">통합진보당\n김창근</th>
<th data-quarto-table-cell-role="th">정의당\n한창민</th>
<th data-quarto-table-cell-role="th">계</th>
<th data-quarto-table-cell-role="th">무효\n투표수</th>
<th data-quarto-table-cell-role="th">기권수</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>동구</td>
<td>합계</td>
<td>NaN</td>
<td>202,671</td>
<td>104,754</td>
<td>51,063</td>
<td>48,607</td>
<td>1,422</td>
<td>1,913</td>
<td>103,005</td>
<td>1,749</td>
<td>97,917</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>중구</td>
<td>합계</td>
<td>NaN</td>
<td>213,239</td>
<td>116,220</td>
<td>55,956</td>
<td>55,596</td>
<td>1,209</td>
<td>1,754</td>
<td>114,515</td>
<td>1,705</td>
<td>97,019</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>서구</td>
<td>합계</td>
<td>NaN</td>
<td>389,886</td>
<td>209,058</td>
<td>96,154</td>
<td>104,428</td>
<td>2,608</td>
<td>3,648</td>
<td>206,838</td>
<td>2,220</td>
<td>180,828</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>유성구</td>
<td>합계</td>
<td>NaN</td>
<td>240,489</td>
<td>138,723</td>
<td>57,099</td>
<td>75,806</td>
<td>1,971</td>
<td>2,511</td>
<td>137,387</td>
<td>1,336</td>
<td>101,766</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>대덕구</td>
<td>합계</td>
<td>NaN</td>
<td>161,687</td>
<td>83,916</td>
<td>41,117</td>
<td>38,325</td>
<td>1,799</td>
<td>1,520</td>
<td>82,761</td>
<td>1,155</td>
<td>77,771</td>
</tr>
</tbody>
</table>

</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-bf7d5538-efba-42b6-be93-949350468022')" title="Convert this dataframe to an interactive table." style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"></path>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-bf7d5538-efba-42b6-be93-949350468022 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-bf7d5538-efba-42b6-be93-949350468022');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-a21b4ed1-b881-4018-8ee2-2192c6111635">
      <button class="colab-df-quickchart" onclick="quickchart('df-a21b4ed1-b881-4018-8ee2-2192c6111635')" title="Suggest charts" style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"></path>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-a21b4ed1-b881-4018-8ee2-2192c6111635 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

  <div id="id_07c45d06-0815-4b36-8945-dc3c6d06dd85">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('daejeon_6th')" title="Generate code using this dataframe." style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"></path>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_07c45d06-0815-4b36-8945-dc3c6d06dd85 button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('daejeon_6th');
      }
      })();
    </script>
  </div>

    </div>
  </div>
</div>
</div>
</section>
<section id="ulsan-1" class="level2">
<h2 class="anchored" data-anchor-id="ulsan-1">Ulsan (1)</h2>
<div id="cell-34" class="cell" data-outputid="be6e1b1b-8db1-4ee7-b178-9807d5acf3b7" data-execution_count="19">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 깃허브 blob URL로 불러오는 경우 (자동으로 raw URL로 변환됨)</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>blob_url6_ulsan <span class="op">=</span> <span class="st">'https://github.com/sw1kwon/korean-elections/blob/main/original/Local_Elections_Governor/6th_2014/</span><span class="sc">%E</span><span class="st">C%9A%B8</span><span class="sc">%E</span><span class="st">C</span><span class="sc">%82%</span><span class="st">B0</span><span class="sc">%E</span><span class="st">A%B4</span><span class="sc">%91%</span><span class="st">EC</span><span class="sc">%97%</span><span class="st">AD</span><span class="sc">%E</span><span class="st">C%8B%9C.xls'</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>ulsan_6th <span class="op">=</span> process_6th_governor_election1(</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>    file_path_or_url <span class="op">=</span> blob_url6_ulsan,</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>    header_rows <span class="op">=</span> (<span class="dv">3</span>, <span class="dv">4</span>),</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>    filter_column <span class="op">=</span> <span class="st">'구분'</span>,</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>    filter_value <span class="op">=</span> <span class="st">'합계'</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>헤더 행: 3행 ~ 4행
생성된 컬럼 수: 11
데이터 행 수: 189

생성된 컬럼명 (처음 10개):
0: 구시군명
1: 읍면동명
2: 구분
3: 선거인수
4: 투표수
5: 후보자별 득표수_새누리당
김기현
6: 정의당
조승수
7: 노동당
이갑용
8: 계
9: 무효
투표수

'구분' 컬럼 발견: 구분
필터링 전: 189행 → 필터링 후: 6행
'구분' == '합계'인 행만 추출</code></pre>
</div>
</div>
<div id="cell-35" class="cell" data-outputid="139be60e-f32d-413a-b34f-6c0098428138" data-execution_count="20">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>ulsan_6th</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="20">

  <div id="df-b038f702-0354-438f-b4f3-c7498c0b1551" class="colab-df-container">
    <div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">구시군명</th>
<th data-quarto-table-cell-role="th">읍면동명</th>
<th data-quarto-table-cell-role="th">구분</th>
<th data-quarto-table-cell-role="th">선거인수</th>
<th data-quarto-table-cell-role="th">투표수</th>
<th data-quarto-table-cell-role="th">후보자별 득표수_새누리당\n김기현</th>
<th data-quarto-table-cell-role="th">정의당\n조승수</th>
<th data-quarto-table-cell-role="th">노동당\n이갑용</th>
<th data-quarto-table-cell-role="th">계</th>
<th data-quarto-table-cell-role="th">무효\n투표수</th>
<th data-quarto-table-cell-role="th">기권수</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>울산광역시</td>
<td>NaN</td>
<td>합계</td>
<td>912,325</td>
<td>511,881</td>
<td>306,311</td>
<td>123,736</td>
<td>38,107</td>
<td>468,154</td>
<td>43,727</td>
<td>400,444</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>중구</td>
<td>NaN</td>
<td>합계</td>
<td>189,218</td>
<td>106,699</td>
<td>66,129</td>
<td>24,913</td>
<td>6,912</td>
<td>97,954</td>
<td>8,745</td>
<td>82,519</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">44</td>
<td>남구</td>
<td>NaN</td>
<td>합계</td>
<td>277,480</td>
<td>151,643</td>
<td>95,192</td>
<td>36,887</td>
<td>8,032</td>
<td>140,111</td>
<td>11,532</td>
<td>125,837</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">90</td>
<td>동구</td>
<td>NaN</td>
<td>합계</td>
<td>141,266</td>
<td>81,696</td>
<td>44,961</td>
<td>17,794</td>
<td>10,811</td>
<td>73,566</td>
<td>8,130</td>
<td>59,570</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">121</td>
<td>북구</td>
<td>NaN</td>
<td>합계</td>
<td>139,347</td>
<td>79,777</td>
<td>42,353</td>
<td>24,380</td>
<td>6,698</td>
<td>73,431</td>
<td>6,346</td>
<td>59,570</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">149</td>
<td>울주군</td>
<td>NaN</td>
<td>합계</td>
<td>165,014</td>
<td>92,066</td>
<td>57,676</td>
<td>19,762</td>
<td>5,654</td>
<td>83,092</td>
<td>8,974</td>
<td>72,948</td>
</tr>
</tbody>
</table>

</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-b038f702-0354-438f-b4f3-c7498c0b1551')" title="Convert this dataframe to an interactive table." style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"></path>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-b038f702-0354-438f-b4f3-c7498c0b1551 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-b038f702-0354-438f-b4f3-c7498c0b1551');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-fe1a6934-2825-41f5-9880-ec4a08bf8a13">
      <button class="colab-df-quickchart" onclick="quickchart('df-fe1a6934-2825-41f5-9880-ec4a08bf8a13')" title="Suggest charts" style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"></path>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-fe1a6934-2825-41f5-9880-ec4a08bf8a13 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

  <div id="id_a4ab3e13-9143-488b-bae7-9fed4b1faab1">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('ulsan_6th')" title="Generate code using this dataframe." style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"></path>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_a4ab3e13-9143-488b-bae7-9fed4b1faab1 button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('ulsan_6th');
      }
      })();
    </script>
  </div>

    </div>
  </div>
</div>
</div>
</section>
<section id="sejong-5" class="level2">
<h2 class="anchored" data-anchor-id="sejong-5">Sejong (5)</h2>
<div id="cell-37" class="cell" data-outputid="d5138ce7-5486-43a9-c4cc-9007c2355e94" data-execution_count="21">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 깃허브 blob URL로 불러오는 경우 (자동으로 raw URL로 변환됨)</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>blob_url6_sejong <span class="op">=</span> <span class="st">'https://github.com/sw1kwon/korean-elections/blob/main/original/Local_Elections_Governor/6th_2014/</span><span class="sc">%E</span><span class="st">C%A0%9C6</span><span class="sc">%E</span><span class="st">D%9A%8C</span><span class="sc">%20%</span><span class="st">EC%A0</span><span class="sc">%84%</span><span class="st">EA%B5%AD</span><span class="sc">%E</span><span class="st">B</span><span class="sc">%8F%99%</span><span class="st">EC%8B%9C</span><span class="sc">%E</span><span class="st">C%A7</span><span class="sc">%80%</span><span class="st">EB%B0%A9</span><span class="sc">%E</span><span class="st">C</span><span class="sc">%84%</span><span class="st">A0</span><span class="sc">%E</span><span class="st">A%B1%B0</span><span class="sc">%20%</span><span class="st">EC%9D%8D</span><span class="sc">%E</span><span class="st">B%A9%B4</span><span class="sc">%E</span><span class="st">B</span><span class="sc">%8F%99%</span><span class="st">EB%B3</span><span class="sc">%84%</span><span class="st">20</span><span class="sc">%E</span><span class="st">A%B0%9C</span><span class="sc">%E</span><span class="st">D</span><span class="sc">%91%</span><span class="st">9C</span><span class="sc">%E</span><span class="st">C</span><span class="sc">%9E%90%</span><span class="st">EB%A3%8C(</span><span class="sc">%E</span><span class="st">C</span><span class="sc">%84%</span><span class="st">B8</span><span class="sc">%E</span><span class="st">C%A2%85).xlsx'</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>sejong_6th <span class="op">=</span> process_6th_governor_election5(</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>    file_path_or_url <span class="op">=</span> blob_url6_sejong,</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>    header_rows <span class="op">=</span> (<span class="dv">3</span>, <span class="dv">4</span>),</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>    filter_column <span class="op">=</span> <span class="st">'읍면동명'</span>,</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>    filter_value <span class="op">=</span> <span class="st">'합  계'</span>,</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>    add_sheet_name_column <span class="op">=</span> <span class="va">False</span>,</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>    sheet_names <span class="op">=</span> <span class="st">'세종시장선거'</span>  <span class="co"># 시장 선거 데이터만</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>파일의 전체 시트: 4개
시트 목록: ['세종시장선거', '세종시교육감선거', '세종시의원선거', '비례대표세종시의원선거']

선택된 시트 1개를 처리합니다: ['세종시장선거']

==================================================
시트 1/1: '세종시장선거' 처리 중...
==================================================
데이터 행 수: 40
필터링 적용: '읍면동명' == '합  계' → 1행
'세종시장선거' 시트 처리 완료: 1행 추가됨

==================================================
최종 결과: 총 1행의 데이터
==================================================</code></pre>
</div>
</div>
<div id="cell-38" class="cell" data-outputid="2662762f-206f-4688-c408-12d4f8517a5a" data-execution_count="22">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>sejong_6th</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">

  <div id="df-30c7e3d2-bc70-48b2-8d16-9a00cf094a5f" class="colab-df-container">
    <div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">읍면동명</th>
<th data-quarto-table-cell-role="th">구분</th>
<th data-quarto-table-cell-role="th">선거인수</th>
<th data-quarto-table-cell-role="th">투표수</th>
<th data-quarto-table-cell-role="th">유 효 투 표 수 _새누리당\n유한식</th>
<th data-quarto-table-cell-role="th">새정치민주연합\n이춘희</th>
<th data-quarto-table-cell-role="th">계</th>
<th data-quarto-table-cell-role="th">무 효\n투표수</th>
<th data-quarto-table-cell-role="th">기권수</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>합 계</td>
<td>NaN</td>
<td>101559</td>
<td>63629</td>
<td>26451</td>
<td>36203</td>
<td>62654</td>
<td>975</td>
<td>37930</td>
</tr>
</tbody>
</table>

</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-30c7e3d2-bc70-48b2-8d16-9a00cf094a5f')" title="Convert this dataframe to an interactive table." style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"></path>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-30c7e3d2-bc70-48b2-8d16-9a00cf094a5f button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-30c7e3d2-bc70-48b2-8d16-9a00cf094a5f');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


  <div id="id_af4df860-9f0c-42c5-a153-e0f5e2676f89">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('sejong_6th')" title="Generate code using this dataframe." style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"></path>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_af4df860-9f0c-42c5-a153-e0f5e2676f89 button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('sejong_6th');
      }
      })();
    </script>
  </div>

    </div>
  </div>
</div>
</div>
</section>
<section id="gyeonggi-1" class="level2">
<h2 class="anchored" data-anchor-id="gyeonggi-1">Gyeonggi (1)</h2>
<div id="cell-40" class="cell" data-outputid="db30b99e-d79e-4c12-d2f9-77d1518c0301" data-execution_count="23">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 깃허브 blob URL로 불러오는 경우 (자동으로 raw URL로 변환됨)</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>blob_url6_gyeonggi <span class="op">=</span> <span class="st">'https://github.com/sw1kwon/korean-elections/blob/main/original/Local_Elections_Governor/6th_2014/</span><span class="sc">%E</span><span class="st">C%9D%8D</span><span class="sc">%E</span><span class="st">B%A9%B4</span><span class="sc">%E</span><span class="st">B</span><span class="sc">%8F%99%</span><span class="st">EB%B3</span><span class="sc">%84%</span><span class="st">EA%B0%9C</span><span class="sc">%E</span><span class="st">D</span><span class="sc">%91%</span><span class="st">9C</span><span class="sc">%E</span><span class="st">A%B2%B0</span><span class="sc">%E</span><span class="st">A%B3%BC-</span><span class="sc">%E</span><span class="st">A%B2%BD</span><span class="sc">%E</span><span class="st">A%B8%B0</span><span class="sc">%E</span><span class="st">B</span><span class="sc">%8F%84%</span><span class="st">EC%A7</span><span class="sc">%80%</span><span class="st">EC</span><span class="sc">%82%</span><span class="st">AC.xlsx'</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>gyeonggi_6th <span class="op">=</span> process_6th_governor_election1(</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>    file_path_or_url <span class="op">=</span> blob_url6_gyeonggi,</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>    header_rows <span class="op">=</span> (<span class="dv">3</span>, <span class="dv">4</span>),</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>    filter_column <span class="op">=</span> <span class="st">'읍면동명'</span>,</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>    filter_value <span class="op">=</span> <span class="st">'합계'</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>헤더 행: 3행 ~ 4행
생성된 컬럼 수: 10
데이터 행 수: 1826

생성된 컬럼명 (처음 10개):
0: 위원회명
1: 읍면동명
2: 구분
3: 선거인수
4: 투표수
5: 후보자별 득표수_새누리당
남경필
6: 새정치민주연합
김진표
7: 계
8: 무효
투표수
9: 기권수

'읍면동명' 컬럼 발견: 읍면동명
필터링 전: 1826행 → 필터링 후: 44행
'읍면동명' == '합계'인 행만 추출</code></pre>
</div>
</div>
<div id="cell-41" class="cell" data-outputid="89c2cfce-0b43-4c6d-fec8-0e07a26305c0" data-execution_count="24">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>gyeonggi_6th</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">

  <div id="df-1399d654-d04c-425d-a737-112cc6a49340" class="colab-df-container">
    <div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">위원회명</th>
<th data-quarto-table-cell-role="th">읍면동명</th>
<th data-quarto-table-cell-role="th">구분</th>
<th data-quarto-table-cell-role="th">선거인수</th>
<th data-quarto-table-cell-role="th">투표수</th>
<th data-quarto-table-cell-role="th">후보자별 득표수_새누리당\n남경필</th>
<th data-quarto-table-cell-role="th">새정치민주연합\n김진표</th>
<th data-quarto-table-cell-role="th">계</th>
<th data-quarto-table-cell-role="th">무효\n투표수</th>
<th data-quarto-table-cell-role="th">기권수</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>수원시장안구</td>
<td>합계</td>
<td>NaN</td>
<td>236,664</td>
<td>135,841</td>
<td>64,235</td>
<td>68,152</td>
<td>132,387</td>
<td>3,454</td>
<td>100,823</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">34</td>
<td>수원시권선구</td>
<td>합계</td>
<td>NaN</td>
<td>230,904</td>
<td>121,183</td>
<td>58,441</td>
<td>59,901</td>
<td>118,342</td>
<td>2,841</td>
<td>109,721</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">68</td>
<td>수원시팔달구</td>
<td>합계</td>
<td>NaN</td>
<td>203,541</td>
<td>105,744</td>
<td>54,133</td>
<td>48,962</td>
<td>103,095</td>
<td>2,649</td>
<td>97,797</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">105</td>
<td>수원시영통구</td>
<td>합계</td>
<td>NaN</td>
<td>240,776</td>
<td>142,435</td>
<td>58,276</td>
<td>81,424</td>
<td>139,700</td>
<td>2,735</td>
<td>98,341</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">136</td>
<td>성남시수정구</td>
<td>합계</td>
<td>NaN</td>
<td>191,794</td>
<td>97,639</td>
<td>43,871</td>
<td>50,514</td>
<td>94,385</td>
<td>3,254</td>
<td>94,155</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">188</td>
<td>성남시중원구</td>
<td>합계</td>
<td>NaN</td>
<td>211,683</td>
<td>109,445</td>
<td>49,739</td>
<td>55,787</td>
<td>105,526</td>
<td>3,919</td>
<td>102,238</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">225</td>
<td>성남시분당구</td>
<td>합계</td>
<td>NaN</td>
<td>389,934</td>
<td>241,915</td>
<td>123,412</td>
<td>114,263</td>
<td>237,675</td>
<td>4,240</td>
<td>148,019</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">292</td>
<td>의정부시</td>
<td>합계</td>
<td>NaN</td>
<td>345,708</td>
<td>171,491</td>
<td>86,274</td>
<td>80,456</td>
<td>166,730</td>
<td>4,761</td>
<td>174,217</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">341</td>
<td>안양시만안구</td>
<td>합계</td>
<td>NaN</td>
<td>205,999</td>
<td>113,522</td>
<td>56,134</td>
<td>54,398</td>
<td>110,532</td>
<td>2,990</td>
<td>92,477</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">387</td>
<td>안양시동안구</td>
<td>합계</td>
<td>NaN</td>
<td>280,346</td>
<td>168,487</td>
<td>78,311</td>
<td>86,376</td>
<td>164,687</td>
<td>3,800</td>
<td>111,859</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">442</td>
<td>부천시원미구</td>
<td>합계</td>
<td>NaN</td>
<td>358,453</td>
<td>188,538</td>
<td>84,259</td>
<td>99,347</td>
<td>183,606</td>
<td>4,932</td>
<td>169,915</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">506</td>
<td>부천시소사구</td>
<td>합계</td>
<td>NaN</td>
<td>187,946</td>
<td>99,946</td>
<td>45,879</td>
<td>51,284</td>
<td>97,163</td>
<td>2,783</td>
<td>88,000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">537</td>
<td>부천시오정구</td>
<td>합계</td>
<td>NaN</td>
<td>152,304</td>
<td>70,351</td>
<td>31,681</td>
<td>36,284</td>
<td>67,965</td>
<td>2,386</td>
<td>81,953</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">562</td>
<td>광명시</td>
<td>합계</td>
<td>NaN</td>
<td>278,037</td>
<td>158,332</td>
<td>67,520</td>
<td>86,198</td>
<td>153,718</td>
<td>4,614</td>
<td>119,705</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">620</td>
<td>평택시</td>
<td>합계</td>
<td>NaN</td>
<td>347,609</td>
<td>171,360</td>
<td>94,395</td>
<td>70,899</td>
<td>165,294</td>
<td>6,066</td>
<td>176,249</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">690</td>
<td>양주시</td>
<td>합계</td>
<td>NaN</td>
<td>155,368</td>
<td>79,267</td>
<td>43,164</td>
<td>33,414</td>
<td>76,578</td>
<td>2,689</td>
<td>76,101</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">727</td>
<td>동두천시</td>
<td>합계</td>
<td>NaN</td>
<td>78,452</td>
<td>39,840</td>
<td>22,616</td>
<td>15,302</td>
<td>37,918</td>
<td>1,922</td>
<td>38,612</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">755</td>
<td>안산시상록구</td>
<td>합계</td>
<td>NaN</td>
<td>299,910</td>
<td>144,770</td>
<td>64,437</td>
<td>75,485</td>
<td>139,922</td>
<td>4,848</td>
<td>155,140</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">798</td>
<td>안산시단원구</td>
<td>합계</td>
<td>NaN</td>
<td>261,100</td>
<td>124,880</td>
<td>56,336</td>
<td>64,616</td>
<td>120,952</td>
<td>3,928</td>
<td>136,220</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">838</td>
<td>고양시덕양구</td>
<td>합계</td>
<td>NaN</td>
<td>333,205</td>
<td>180,211</td>
<td>86,542</td>
<td>88,974</td>
<td>175,516</td>
<td>4,695</td>
<td>152,994</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">899</td>
<td>고양시일산동구</td>
<td>합계</td>
<td>NaN</td>
<td>226,556</td>
<td>121,054</td>
<td>57,360</td>
<td>60,734</td>
<td>118,094</td>
<td>2,960</td>
<td>105,502</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">936</td>
<td>고양시일산서구</td>
<td>합계</td>
<td>NaN</td>
<td>229,735</td>
<td>128,294</td>
<td>59,921</td>
<td>65,400</td>
<td>125,321</td>
<td>2,973</td>
<td>101,441</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">967</td>
<td>과천시</td>
<td>합계</td>
<td>NaN</td>
<td>55,781</td>
<td>37,348</td>
<td>18,442</td>
<td>17,936</td>
<td>36,378</td>
<td>970</td>
<td>18,433</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">989</td>
<td>의왕시</td>
<td>합계</td>
<td>NaN</td>
<td>127,246</td>
<td>76,051</td>
<td>36,356</td>
<td>37,967</td>
<td>74,323</td>
<td>1,728</td>
<td>51,195</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1011</td>
<td>구리시</td>
<td>합계</td>
<td>NaN</td>
<td>149,953</td>
<td>80,637</td>
<td>39,001</td>
<td>38,521</td>
<td>77,522</td>
<td>3,115</td>
<td>69,316</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1039</td>
<td>남양주시</td>
<td>합계</td>
<td>NaN</td>
<td>484,298</td>
<td>239,611</td>
<td>118,274</td>
<td>115,329</td>
<td>233,603</td>
<td>6,008</td>
<td>244,687</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1091</td>
<td>오산시</td>
<td>합계</td>
<td>NaN</td>
<td>155,953</td>
<td>75,406</td>
<td>35,569</td>
<td>37,501</td>
<td>73,070</td>
<td>2,336</td>
<td>80,547</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1113</td>
<td>화성시</td>
<td>합계</td>
<td>NaN</td>
<td>395,351</td>
<td>201,710</td>
<td>94,621</td>
<td>100,506</td>
<td>195,127</td>
<td>6,583</td>
<td>193,641</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1186</td>
<td>시흥시</td>
<td>합계</td>
<td>NaN</td>
<td>306,248</td>
<td>146,938</td>
<td>68,647</td>
<td>73,960</td>
<td>142,607</td>
<td>4,331</td>
<td>159,310</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1241</td>
<td>군포시</td>
<td>합계</td>
<td>NaN</td>
<td>225,898</td>
<td>131,916</td>
<td>59,309</td>
<td>69,496</td>
<td>128,805</td>
<td>3,111</td>
<td>93,982</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1278</td>
<td>하남시</td>
<td>합계</td>
<td>NaN</td>
<td>118,266</td>
<td>65,360</td>
<td>35,301</td>
<td>28,066</td>
<td>63,367</td>
<td>1,993</td>
<td>52,906</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1312</td>
<td>파주시</td>
<td>합계</td>
<td>NaN</td>
<td>313,844</td>
<td>162,765</td>
<td>83,026</td>
<td>73,317</td>
<td>156,343</td>
<td>6,422</td>
<td>151,079</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1370</td>
<td>여주시</td>
<td>합계</td>
<td>NaN</td>
<td>89,340</td>
<td>47,027</td>
<td>29,493</td>
<td>15,557</td>
<td>45,050</td>
<td>1,977</td>
<td>42,313</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1410</td>
<td>이천시</td>
<td>합계</td>
<td>NaN</td>
<td>159,733</td>
<td>82,477</td>
<td>45,590</td>
<td>32,901</td>
<td>78,491</td>
<td>3,986</td>
<td>77,256</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1456</td>
<td>용인시처인구</td>
<td>합계</td>
<td>NaN</td>
<td>170,458</td>
<td>83,925</td>
<td>46,712</td>
<td>34,382</td>
<td>81,094</td>
<td>2,831</td>
<td>86,533</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1493</td>
<td>용인시수지구</td>
<td>합계</td>
<td>NaN</td>
<td>231,496</td>
<td>136,238</td>
<td>68,171</td>
<td>65,866</td>
<td>134,037</td>
<td>2,201</td>
<td>95,258</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1521</td>
<td>용인시기흥구</td>
<td>합계</td>
<td>NaN</td>
<td>321,010</td>
<td>181,644</td>
<td>85,336</td>
<td>92,713</td>
<td>178,049</td>
<td>3,595</td>
<td>139,366</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1561</td>
<td>안성시</td>
<td>합계</td>
<td>NaN</td>
<td>144,454</td>
<td>74,600</td>
<td>40,542</td>
<td>30,646</td>
<td>71,188</td>
<td>3,412</td>
<td>69,854</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1610</td>
<td>김포시</td>
<td>합계</td>
<td>NaN</td>
<td>248,144</td>
<td>133,058</td>
<td>68,424</td>
<td>61,162</td>
<td>129,586</td>
<td>3,472</td>
<td>115,086</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1650</td>
<td>광주시</td>
<td>합계</td>
<td>NaN</td>
<td>231,073</td>
<td>112,844</td>
<td>57,969</td>
<td>51,532</td>
<td>109,501</td>
<td>3,343</td>
<td>118,229</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1684</td>
<td>포천시</td>
<td>합계</td>
<td>NaN</td>
<td>127,417</td>
<td>64,915</td>
<td>39,490</td>
<td>22,131</td>
<td>61,621</td>
<td>3,294</td>
<td>62,502</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1730</td>
<td>연천군</td>
<td>합계</td>
<td>NaN</td>
<td>38,253</td>
<td>22,624</td>
<td>13,699</td>
<td>7,717</td>
<td>21,416</td>
<td>1,208</td>
<td>15,629</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1764</td>
<td>양평군</td>
<td>합계</td>
<td>NaN</td>
<td>87,602</td>
<td>51,827</td>
<td>32,752</td>
<td>16,634</td>
<td>49,386</td>
<td>2,441</td>
<td>35,775</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1804</td>
<td>가평군</td>
<td>합계</td>
<td>NaN</td>
<td>51,475</td>
<td>33,225</td>
<td>21,321</td>
<td>9,814</td>
<td>31,135</td>
<td>2,090</td>
<td>18,250</td>
</tr>
</tbody>
</table>

</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-1399d654-d04c-425d-a737-112cc6a49340')" title="Convert this dataframe to an interactive table." style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"></path>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-1399d654-d04c-425d-a737-112cc6a49340 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-1399d654-d04c-425d-a737-112cc6a49340');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-64d90bc8-5d80-4137-b7c7-698cf611d89c">
      <button class="colab-df-quickchart" onclick="quickchart('df-64d90bc8-5d80-4137-b7c7-698cf611d89c')" title="Suggest charts" style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"></path>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-64d90bc8-5d80-4137-b7c7-698cf611d89c button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

  <div id="id_2df1728a-5241-47a3-89dc-9a818819fdbf">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('gyeonggi_6th')" title="Generate code using this dataframe." style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"></path>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_2df1728a-5241-47a3-89dc-9a818819fdbf button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('gyeonggi_6th');
      }
      })();
    </script>
  </div>

    </div>
  </div>
</div>
</div>
</section>
<section id="gangwon-1" class="level2">
<h2 class="anchored" data-anchor-id="gangwon-1">Gangwon (1)</h2>
<div id="cell-43" class="cell" data-outputid="e040b30e-f43f-4b59-b9dd-cb21167313cc" data-execution_count="25">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 깃허브 blob URL로 불러오는 경우 (자동으로 raw URL로 변환됨)</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>blob_url6_gangwon <span class="op">=</span> <span class="st">"https://github.com/sw1kwon/korean-elections/blob/main/original/Local_Elections_Governor/6th_2014/</span><span class="sc">%E</span><span class="st">A%B0</span><span class="sc">%95%</span><span class="st">EC%9B</span><span class="sc">%90%</span><span class="st">EB</span><span class="sc">%8F%84%</span><span class="st">EC%A7</span><span class="sc">%80%</span><span class="st">EC</span><span class="sc">%82%</span><span class="st">AC</span><span class="sc">%E</span><span class="st">C</span><span class="sc">%84%</span><span class="st">A0</span><span class="sc">%E</span><span class="st">A%B1%B0.xlsx"</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>gangwon_6th <span class="op">=</span> process_6th_governor_election1(</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>    file_path_or_url <span class="op">=</span> blob_url6_gangwon,</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>    header_rows <span class="op">=</span> (<span class="dv">2</span>, <span class="dv">4</span>),</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>    filter_column <span class="op">=</span> <span class="st">'읍면동명'</span>,</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>    filter_value <span class="op">=</span> <span class="st">'합       계'</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>헤더 행: 2행 ~ 4행
생성된 컬럼 수: 12
데이터 행 수: 637

생성된 컬럼명 (처음 10개):
0: 구시군명
1: 읍면동명
2: 구분
3: 선거인수
(가+나+다)
4: 투표수
(가+나)
5: 유 효 투 표 수 (가)_후 보 자 별 득 표 수_새누리당
최흥집
6: 새정치
민주연합
최문순
7: 통합진보당
이승재
8: 계
9: 무효
투표수
(나)

'읍면동명' 컬럼 발견: 읍면동명
필터링 전: 637행 → 필터링 후: 18행
'읍면동명' == '합       계'인 행만 추출</code></pre>
</div>
</div>
<div id="cell-44" class="cell" data-outputid="deba9324-f8c9-48a2-c3d9-5afffd1d1b80" data-execution_count="26">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>gangwon_6th</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="26">

  <div id="df-f428d1ad-28ad-413f-abb5-4b16eddbf59e" class="colab-df-container">
    <div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">구시군명</th>
<th data-quarto-table-cell-role="th">읍면동명</th>
<th data-quarto-table-cell-role="th">구분</th>
<th data-quarto-table-cell-role="th">선거인수\n(가+나+다)</th>
<th data-quarto-table-cell-role="th">투표수\n(가+나)</th>
<th data-quarto-table-cell-role="th">유 효 투 표 수 (가)_후 보 자 별 득 표 수_새누리당\n최흥집</th>
<th data-quarto-table-cell-role="th">새정치\n민주연합\n최문순</th>
<th data-quarto-table-cell-role="th">통합진보당\n이승재</th>
<th data-quarto-table-cell-role="th">계</th>
<th data-quarto-table-cell-role="th">무효\n투표수\n(나)</th>
<th data-quarto-table-cell-role="th">기권수\n(다)</th>
<th data-quarto-table-cell-role="th">비고</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>강원도</td>
<td>합 계</td>
<td>NaN</td>
<td>1255469</td>
<td>781359</td>
<td>369201</td>
<td>381338</td>
<td>15774</td>
<td>766313</td>
<td>15046</td>
<td>474110</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>춘천시</td>
<td>합 계</td>
<td>NaN</td>
<td>220197</td>
<td>131007</td>
<td>50016</td>
<td>77737</td>
<td>1857</td>
<td>129610</td>
<td>1397</td>
<td>89190</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">80</td>
<td>원주시</td>
<td>합 계</td>
<td>NaN</td>
<td>257088</td>
<td>142997</td>
<td>64877</td>
<td>73995</td>
<td>2442</td>
<td>141314</td>
<td>1683</td>
<td>114091</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">159</td>
<td>강릉시</td>
<td>합 계</td>
<td>NaN</td>
<td>176430</td>
<td>104326</td>
<td>60251</td>
<td>40526</td>
<td>1736</td>
<td>102513</td>
<td>1813</td>
<td>72104</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">226</td>
<td>동해시</td>
<td>합 계</td>
<td>NaN</td>
<td>75796</td>
<td>45629</td>
<td>23041</td>
<td>20786</td>
<td>942</td>
<td>44769</td>
<td>860</td>
<td>30167</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">260</td>
<td>삼척시</td>
<td>합 계</td>
<td>NaN</td>
<td>61597</td>
<td>42406</td>
<td>20875</td>
<td>18782</td>
<td>1514</td>
<td>41171</td>
<td>1235</td>
<td>19191</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">300</td>
<td>태백시</td>
<td>합 계</td>
<td>NaN</td>
<td>40070</td>
<td>27089</td>
<td>13097</td>
<td>12746</td>
<td>449</td>
<td>26292</td>
<td>797</td>
<td>12981</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">359</td>
<td>속초시</td>
<td>합 계</td>
<td>NaN</td>
<td>66777</td>
<td>39108</td>
<td>18718</td>
<td>18821</td>
<td>694</td>
<td>38233</td>
<td>875</td>
<td>27669</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">387</td>
<td>고성군</td>
<td>합 계</td>
<td>NaN</td>
<td>26235</td>
<td>19179</td>
<td>9569</td>
<td>8480</td>
<td>596</td>
<td>18645</td>
<td>534</td>
<td>7056</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">406</td>
<td>양양군</td>
<td>합 계</td>
<td>NaN</td>
<td>23787</td>
<td>17549</td>
<td>8761</td>
<td>7967</td>
<td>383</td>
<td>17111</td>
<td>438</td>
<td>6238</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">428</td>
<td>인제군</td>
<td>합 계</td>
<td>NaN</td>
<td>26601</td>
<td>19690</td>
<td>8642</td>
<td>9978</td>
<td>476</td>
<td>19096</td>
<td>594</td>
<td>6911</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">450</td>
<td>홍천군</td>
<td>합 계</td>
<td>NaN</td>
<td>59010</td>
<td>38566</td>
<td>17292</td>
<td>19274</td>
<td>1066</td>
<td>37632</td>
<td>934</td>
<td>20444</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">484</td>
<td>횡성군</td>
<td>합 계</td>
<td>NaN</td>
<td>38345</td>
<td>26256</td>
<td>13029</td>
<td>11985</td>
<td>652</td>
<td>25666</td>
<td>590</td>
<td>12089</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">515</td>
<td>영월군</td>
<td>합 계</td>
<td>NaN</td>
<td>34273</td>
<td>23290</td>
<td>11646</td>
<td>10556</td>
<td>517</td>
<td>22719</td>
<td>571</td>
<td>10983</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">546</td>
<td>평창군</td>
<td>합 계</td>
<td>NaN</td>
<td>37156</td>
<td>25407</td>
<td>13145</td>
<td>11218</td>
<td>506</td>
<td>24869</td>
<td>538</td>
<td>11749</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">574</td>
<td>화천군</td>
<td>합 계</td>
<td>NaN</td>
<td>20458</td>
<td>14550</td>
<td>6563</td>
<td>7190</td>
<td>378</td>
<td>14131</td>
<td>419</td>
<td>5908</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">593</td>
<td>양구군</td>
<td>합 계</td>
<td>NaN</td>
<td>19118</td>
<td>14482</td>
<td>6250</td>
<td>7422</td>
<td>403</td>
<td>14075</td>
<td>407</td>
<td>4636</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">612</td>
<td>철원군</td>
<td>합 계</td>
<td>NaN</td>
<td>38500</td>
<td>25441</td>
<td>12353</td>
<td>11784</td>
<td>607</td>
<td>24744</td>
<td>697</td>
<td>13059</td>
<td>NaN</td>
</tr>
</tbody>
</table>

</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-f428d1ad-28ad-413f-abb5-4b16eddbf59e')" title="Convert this dataframe to an interactive table." style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"></path>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-f428d1ad-28ad-413f-abb5-4b16eddbf59e button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-f428d1ad-28ad-413f-abb5-4b16eddbf59e');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-a9bca229-a00e-401e-9861-f697795ef123">
      <button class="colab-df-quickchart" onclick="quickchart('df-a9bca229-a00e-401e-9861-f697795ef123')" title="Suggest charts" style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"></path>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-a9bca229-a00e-401e-9861-f697795ef123 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

  <div id="id_cb754d05-8d24-47be-a9b0-2b2b9143be49">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('gangwon_6th')" title="Generate code using this dataframe." style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"></path>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_cb754d05-8d24-47be-a9b0-2b2b9143be49 button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('gangwon_6th');
      }
      })();
    </script>
  </div>

    </div>
  </div>
</div>
</div>
</section>
<section id="chungbuk-5" class="level2">
<h2 class="anchored" data-anchor-id="chungbuk-5">Chungbuk (5)</h2>
<div id="cell-46" class="cell" data-outputid="00a9395f-3359-483d-af91-2321180d24f7" data-execution_count="27">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 깃허브 blob URL로 불러오는 경우 (자동으로 raw URL로 변환됨)</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>blob_url6_chungbuk <span class="op">=</span> <span class="st">'https://github.com/sw1kwon/korean-elections/blob/main/original/Local_Elections_Governor/6th_2014/</span><span class="sc">%E</span><span class="st">B</span><span class="sc">%8F%84%</span><span class="st">EC%A7</span><span class="sc">%80%</span><span class="st">EC</span><span class="sc">%82%</span><span class="st">AC.xls'</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>chungbuk_6th <span class="op">=</span> process_6th_governor_election5(</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>    file_path_or_url <span class="op">=</span> blob_url6_chungbuk,</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>    header_rows <span class="op">=</span> (<span class="dv">3</span>, <span class="dv">4</span>),</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>    filter_column <span class="op">=</span> <span class="va">None</span>,</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>    filter_value <span class="op">=</span> <span class="va">None</span>,</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>    add_sheet_name_column <span class="op">=</span> <span class="va">False</span>,</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>    sheet_names <span class="op">=</span> <span class="st">'개표진행상황_위원회별합계'</span></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>파일의 전체 시트: 14개
시트 목록: ['개표진행상황_위원회별합계', '상당구', '흥덕구', '충주시', '제천시', '단양군', '청원군', '영동군', '보은군', '옥천군', '음성군', '진천군', '괴산군', '증평군']

선택된 시트 1개를 처리합니다: ['개표진행상황_위원회별합계']

==================================================
시트 1/1: '개표진행상황_위원회별합계' 처리 중...
==================================================
데이터 행 수: 15
'개표진행상황_위원회별합계' 시트 처리 완료: 15행 추가됨

==================================================
최종 결과: 총 15행의 데이터
==================================================</code></pre>
</div>
</div>
<div id="cell-47" class="cell" data-outputid="5d221e72-33c9-4304-8c74-4b997c92e8fa" data-execution_count="28">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>chungbuk_6th</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="28">

  <div id="df-f55d8333-e5dc-491e-b7a9-fe4e1dd64ed1" class="colab-df-container">
    <div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">구시군명</th>
<th data-quarto-table-cell-role="th">선거인수</th>
<th data-quarto-table-cell-role="th">투표수</th>
<th data-quarto-table-cell-role="th">후보자별 득표수(득표율)_새누리당\n윤진식</th>
<th data-quarto-table-cell-role="th">새정치민주연합\n이시종</th>
<th data-quarto-table-cell-role="th">통합진보당\n신장호</th>
<th data-quarto-table-cell-role="th">계</th>
<th data-quarto-table-cell-role="th">무효\n투표수</th>
<th data-quarto-table-cell-role="th">기권수</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>합계</td>
<td>1,261,119</td>
<td>741,049</td>
<td>346,152\n(47.68)</td>
<td>361,115\n(49.75)</td>
<td>18,590\n(2.56)</td>
<td>725,857</td>
<td>15,192</td>
<td>520,070</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>청주시상당구</td>
<td>194,201</td>
<td>107,458</td>
<td>51,082\n(48.10)</td>
<td>52,717\n(49.64)</td>
<td>2,382\n(2.24)</td>
<td>106,181</td>
<td>1,277</td>
<td>86,743</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>청주시흥덕구</td>
<td>328,448</td>
<td>178,070</td>
<td>79,126\n(44.91)</td>
<td>92,795\n(52.67)</td>
<td>4,259\n(2.41)</td>
<td>176,180</td>
<td>1,890</td>
<td>150,378</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>충주시</td>
<td>169,145</td>
<td>97,900</td>
<td>49,606\n(51.50)</td>
<td>45,133\n(46.86)</td>
<td>1,571\n(1.63)</td>
<td>96,310</td>
<td>1,590</td>
<td>71,245</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>제천시</td>
<td>112,013</td>
<td>67,732</td>
<td>31,934\n(48.26)</td>
<td>32,605\n(49.28)</td>
<td>1,619\n(2.44)</td>
<td>66,158</td>
<td>1,574</td>
<td>44,281</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>단양군</td>
<td>26,692</td>
<td>18,685</td>
<td>9,313\n(51.52)</td>
<td>8,268\n(45.74)</td>
<td>495\n(2.73)</td>
<td>18,076</td>
<td>609</td>
<td>8,007</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>청원군</td>
<td>123,457</td>
<td>70,847</td>
<td>32,671\n(47.14)</td>
<td>34,629\n(49.96)</td>
<td>2,005\n(2.89)</td>
<td>69,305</td>
<td>1,542</td>
<td>52,610</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>영동군</td>
<td>43,012</td>
<td>30,700</td>
<td>15,150\n(51.23)</td>
<td>13,444\n(45.46)</td>
<td>974\n(3.29)</td>
<td>29,568</td>
<td>1,132</td>
<td>12,312</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>보은군</td>
<td>29,809</td>
<td>22,561</td>
<td>10,416\n(48.31)</td>
<td>10,369\n(48.09)</td>
<td>773\n(3.58)</td>
<td>21,558</td>
<td>1,003</td>
<td>7,248</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>옥천군</td>
<td>44,490</td>
<td>30,898</td>
<td>13,947\n(46.97)</td>
<td>14,869\n(50.08)</td>
<td>872\n(2.93)</td>
<td>29,688</td>
<td>1,210</td>
<td>13,592</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>음성군</td>
<td>76,435</td>
<td>42,055</td>
<td>18,721\n(45.79)</td>
<td>21,018\n(51.41)</td>
<td>1,138\n(2.78)</td>
<td>40,877</td>
<td>1,178</td>
<td>34,380</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>진천군</td>
<td>52,231</td>
<td>31,683</td>
<td>14,742\n(47.69)</td>
<td>14,951\n(48.36)</td>
<td>1,218\n(3.94)</td>
<td>30,911</td>
<td>772</td>
<td>20,548</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>괴산군</td>
<td>33,704</td>
<td>24,261</td>
<td>11,397\n(48.97)</td>
<td>11,032\n(47.40)</td>
<td>841\n(3.61)</td>
<td>23,270</td>
<td>991</td>
<td>9,443</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13</td>
<td>증평군</td>
<td>27,482</td>
<td>18,199</td>
<td>8,047\n(45.27)</td>
<td>9,285\n(52.23)</td>
<td>443\n(2.49)</td>
<td>17,775</td>
<td>424</td>
<td>9,283</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
</tbody>
</table>

</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-f55d8333-e5dc-491e-b7a9-fe4e1dd64ed1')" title="Convert this dataframe to an interactive table." style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"></path>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-f55d8333-e5dc-491e-b7a9-fe4e1dd64ed1 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-f55d8333-e5dc-491e-b7a9-fe4e1dd64ed1');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-8d8791bf-eb7d-4c80-bfe4-5c28bcd90f00">
      <button class="colab-df-quickchart" onclick="quickchart('df-8d8791bf-eb7d-4c80-bfe4-5c28bcd90f00')" title="Suggest charts" style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"></path>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-8d8791bf-eb7d-4c80-bfe4-5c28bcd90f00 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

  <div id="id_ae296b4f-58f6-4590-9b74-503d5dbca188">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('chungbuk_6th')" title="Generate code using this dataframe." style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"></path>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_ae296b4f-58f6-4590-9b74-503d5dbca188 button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('chungbuk_6th');
      }
      })();
    </script>
  </div>

    </div>
  </div>
</div>
</div>
</section>
<section id="chungnam-1" class="level2">
<h2 class="anchored" data-anchor-id="chungnam-1">Chungnam (1)</h2>
<div id="cell-49" class="cell" data-outputid="e75f6ae0-0959-4563-ae92-a61c884ac27b" data-execution_count="29">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 깃허브 blob URL로 불러오는 경우 (자동으로 raw URL로 변환됨)</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>blob_url6_chungnam <span class="op">=</span> <span class="st">'https://github.com/sw1kwon/korean-elections/blob/main/original/Local_Elections_Governor/6th_2014/</span><span class="sc">%E</span><span class="st">C%B6%A9</span><span class="sc">%E</span><span class="st">C%B2%AD</span><span class="sc">%E</span><span class="st">B</span><span class="sc">%82%</span><span class="st">A8</span><span class="sc">%E</span><span class="st">B</span><span class="sc">%8F</span><span class="st">%84.xls'</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>chungnam_6th <span class="op">=</span> process_6th_governor_election1(</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>    file_path_or_url <span class="op">=</span> blob_url6_chungnam,</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>    header_rows <span class="op">=</span> (<span class="dv">3</span>, <span class="dv">4</span>),</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>    filter_column <span class="op">=</span> <span class="st">'읍면동명'</span>,</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>    filter_value <span class="op">=</span> <span class="st">'합계'</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>헤더 행: 3행 ~ 4행
생성된 컬럼 수: 11
데이터 행 수: 685

생성된 컬럼명 (처음 10개):
0: 위원회명
1: 읍면동명
2: 구분
3: 선거인수
4: 투표수
5: 후보자별 득표수_새누리당
정진석
6: 새정치민주연합
안희정
7: 무소속
김기문
8: 계
9: 무효
투표수

'읍면동명' 컬럼 발견: 읍면동명
필터링 전: 685행 → 필터링 후: 16행
'읍면동명' == '합계'인 행만 추출</code></pre>
</div>
</div>
<div id="cell-50" class="cell" data-outputid="dcf8a69b-ec9d-42bf-f5d3-fea9a201bdc5" data-execution_count="30">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>chungnam_6th</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="30">

  <div id="df-96db1cb7-cabf-47d7-a2ca-8f1dfd12c296" class="colab-df-container">
    <div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">위원회명</th>
<th data-quarto-table-cell-role="th">읍면동명</th>
<th data-quarto-table-cell-role="th">구분</th>
<th data-quarto-table-cell-role="th">선거인수</th>
<th data-quarto-table-cell-role="th">투표수</th>
<th data-quarto-table-cell-role="th">후보자별 득표수_새누리당\n정진석</th>
<th data-quarto-table-cell-role="th">새정치민주연합\n안희정</th>
<th data-quarto-table-cell-role="th">무소속\n김기문</th>
<th data-quarto-table-cell-role="th">계</th>
<th data-quarto-table-cell-role="th">무효\n투표수</th>
<th data-quarto-table-cell-role="th">기권수</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>천안시\n서북구</td>
<td>합계</td>
<td>NaN</td>
<td>223113</td>
<td>103339</td>
<td>40623</td>
<td>58379</td>
<td>3198</td>
<td>102200</td>
<td>1139</td>
<td>119774</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">40</td>
<td>천안시\n동남구</td>
<td>합계</td>
<td>NaN</td>
<td>236496</td>
<td>117049</td>
<td>49771</td>
<td>62796</td>
<td>2987</td>
<td>115554</td>
<td>1495</td>
<td>119447</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">98</td>
<td>공주시</td>
<td>합계</td>
<td>NaN</td>
<td>96439</td>
<td>57596</td>
<td>26855</td>
<td>27730</td>
<td>1519</td>
<td>56104</td>
<td>1492</td>
<td>38843</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">150</td>
<td>보령시</td>
<td>합계</td>
<td>NaN</td>
<td>86603</td>
<td>55365</td>
<td>25254</td>
<td>25451</td>
<td>2550</td>
<td>53255</td>
<td>2110</td>
<td>31238</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">202</td>
<td>아산시</td>
<td>합계</td>
<td>NaN</td>
<td>222224</td>
<td>113433</td>
<td>47139</td>
<td>60927</td>
<td>3356</td>
<td>111422</td>
<td>2011</td>
<td>108791</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">257</td>
<td>서산시</td>
<td>합계</td>
<td>NaN</td>
<td>130906</td>
<td>70754</td>
<td>30125</td>
<td>36161</td>
<td>2781</td>
<td>69067</td>
<td>1687</td>
<td>60152</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">306</td>
<td>태안군</td>
<td>합계</td>
<td>NaN</td>
<td>53331</td>
<td>35682</td>
<td>16046</td>
<td>15507</td>
<td>2419</td>
<td>33972</td>
<td>1710</td>
<td>17649</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">334</td>
<td>금산군</td>
<td>합계</td>
<td>NaN</td>
<td>46813</td>
<td>30036</td>
<td>12522</td>
<td>14725</td>
<td>1612</td>
<td>28859</td>
<td>1177</td>
<td>16777</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">368</td>
<td>논산시</td>
<td>합계</td>
<td>NaN</td>
<td>103962</td>
<td>62061</td>
<td>21888</td>
<td>36205</td>
<td>2037</td>
<td>60130</td>
<td>1931</td>
<td>41901</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">417</td>
<td>계룡시</td>
<td>합계</td>
<td>NaN</td>
<td>29874</td>
<td>19557</td>
<td>8353</td>
<td>10274</td>
<td>664</td>
<td>19291</td>
<td>266</td>
<td>10317</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">433</td>
<td>당진시</td>
<td>합계</td>
<td>NaN</td>
<td>128636</td>
<td>69446</td>
<td>29235</td>
<td>35404</td>
<td>2878</td>
<td>67517</td>
<td>1929</td>
<td>59190</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">479</td>
<td>부여군</td>
<td>합계</td>
<td>NaN</td>
<td>61543</td>
<td>38919</td>
<td>18112</td>
<td>17676</td>
<td>1682</td>
<td>37470</td>
<td>1449</td>
<td>22624</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">531</td>
<td>서천군</td>
<td>합계</td>
<td>NaN</td>
<td>50159</td>
<td>33416</td>
<td>14542</td>
<td>16171</td>
<td>1218</td>
<td>31931</td>
<td>1485</td>
<td>16743</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">574</td>
<td>홍성군</td>
<td>합계</td>
<td>NaN</td>
<td>74464</td>
<td>44555</td>
<td>19751</td>
<td>21815</td>
<td>1743</td>
<td>43309</td>
<td>1246</td>
<td>29909</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">611</td>
<td>청양군</td>
<td>합계</td>
<td>NaN</td>
<td>27844</td>
<td>20860</td>
<td>8767</td>
<td>9453</td>
<td>1596</td>
<td>19816</td>
<td>1044</td>
<td>6984</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">645</td>
<td>예산군</td>
<td>합계</td>
<td>NaN</td>
<td>72147</td>
<td>44138</td>
<td>23332</td>
<td>17320</td>
<td>1964</td>
<td>42616</td>
<td>1522</td>
<td>28009</td>
</tr>
</tbody>
</table>

</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-96db1cb7-cabf-47d7-a2ca-8f1dfd12c296')" title="Convert this dataframe to an interactive table." style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"></path>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-96db1cb7-cabf-47d7-a2ca-8f1dfd12c296 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-96db1cb7-cabf-47d7-a2ca-8f1dfd12c296');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-51a5cbdc-ff58-49f0-ad5d-ff5fed4883e5">
      <button class="colab-df-quickchart" onclick="quickchart('df-51a5cbdc-ff58-49f0-ad5d-ff5fed4883e5')" title="Suggest charts" style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"></path>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-51a5cbdc-ff58-49f0-ad5d-ff5fed4883e5 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

  <div id="id_3914bc17-77ce-43cd-8a62-3e23164a4ca5">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('chungnam_6th')" title="Generate code using this dataframe." style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"></path>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_3914bc17-77ce-43cd-8a62-3e23164a4ca5 button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('chungnam_6th');
      }
      })();
    </script>
  </div>

    </div>
  </div>
</div>
</div>
</section>
<section id="jeonbuk-1" class="level2">
<h2 class="anchored" data-anchor-id="jeonbuk-1">Jeonbuk (1)</h2>
<div id="cell-52" class="cell" data-outputid="62475e2c-9e2f-4406-c2c6-e61b2636ae30" data-execution_count="31">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 깃허브 blob URL로 불러오는 경우 (자동으로 raw URL로 변환됨)</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>blob_url6_jeonbuk <span class="op">=</span> <span class="st">'https://github.com/sw1kwon/korean-elections/blob/main/original/Local_Elections_Governor/6th_2014/</span><span class="sc">%E</span><span class="st">C%A0</span><span class="sc">%84%</span><span class="st">EB%9D%BC</span><span class="sc">%E</span><span class="st">B%B6</span><span class="sc">%81%</span><span class="st">EB</span><span class="sc">%8F</span><span class="st">%84.xls'</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>jeonbuk_6th <span class="op">=</span> process_6th_governor_election1(</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>    file_path_or_url <span class="op">=</span> blob_url6_jeonbuk,</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>    header_rows <span class="op">=</span> (<span class="dv">3</span>, <span class="dv">4</span>),</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>    filter_column <span class="op">=</span> <span class="st">'읍면동명'</span>,</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>    filter_value <span class="op">=</span> <span class="st">'합계'</span></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>헤더 행: 3행 ~ 4행
생성된 컬럼 수: 11
데이터 행 수: 812

생성된 컬럼명 (처음 10개):
0: 구시군명
1: 읍면동명
2: 구분
3: 선거인수
4: 투표수
5: 후보자별 득표수_새누리당
박철곤
6: 새정치민주연합
송하진
7: 통합진보당
이광석
8: 계
9: 무효
투표수

'읍면동명' 컬럼 발견: 읍면동명
필터링 전: 812행 → 필터링 후: 16행
'읍면동명' == '합계'인 행만 추출</code></pre>
</div>
</div>
<div id="cell-53" class="cell" data-outputid="736593db-53fa-4298-c1ff-5d406dfde7fe" data-execution_count="32">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>jeonbuk_6th</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="32">

  <div id="df-2f8f4c54-d80c-4047-bc9b-930cb24e5748" class="colab-df-container">
    <div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">구시군명</th>
<th data-quarto-table-cell-role="th">읍면동명</th>
<th data-quarto-table-cell-role="th">구분</th>
<th data-quarto-table-cell-role="th">선거인수</th>
<th data-quarto-table-cell-role="th">투표수</th>
<th data-quarto-table-cell-role="th">후보자별 득표수_새누리당\n박철곤</th>
<th data-quarto-table-cell-role="th">새정치민주연합\n송하진</th>
<th data-quarto-table-cell-role="th">통합진보당\n이광석</th>
<th data-quarto-table-cell-role="th">계</th>
<th data-quarto-table-cell-role="th">무효\n투표수</th>
<th data-quarto-table-cell-role="th">기권수</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>전라북도</td>
<td>합계</td>
<td>NaN</td>
<td>1503242</td>
<td>900029</td>
<td>177172</td>
<td>599654</td>
<td>89337</td>
<td>866163</td>
<td>33866</td>
<td>603213</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>완산구</td>
<td>합계</td>
<td>NaN</td>
<td>283,872</td>
<td>159,841</td>
<td>39,423</td>
<td>99,971</td>
<td>17,298</td>
<td>156,692</td>
<td>3,149</td>
<td>124,031</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">61</td>
<td>덕진구</td>
<td>합계</td>
<td>NaN</td>
<td>221,516</td>
<td>123,206</td>
<td>29,005</td>
<td>77,702</td>
<td>14,026</td>
<td>120,733</td>
<td>2,473</td>
<td>98,310</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">112</td>
<td>군산시</td>
<td>합계</td>
<td>NaN</td>
<td>220,810</td>
<td>117,779</td>
<td>19,923</td>
<td>83,123</td>
<td>10,831</td>
<td>113,877</td>
<td>3,902</td>
<td>103,031</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">199</td>
<td>익산시</td>
<td>합계</td>
<td>NaN</td>
<td>244,122</td>
<td>129,480</td>
<td>22,697</td>
<td>91,000</td>
<td>11,226</td>
<td>124,923</td>
<td>4,557</td>
<td>114,642</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">292</td>
<td>정읍시</td>
<td>합계</td>
<td>NaN</td>
<td>96,960</td>
<td>61,781</td>
<td>9,104</td>
<td>44,302</td>
<td>5,359</td>
<td>58,765</td>
<td>3,016</td>
<td>35,179</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">367</td>
<td>남원시</td>
<td>합계</td>
<td>NaN</td>
<td>70,411</td>
<td>47,558</td>
<td>8,103</td>
<td>32,868</td>
<td>4,594</td>
<td>45,565</td>
<td>1,993</td>
<td>22,853</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">442</td>
<td>김제시</td>
<td>합계</td>
<td>NaN</td>
<td>77,336</td>
<td>51,495</td>
<td>7,317</td>
<td>37,675</td>
<td>3,766</td>
<td>48,758</td>
<td>2,737</td>
<td>25,841</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">505</td>
<td>완주군</td>
<td>합계</td>
<td>NaN</td>
<td>70,666</td>
<td>44,750</td>
<td>9,986</td>
<td>26,815</td>
<td>5,816</td>
<td>42,617</td>
<td>2,133</td>
<td>25,916</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">550</td>
<td>진안군</td>
<td>합계</td>
<td>NaN</td>
<td>23,289</td>
<td>18,439</td>
<td>6,355</td>
<td>9,290</td>
<td>1,789</td>
<td>17,434</td>
<td>1,005</td>
<td>4,850</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">589</td>
<td>무주군</td>
<td>합계</td>
<td>NaN</td>
<td>21,786</td>
<td>17,618</td>
<td>3,408</td>
<td>11,451</td>
<td>1,620</td>
<td>16,479</td>
<td>1,139</td>
<td>4,168</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">613</td>
<td>장수군</td>
<td>합계</td>
<td>NaN</td>
<td>20,087</td>
<td>16,016</td>
<td>2,942</td>
<td>10,370</td>
<td>1,757</td>
<td>15,069</td>
<td>947</td>
<td>4,071</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">640</td>
<td>임실군</td>
<td>합계</td>
<td>NaN</td>
<td>26,103</td>
<td>19,822</td>
<td>4,887</td>
<td>11,167</td>
<td>2,596</td>
<td>18,650</td>
<td>1,172</td>
<td>6,281</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">682</td>
<td>순창군</td>
<td>합계</td>
<td>NaN</td>
<td>25497</td>
<td>19720</td>
<td>2853</td>
<td>13564</td>
<td>2157</td>
<td>18574</td>
<td>1146</td>
<td>5777</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">721</td>
<td>고창군</td>
<td>합계</td>
<td>NaN</td>
<td>51,188</td>
<td>38,091</td>
<td>5,279</td>
<td>26,747</td>
<td>3,698</td>
<td>35,724</td>
<td>2,367</td>
<td>13,097</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">769</td>
<td>부안군</td>
<td>합계</td>
<td>NaN</td>
<td>49,599</td>
<td>34,433</td>
<td>5,890</td>
<td>23,609</td>
<td>2,804</td>
<td>32,303</td>
<td>2,130</td>
<td>15,166</td>
</tr>
</tbody>
</table>

</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-2f8f4c54-d80c-4047-bc9b-930cb24e5748')" title="Convert this dataframe to an interactive table." style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"></path>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-2f8f4c54-d80c-4047-bc9b-930cb24e5748 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-2f8f4c54-d80c-4047-bc9b-930cb24e5748');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-42c1a914-262c-4ba1-bde8-48562677cc18">
      <button class="colab-df-quickchart" onclick="quickchart('df-42c1a914-262c-4ba1-bde8-48562677cc18')" title="Suggest charts" style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"></path>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-42c1a914-262c-4ba1-bde8-48562677cc18 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

  <div id="id_edce9bf6-8da7-4666-a65f-ee879d1e10e2">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('jeonbuk_6th')" title="Generate code using this dataframe." style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"></path>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_edce9bf6-8da7-4666-a65f-ee879d1e10e2 button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('jeonbuk_6th');
      }
      })();
    </script>
  </div>

    </div>
  </div>
</div>
</div>
</section>
<section id="jeonnam-1" class="level2">
<h2 class="anchored" data-anchor-id="jeonnam-1">Jeonnam (1)</h2>
<div id="cell-55" class="cell" data-outputid="d8d02727-9029-481e-e0cc-66521dd03b66" data-execution_count="33">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 깃허브 blob URL로 불러오는 경우 (자동으로 raw URL로 변환됨)</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>blob_url6_jeonnam <span class="op">=</span> <span class="st">'https://github.com/sw1kwon/korean-elections/blob/main/original/Local_Elections_Governor/6th_2014/</span><span class="sc">%E</span><span class="st">C%A0</span><span class="sc">%84%</span><span class="st">EB%9D%BC</span><span class="sc">%E</span><span class="st">B</span><span class="sc">%82%</span><span class="st">A8</span><span class="sc">%E</span><span class="st">B</span><span class="sc">%8F</span><span class="st">%84.xls'</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>jeonnam_6th <span class="op">=</span> process_6th_governor_election1(</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>    file_path_or_url <span class="op">=</span> blob_url6_jeonnam,</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>    header_rows <span class="op">=</span> (<span class="dv">3</span>, <span class="dv">5</span>),</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>    filter_column <span class="op">=</span> <span class="st">'읍면동명'</span>,</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>    filter_value <span class="op">=</span> <span class="st">'합계'</span></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>헤더 행: 3행 ~ 5행
생성된 컬럼 수: 11
데이터 행 수: 980

생성된 컬럼명 (처음 10개):
0: 구시군명
1: 읍면동명
2: 구분
3: 선거인수
4: 투표수
5: 후보자별 득표수_새누리당
이중효
6: 새정치민주연합
이낙연
7: 통합진보당
이성수
8: 계
9: 무효
투표수

'읍면동명' 컬럼 발견: 읍면동명
필터링 전: 980행 → 필터링 후: 23행
'읍면동명' == '합계'인 행만 추출</code></pre>
</div>
</div>
<div id="cell-56" class="cell" data-outputid="e0208f80-43d1-4409-fa56-5a26d4f6759b" data-execution_count="34">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>jeonnam_6th</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="34">

  <div id="df-96a6e33d-5c4e-466c-b6a7-6515031b2df5" class="colab-df-container">
    <div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">구시군명</th>
<th data-quarto-table-cell-role="th">읍면동명</th>
<th data-quarto-table-cell-role="th">구분</th>
<th data-quarto-table-cell-role="th">선거인수</th>
<th data-quarto-table-cell-role="th">투표수</th>
<th data-quarto-table-cell-role="th">후보자별 득표수_새누리당\n이중효</th>
<th data-quarto-table-cell-role="th">새정치민주연합\n이낙연</th>
<th data-quarto-table-cell-role="th">통합진보당\n이성수</th>
<th data-quarto-table-cell-role="th">계</th>
<th data-quarto-table-cell-role="th">무효\n투표수</th>
<th data-quarto-table-cell-role="th">기권수</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>전라남도</td>
<td>합계</td>
<td>NaN</td>
<td>1549440</td>
<td>1015688</td>
<td>92549</td>
<td>755233</td>
<td>120868</td>
<td>968650</td>
<td>47038</td>
<td>533752</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>목포시</td>
<td>합계</td>
<td>NaN</td>
<td>185,570</td>
<td>103,181</td>
<td>8,017</td>
<td>80,860</td>
<td>10,840</td>
<td>99,717</td>
<td>3,464</td>
<td>82,389</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">74</td>
<td>여수시</td>
<td>합계</td>
<td>NaN</td>
<td>232,635</td>
<td>135,390</td>
<td>11,394</td>
<td>104,927</td>
<td>15,608</td>
<td>131,929</td>
<td>3,461</td>
<td>97,245</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">159</td>
<td>순천시</td>
<td>합계</td>
<td>NaN</td>
<td>214,889</td>
<td>126,320</td>
<td>10,695</td>
<td>95,005</td>
<td>16,777</td>
<td>122,477</td>
<td>3,843</td>
<td>88,569</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">235</td>
<td>나주시</td>
<td>합계</td>
<td>NaN</td>
<td>76,122</td>
<td>51,515</td>
<td>4,157</td>
<td>38,556</td>
<td>6,067</td>
<td>48,780</td>
<td>2,735</td>
<td>24,607</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">299</td>
<td>광양시</td>
<td>합계</td>
<td>NaN</td>
<td>115,763</td>
<td>73,537</td>
<td>8,669</td>
<td>52,699</td>
<td>9,775</td>
<td>71,143</td>
<td>2,394</td>
<td>42,226</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">339</td>
<td>담양군</td>
<td>합계</td>
<td>NaN</td>
<td>41,046</td>
<td>29,086</td>
<td>2,627</td>
<td>22,183</td>
<td>3,004</td>
<td>27,814</td>
<td>1,272</td>
<td>11,960</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">379</td>
<td>장성군</td>
<td>합계</td>
<td>NaN</td>
<td>39,166</td>
<td>28,305</td>
<td>3,097</td>
<td>20,673</td>
<td>3,135</td>
<td>26,905</td>
<td>1,400</td>
<td>10,861</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">416</td>
<td>곡성군</td>
<td>합계</td>
<td>NaN</td>
<td>26,872</td>
<td>20,627</td>
<td>1,976</td>
<td>14,497</td>
<td>2,835</td>
<td>19,308</td>
<td>1,319</td>
<td>6,245</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">453</td>
<td>구례군</td>
<td>합계</td>
<td>NaN</td>
<td>23,363</td>
<td>19,041</td>
<td>2,351</td>
<td>12,759</td>
<td>2,796</td>
<td>17,906</td>
<td>1,135</td>
<td>4,322</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">481</td>
<td>고흥군</td>
<td>합계</td>
<td>NaN</td>
<td>61,803</td>
<td>47,246</td>
<td>4,265</td>
<td>33,928</td>
<td>5,233</td>
<td>43,426</td>
<td>3,820</td>
<td>14,557</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">533</td>
<td>보성군</td>
<td>합계</td>
<td>NaN</td>
<td>39,863</td>
<td>29,891</td>
<td>3,182</td>
<td>20,917</td>
<td>3,866</td>
<td>27,965</td>
<td>1,926</td>
<td>9,972</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">573</td>
<td>화순군</td>
<td>합계</td>
<td>NaN</td>
<td>54,937</td>
<td>39,198</td>
<td>3,250</td>
<td>28,881</td>
<td>5,195</td>
<td>37,326</td>
<td>1,872</td>
<td>15,739</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">616</td>
<td>장흥군</td>
<td>합계</td>
<td>NaN</td>
<td>35,493</td>
<td>27,569</td>
<td>2,707</td>
<td>19,126</td>
<td>4,078</td>
<td>25,911</td>
<td>1,658</td>
<td>7,924</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">650</td>
<td>강진군</td>
<td>합계</td>
<td>NaN</td>
<td>33,613</td>
<td>24,567</td>
<td>2,520</td>
<td>17,626</td>
<td>3,035</td>
<td>23,181</td>
<td>1,386</td>
<td>9,046</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">687</td>
<td>완도군</td>
<td>합계</td>
<td>NaN</td>
<td>45,300</td>
<td>34,406</td>
<td>2,998</td>
<td>25,475</td>
<td>3,459</td>
<td>31,932</td>
<td>2,474</td>
<td>10,894</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">727</td>
<td>해남군</td>
<td>합계</td>
<td>NaN</td>
<td>64,806</td>
<td>42,857</td>
<td>3,786</td>
<td>31,339</td>
<td>5,234</td>
<td>40,359</td>
<td>2,498</td>
<td>21,949</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">773</td>
<td>진도군</td>
<td>합계</td>
<td>NaN</td>
<td>27,951</td>
<td>20,840</td>
<td>2,090</td>
<td>14,605</td>
<td>2,549</td>
<td>19,244</td>
<td>1,596</td>
<td>7,111</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">798</td>
<td>영암군</td>
<td>합계</td>
<td>NaN</td>
<td>48,480</td>
<td>33,132</td>
<td>4,173</td>
<td>23,863</td>
<td>3,321</td>
<td>31,357</td>
<td>1,775</td>
<td>15,348</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">835</td>
<td>무안군</td>
<td>합계</td>
<td>NaN</td>
<td>63,647</td>
<td>40,757</td>
<td>3,090</td>
<td>32,041</td>
<td>3,834</td>
<td>38,965</td>
<td>1,792</td>
<td>22,890</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">866</td>
<td>영광군</td>
<td>합계</td>
<td>NaN</td>
<td>47,906</td>
<td>36,009</td>
<td>2,965</td>
<td>26,640</td>
<td>4,876</td>
<td>34,481</td>
<td>1,528</td>
<td>11,897</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">903</td>
<td>함평군</td>
<td>합계</td>
<td>NaN</td>
<td>30,727</td>
<td>21,640</td>
<td>1,800</td>
<td>16,555</td>
<td>2,191</td>
<td>20,546</td>
<td>1,094</td>
<td>9,087</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">934</td>
<td>신안군</td>
<td>합계</td>
<td>NaN</td>
<td>39,488</td>
<td>30,574</td>
<td>2,740</td>
<td>22,078</td>
<td>3,160</td>
<td>27,978</td>
<td>2,596</td>
<td>8,914</td>
</tr>
</tbody>
</table>

</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-96a6e33d-5c4e-466c-b6a7-6515031b2df5')" title="Convert this dataframe to an interactive table." style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"></path>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-96a6e33d-5c4e-466c-b6a7-6515031b2df5 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-96a6e33d-5c4e-466c-b6a7-6515031b2df5');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-ce94fd08-427c-4277-a17c-d56e9de00b8a">
      <button class="colab-df-quickchart" onclick="quickchart('df-ce94fd08-427c-4277-a17c-d56e9de00b8a')" title="Suggest charts" style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"></path>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-ce94fd08-427c-4277-a17c-d56e9de00b8a button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

  <div id="id_134d696c-1b39-4681-a623-9f9a29ad5fab">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('jeonnam_6th')" title="Generate code using this dataframe." style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"></path>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_134d696c-1b39-4681-a623-9f9a29ad5fab button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('jeonnam_6th');
      }
      })();
    </script>
  </div>

    </div>
  </div>
</div>
</div>
</section>
<section id="gyeongbuk-2" class="level2">
<h2 class="anchored" data-anchor-id="gyeongbuk-2">Gyeongbuk (2)</h2>
<div id="cell-58" class="cell" data-outputid="82f80ff0-b04a-431a-fd1d-c6fdcf1195b2" data-execution_count="35">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 깃허브 blob URL로 불러오는 경우 (자동으로 raw URL로 변환됨)</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>blob_url6_gyeonbuk <span class="op">=</span> <span class="st">'https://github.com/sw1kwon/korean-elections/blob/main/original/Local_Elections_Governor/6th_2014/</span><span class="sc">%E</span><span class="st">A%B2%BD</span><span class="sc">%E</span><span class="st">C</span><span class="sc">%83%</span><span class="st">81</span><span class="sc">%E</span><span class="st">B%B6</span><span class="sc">%81%</span><span class="st">EB</span><span class="sc">%8F</span><span class="st">%84.xlsx'</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>gyeonbuk_6th <span class="op">=</span> process_6th_governor_election2(</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>    file_path_or_url <span class="op">=</span> blob_url6_gyeonbuk,</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>    header_rows <span class="op">=</span> (<span class="dv">4</span>, <span class="dv">6</span>),</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>    filter_column <span class="op">=</span> <span class="st">'읍면동명'</span>,</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>    filter_value <span class="op">=</span> [np.nan, <span class="st">'합계'</span>]</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>헤더 행: 4행 ~ 6행
생성된 컬럼 수: 13
데이터 행 수: 1093

생성된 컬럼명 (처음 10개):
0: 구시군별
1: 읍면동명
2: 구분
3: 선거인수
(가+나+다)
4: 투표수
(가+나)
5: 유 효 투 표 수 (가)_후 보 자 별 득 표 수_새누리당
김관용
6: 새정치민주연합
오중기
7: 통합진보당
윤병태
8: 정의당
박창호
9: 계

'읍면동명' 컬럼 발견: 읍면동명
필터링: [nan, '합계'] 값들 중 하나인 행 추출
필터링 전: 1093행 → 필터링 후: 25행</code></pre>
</div>
</div>
<div id="cell-59" class="cell" data-outputid="7ce3a9eb-5a9b-4dc0-8a03-e8d56c554cfc" data-execution_count="36">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>gyeonbuk_6th</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="36">

  <div id="df-2b4547c4-80bc-49af-ba82-6fb50d7e4308" class="colab-df-container">
    <div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">구시군별</th>
<th data-quarto-table-cell-role="th">읍면동명</th>
<th data-quarto-table-cell-role="th">구분</th>
<th data-quarto-table-cell-role="th">선거인수\n(가+나+다)</th>
<th data-quarto-table-cell-role="th">투표수\n(가+나)</th>
<th data-quarto-table-cell-role="th">유 효 투 표 수 (가)_후 보 자 별 득 표 수_새누리당\n김관용</th>
<th data-quarto-table-cell-role="th">새정치민주연합\n오중기</th>
<th data-quarto-table-cell-role="th">통합진보당\n윤병태</th>
<th data-quarto-table-cell-role="th">정의당\n박창호</th>
<th data-quarto-table-cell-role="th">계</th>
<th data-quarto-table-cell-role="th">무 효\n투표수\n(나)</th>
<th data-quarto-table-cell-role="th">기권수\n(다)</th>
<th data-quarto-table-cell-role="th">비고</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>경상북도</td>
<td>NaN</td>
<td>NaN</td>
<td>2211734</td>
<td>1314925</td>
<td>986989</td>
<td>189603</td>
<td>33458</td>
<td>59609</td>
<td>1269659</td>
<td>45266</td>
<td>896809</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>포항시북구</td>
<td>합계</td>
<td>NaN</td>
<td>216200</td>
<td>112449</td>
<td>82655</td>
<td>20064</td>
<td>2017</td>
<td>5017</td>
<td>109753</td>
<td>2696</td>
<td>103751</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">50</td>
<td>포항시남구</td>
<td>합계</td>
<td>NaN</td>
<td>201120</td>
<td>103003</td>
<td>76273</td>
<td>18395</td>
<td>2038</td>
<td>3840</td>
<td>100546</td>
<td>2457</td>
<td>98117</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">96</td>
<td>울릉군</td>
<td>합계</td>
<td>NaN</td>
<td>9344</td>
<td>7490</td>
<td>5925</td>
<td>847</td>
<td>158</td>
<td>242</td>
<td>7172</td>
<td>318</td>
<td>1854</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">109</td>
<td>경주시</td>
<td>합계</td>
<td>NaN</td>
<td>216922</td>
<td>126290</td>
<td>94824</td>
<td>16705</td>
<td>4915</td>
<td>5391</td>
<td>121835</td>
<td>4455</td>
<td>90632</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">182</td>
<td>김천시</td>
<td>합계</td>
<td>NaN</td>
<td>111552</td>
<td>70244</td>
<td>53436</td>
<td>9389</td>
<td>1401</td>
<td>3230</td>
<td>67456</td>
<td>2788</td>
<td>41308</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">252</td>
<td>안동시</td>
<td>합계</td>
<td>NaN</td>
<td>137715</td>
<td>90090</td>
<td>70575</td>
<td>11133</td>
<td>1884</td>
<td>3481</td>
<td>87073</td>
<td>3017</td>
<td>47625</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">328</td>
<td>구미시</td>
<td>합계</td>
<td>NaN</td>
<td>321096</td>
<td>160254</td>
<td>112367</td>
<td>32606</td>
<td>4259</td>
<td>6961</td>
<td>156193</td>
<td>4061</td>
<td>160842</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">413</td>
<td>영주시</td>
<td>합계</td>
<td>NaN</td>
<td>92496</td>
<td>62153</td>
<td>46595</td>
<td>8960</td>
<td>1215</td>
<td>3241</td>
<td>60011</td>
<td>2142</td>
<td>30343</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">474</td>
<td>영천시</td>
<td>합계</td>
<td>NaN</td>
<td>85998</td>
<td>54651</td>
<td>40283</td>
<td>7044</td>
<td>1243</td>
<td>3545</td>
<td>52115</td>
<td>2536</td>
<td>31347</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">526</td>
<td>상주시</td>
<td>합계</td>
<td>NaN</td>
<td>88003</td>
<td>62491</td>
<td>47652</td>
<td>7273</td>
<td>1616</td>
<td>2756</td>
<td>59297</td>
<td>3194</td>
<td>25512</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">602</td>
<td>문경시</td>
<td>합계</td>
<td>NaN</td>
<td>63805</td>
<td>45956</td>
<td>36470</td>
<td>4594</td>
<td>1090</td>
<td>1721</td>
<td>43875</td>
<td>2081</td>
<td>17849</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">648</td>
<td>예천군</td>
<td>합계</td>
<td>NaN</td>
<td>39760</td>
<td>29078</td>
<td>23265</td>
<td>2480</td>
<td>692</td>
<td>1406</td>
<td>27843</td>
<td>1235</td>
<td>10682</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">688</td>
<td>경산시</td>
<td>합계</td>
<td>NaN</td>
<td>201690</td>
<td>103880</td>
<td>78534</td>
<td>15635</td>
<td>3442</td>
<td>3975</td>
<td>101586</td>
<td>2294</td>
<td>97810</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">737</td>
<td>청도군</td>
<td>합계</td>
<td>NaN</td>
<td>39054</td>
<td>28078</td>
<td>21900</td>
<td>2766</td>
<td>726</td>
<td>1533</td>
<td>26925</td>
<td>1153</td>
<td>10976</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">768</td>
<td>고령군</td>
<td>합계</td>
<td>NaN</td>
<td>30145</td>
<td>18392</td>
<td>14097</td>
<td>2188</td>
<td>488</td>
<td>994</td>
<td>17767</td>
<td>625</td>
<td>11753</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">796</td>
<td>성주군</td>
<td>합계</td>
<td>NaN</td>
<td>39541</td>
<td>25175</td>
<td>19701</td>
<td>2750</td>
<td>622</td>
<td>1115</td>
<td>24188</td>
<td>987</td>
<td>14366</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">830</td>
<td>칠곡군</td>
<td>합계</td>
<td>NaN</td>
<td>95973</td>
<td>49053</td>
<td>36261</td>
<td>8149</td>
<td>1155</td>
<td>2106</td>
<td>47671</td>
<td>1382</td>
<td>46920</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">858</td>
<td>군위군</td>
<td>합계</td>
<td>NaN</td>
<td>22266</td>
<td>18042</td>
<td>13330</td>
<td>1676</td>
<td>393</td>
<td>1712</td>
<td>17111</td>
<td>931</td>
<td>4224</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">886</td>
<td>의성군</td>
<td>합계</td>
<td>NaN</td>
<td>50532</td>
<td>36797</td>
<td>29308</td>
<td>3605</td>
<td>732</td>
<td>1430</td>
<td>35075</td>
<td>1722</td>
<td>13735</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">944</td>
<td>청송군</td>
<td>합계</td>
<td>NaN</td>
<td>23703</td>
<td>18396</td>
<td>13495</td>
<td>2042</td>
<td>993</td>
<td>1013</td>
<td>17543</td>
<td>853</td>
<td>5307</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">972</td>
<td>영양군</td>
<td>합계</td>
<td>NaN</td>
<td>16167</td>
<td>12875</td>
<td>9234</td>
<td>1757</td>
<td>349</td>
<td>823</td>
<td>12163</td>
<td>712</td>
<td>3292</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">994</td>
<td>영덕군</td>
<td>합계</td>
<td>NaN</td>
<td>35266</td>
<td>25717</td>
<td>20331</td>
<td>2541</td>
<td>596</td>
<td>1087</td>
<td>24555</td>
<td>1162</td>
<td>9549</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1025</td>
<td>봉화군</td>
<td>합계</td>
<td>NaN</td>
<td>29759</td>
<td>22055</td>
<td>16128</td>
<td>2907</td>
<td>616</td>
<td>1637</td>
<td>21288</td>
<td>767</td>
<td>7704</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1059</td>
<td>울진군</td>
<td>합계</td>
<td>NaN</td>
<td>43627</td>
<td>32316</td>
<td>24350</td>
<td>4097</td>
<td>818</td>
<td>1353</td>
<td>30618</td>
<td>1698</td>
<td>11311</td>
<td>NaN</td>
</tr>
</tbody>
</table>

</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-2b4547c4-80bc-49af-ba82-6fb50d7e4308')" title="Convert this dataframe to an interactive table." style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"></path>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-2b4547c4-80bc-49af-ba82-6fb50d7e4308 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-2b4547c4-80bc-49af-ba82-6fb50d7e4308');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-54a531a0-ad10-4f7b-9cac-c7840881ea66">
      <button class="colab-df-quickchart" onclick="quickchart('df-54a531a0-ad10-4f7b-9cac-c7840881ea66')" title="Suggest charts" style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"></path>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-54a531a0-ad10-4f7b-9cac-c7840881ea66 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

  <div id="id_6b008740-1b3c-4bc8-b588-25d07bc44194">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('gyeonbuk_6th')" title="Generate code using this dataframe." style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"></path>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_6b008740-1b3c-4bc8-b588-25d07bc44194 button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('gyeonbuk_6th');
      }
      })();
    </script>
  </div>

    </div>
  </div>
</div>
</div>
</section>
<section id="gyeongnam-1" class="level2">
<h2 class="anchored" data-anchor-id="gyeongnam-1">Gyeongnam (1)</h2>
<div id="cell-61" class="cell" data-outputid="d0aa8f3f-ec0b-43e5-d39c-009cf474f95d" data-execution_count="37">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 깃허브 blob URL로 불러오는 경우 (자동으로 raw URL로 변환됨)</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>blob_url6_gyeonnam <span class="op">=</span> <span class="st">'https://github.com/sw1kwon/korean-elections/blob/main/original/Local_Elections_Governor/6th_2014/</span><span class="sc">%E</span><span class="st">A%B2%BD</span><span class="sc">%E</span><span class="st">C</span><span class="sc">%83%</span><span class="st">81</span><span class="sc">%E</span><span class="st">B</span><span class="sc">%82%</span><span class="st">A8</span><span class="sc">%E</span><span class="st">B</span><span class="sc">%8F</span><span class="st">%84.xls'</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>gyeonnam_6th <span class="op">=</span> process_6th_governor_election1(</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>    file_path_or_url <span class="op">=</span> blob_url6_gyeonnam,</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>    header_rows <span class="op">=</span> (<span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>    filter_column <span class="op">=</span> <span class="st">'읍면동명'</span>,</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>    filter_value <span class="op">=</span> <span class="st">'합계'</span></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>헤더 행: 2행 ~ 3행
생성된 컬럼 수: 11
데이터 행 수: 1034

생성된 컬럼명 (처음 10개):
0: 구시군
1: 읍면동명
2: 구분
3: 선거인수
4: 투표수
5: 후보자별 득표수_새누리당
홍준표
6: 새정치민주연합
김경수
7: 통합진보당
강병기
8: 계
9: 무효
투표수

'읍면동명' 컬럼 발견: 읍면동명
필터링 전: 1034행 → 필터링 후: 23행
'읍면동명' == '합계'인 행만 추출</code></pre>
</div>
</div>
<div id="cell-62" class="cell" data-outputid="64965099-466c-4eb8-bcbe-05415fe91c66" data-execution_count="38">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>gyeonnam_6th</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="38">

  <div id="df-01c07607-fb8e-4f41-a1b0-2730f5ee98d2" class="colab-df-container">
    <div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">구시군</th>
<th data-quarto-table-cell-role="th">읍면동명</th>
<th data-quarto-table-cell-role="th">구분</th>
<th data-quarto-table-cell-role="th">선거인수</th>
<th data-quarto-table-cell-role="th">투표수</th>
<th data-quarto-table-cell-role="th">후보자별 득표수_새누리당\n홍준표</th>
<th data-quarto-table-cell-role="th">새정치민주연합\n김경수</th>
<th data-quarto-table-cell-role="th">통합진보당\n강병기</th>
<th data-quarto-table-cell-role="th">계</th>
<th data-quarto-table-cell-role="th">무효\n투표수</th>
<th data-quarto-table-cell-role="th">기권수</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>경상남도</td>
<td>합계</td>
<td>NaN</td>
<td>2658347</td>
<td>1589673</td>
<td>913162</td>
<td>559367</td>
<td>79015</td>
<td>1551544</td>
<td>38129</td>
<td>1068674</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>창원시의창구</td>
<td>합계</td>
<td>NaN</td>
<td>204523</td>
<td>114829</td>
<td>59480</td>
<td>47216</td>
<td>6020</td>
<td>112716</td>
<td>2113</td>
<td>89694</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">29</td>
<td>창원시성산구</td>
<td>합계</td>
<td>NaN</td>
<td>185723</td>
<td>111830</td>
<td>50723</td>
<td>52430</td>
<td>7033</td>
<td>110186</td>
<td>1644</td>
<td>73893</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">54</td>
<td>창원시마산합포구</td>
<td>합계</td>
<td>NaN</td>
<td>151800</td>
<td>87780</td>
<td>58522</td>
<td>24933</td>
<td>2756</td>
<td>86211</td>
<td>1569</td>
<td>64020</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">115</td>
<td>창원시마산회원구</td>
<td>합계</td>
<td>NaN</td>
<td>175918</td>
<td>102205</td>
<td>63561</td>
<td>33392</td>
<td>3673</td>
<td>100626</td>
<td>1579</td>
<td>73713</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">158</td>
<td>창원시진해구</td>
<td>합계</td>
<td>NaN</td>
<td>139286</td>
<td>77939</td>
<td>45520</td>
<td>27864</td>
<td>3079</td>
<td>76463</td>
<td>1476</td>
<td>61347</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">207</td>
<td>진주시</td>
<td>합계</td>
<td>NaN</td>
<td>268027</td>
<td>165372</td>
<td>99871</td>
<td>50316</td>
<td>11916</td>
<td>162103</td>
<td>3269</td>
<td>102655</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">307</td>
<td>통영시</td>
<td>합계</td>
<td>NaN</td>
<td>111561</td>
<td>67447</td>
<td>43751</td>
<td>18819</td>
<td>3146</td>
<td>65716</td>
<td>1731</td>
<td>44114</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">356</td>
<td>고성군</td>
<td>합계</td>
<td>NaN</td>
<td>47887</td>
<td>32026</td>
<td>19165</td>
<td>10011</td>
<td>1705</td>
<td>30881</td>
<td>1145</td>
<td>15861</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">402</td>
<td>사천시</td>
<td>합계</td>
<td>NaN</td>
<td>94250</td>
<td>63316</td>
<td>40192</td>
<td>17624</td>
<td>3469</td>
<td>61285</td>
<td>2031</td>
<td>30934</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">448</td>
<td>김해시</td>
<td>합계</td>
<td>NaN</td>
<td>398293</td>
<td>215277</td>
<td>101147</td>
<td>104577</td>
<td>6448</td>
<td>212172</td>
<td>3105</td>
<td>183016</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">509</td>
<td>밀양시</td>
<td>합계</td>
<td>NaN</td>
<td>91584</td>
<td>57972</td>
<td>37634</td>
<td>15739</td>
<td>2812</td>
<td>56185</td>
<td>1787</td>
<td>33612</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">561</td>
<td>거제시</td>
<td>합계</td>
<td>NaN</td>
<td>184572</td>
<td>99983</td>
<td>51133</td>
<td>39825</td>
<td>6587</td>
<td>97545</td>
<td>2438</td>
<td>84589</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">622</td>
<td>의령군</td>
<td>합계</td>
<td>NaN</td>
<td>25981</td>
<td>20115</td>
<td>12394</td>
<td>5027</td>
<td>1586</td>
<td>19007</td>
<td>1108</td>
<td>5866</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">665</td>
<td>함안군</td>
<td>합계</td>
<td>NaN</td>
<td>55705</td>
<td>37580</td>
<td>23366</td>
<td>11035</td>
<td>1935</td>
<td>36336</td>
<td>1244</td>
<td>18125</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">699</td>
<td>창녕군</td>
<td>합계</td>
<td>NaN</td>
<td>54614</td>
<td>33411</td>
<td>24387</td>
<td>6754</td>
<td>1124</td>
<td>32265</td>
<td>1146</td>
<td>21203</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">745</td>
<td>양산시</td>
<td>합계</td>
<td>NaN</td>
<td>222151</td>
<td>119878</td>
<td>66496</td>
<td>46611</td>
<td>4535</td>
<td>117642</td>
<td>2236</td>
<td>102273</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">788</td>
<td>하동군</td>
<td>합계</td>
<td>NaN</td>
<td>43174</td>
<td>33867</td>
<td>19048</td>
<td>10826</td>
<td>2289</td>
<td>32163</td>
<td>1704</td>
<td>9307</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">831</td>
<td>남해군</td>
<td>합계</td>
<td>NaN</td>
<td>41331</td>
<td>31268</td>
<td>19517</td>
<td>8351</td>
<td>1843</td>
<td>29711</td>
<td>1557</td>
<td>10063</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">865</td>
<td>함양군</td>
<td>합계</td>
<td>NaN</td>
<td>34540</td>
<td>26343</td>
<td>16577</td>
<td>6912</td>
<td>1769</td>
<td>25258</td>
<td>1085</td>
<td>8197</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">902</td>
<td>산청군</td>
<td>합계</td>
<td>NaN</td>
<td>31442</td>
<td>21553</td>
<td>13918</td>
<td>5404</td>
<td>1368</td>
<td>20690</td>
<td>863</td>
<td>9889</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">939</td>
<td>거창군</td>
<td>합계</td>
<td>NaN</td>
<td>52077</td>
<td>36296</td>
<td>23031</td>
<td>9653</td>
<td>2012</td>
<td>34696</td>
<td>1600</td>
<td>15781</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">979</td>
<td>합천군</td>
<td>합계</td>
<td>NaN</td>
<td>43908</td>
<td>33386</td>
<td>23729</td>
<td>6048</td>
<td>1910</td>
<td>31687</td>
<td>1699</td>
<td>10522</td>
</tr>
</tbody>
</table>

</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-01c07607-fb8e-4f41-a1b0-2730f5ee98d2')" title="Convert this dataframe to an interactive table." style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"></path>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-01c07607-fb8e-4f41-a1b0-2730f5ee98d2 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-01c07607-fb8e-4f41-a1b0-2730f5ee98d2');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-d4b101cd-6e98-42ce-9da7-f7c2e362876c">
      <button class="colab-df-quickchart" onclick="quickchart('df-d4b101cd-6e98-42ce-9da7-f7c2e362876c')" title="Suggest charts" style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"></path>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-d4b101cd-6e98-42ce-9da7-f7c2e362876c button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

  <div id="id_ca69fb89-4c1b-43a2-9af3-151963d198e4">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('gyeonnam_6th')" title="Generate code using this dataframe." style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"></path>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_ca69fb89-4c1b-43a2-9af3-151963d198e4 button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('gyeonnam_6th');
      }
      })();
    </script>
  </div>

    </div>
  </div>
</div>
</div>
</section>
<section id="jeju-2" class="level2">
<h2 class="anchored" data-anchor-id="jeju-2">Jeju (2)</h2>
<div id="cell-64" class="cell" data-outputid="fb781593-7ced-4bb0-9b80-22949de30dee" data-execution_count="39">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 깃허브 blob URL로 불러오는 경우 (자동으로 raw URL로 변환됨)</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>blob_url6_jeju <span class="op">=</span> <span class="st">'https://github.com/sw1kwon/korean-elections/blob/main/original/Local_Elections_Governor/6th_2014/</span><span class="sc">%E</span><span class="st">C%A0%9C</span><span class="sc">%E</span><span class="st">C%A3%BC</span><span class="sc">%E</span><span class="st">D%8A%B9</span><span class="sc">%E</span><span class="st">B%B3</span><span class="sc">%84%</span><span class="st">EC</span><span class="sc">%9E%90%</span><span class="st">EC%B9</span><span class="sc">%98%</span><span class="st">EB</span><span class="sc">%8F</span><span class="st">%84_</span><span class="sc">%E</span><span class="st">B</span><span class="sc">%8F%84%</span><span class="st">EC%A7</span><span class="sc">%80%</span><span class="st">EC</span><span class="sc">%82%</span><span class="st">AC.xls'</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>jeju_6th <span class="op">=</span> process_6th_governor_election2(</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>    file_path_or_url <span class="op">=</span> blob_url6_jeju,</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>    header_rows <span class="op">=</span> (<span class="dv">3</span>, <span class="dv">4</span>),</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>    filter_column <span class="op">=</span> <span class="st">'읍면동명'</span>,</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>    filter_value <span class="op">=</span> [np.nan, <span class="st">'소계'</span>]</span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>헤더 행: 3행 ~ 4행
생성된 컬럼 수: 12
데이터 행 수: 138

생성된 컬럼명 (처음 10개):
0: 구시군명
1: 읍면동명
2: 구분
3: 선거인수
4: 투표수
5: 후보자별 득표수_새누리당
원희룡
6: 새정치민주연합
신구범
7: 통합진보당
고승완
8: 새정치당
주종근
9: 계

'읍면동명' 컬럼 발견: 읍면동명
필터링: [nan, '소계'] 값들 중 하나인 행 추출
필터링 전: 138행 → 필터링 후: 3행</code></pre>
</div>
</div>
<div id="cell-65" class="cell" data-outputid="f6b340be-c27e-413c-a694-f7e1d9a17876" data-execution_count="40">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>jeju_6th</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="40">

  <div id="df-4d553a81-370d-4fbf-a7c7-312473491e1b" class="colab-df-container">
    <div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">구시군명</th>
<th data-quarto-table-cell-role="th">읍면동명</th>
<th data-quarto-table-cell-role="th">구분</th>
<th data-quarto-table-cell-role="th">선거인수</th>
<th data-quarto-table-cell-role="th">투표수</th>
<th data-quarto-table-cell-role="th">후보자별 득표수_새누리당\n원희룡</th>
<th data-quarto-table-cell-role="th">새정치민주연합\n신구범</th>
<th data-quarto-table-cell-role="th">통합진보당\n고승완</th>
<th data-quarto-table-cell-role="th">새정치당\n주종근</th>
<th data-quarto-table-cell-role="th">계</th>
<th data-quarto-table-cell-role="th">무효\n투표수</th>
<th data-quarto-table-cell-role="th">기권수</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>제주특별자치도</td>
<td>NaN</td>
<td>NaN</td>
<td>467182</td>
<td>293323</td>
<td>172793</td>
<td>99493</td>
<td>12209</td>
<td>3637</td>
<td>288132</td>
<td>5191</td>
<td>173859</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>제주시</td>
<td>소계</td>
<td>NaN</td>
<td>340604</td>
<td>208224</td>
<td>119758</td>
<td>73632</td>
<td>9101</td>
<td>2213</td>
<td>204704</td>
<td>3520</td>
<td>132380</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">83</td>
<td>서귀포시</td>
<td>소계</td>
<td>NaN</td>
<td>126578</td>
<td>85099</td>
<td>53035</td>
<td>25861</td>
<td>3108</td>
<td>1424</td>
<td>83428</td>
<td>1671</td>
<td>41479</td>
</tr>
</tbody>
</table>

</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-4d553a81-370d-4fbf-a7c7-312473491e1b')" title="Convert this dataframe to an interactive table." style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"></path>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-4d553a81-370d-4fbf-a7c7-312473491e1b button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-4d553a81-370d-4fbf-a7c7-312473491e1b');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-119dcb88-0447-413f-8aa7-72e54006cdef">
      <button class="colab-df-quickchart" onclick="quickchart('df-119dcb88-0447-413f-8aa7-72e54006cdef')" title="Suggest charts" style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"></path>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-119dcb88-0447-413f-8aa7-72e54006cdef button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

  <div id="id_119e5601-6bff-418a-9cf1-d22dbf79dada">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('jeju_6th')" title="Generate code using this dataframe." style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"></path>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_119e5601-6bff-418a-9cf1-d22dbf79dada button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('jeju_6th');
      }
      })();
    </script>
  </div>

    </div>
  </div>
</div>
</div>
</section>
</section>
<section id="batch-csv-files-to-zip" class="level1">
<h1>Batch CSV Files to ZIP</h1>
<div id="cell-67" class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> zipfile</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> glob</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Find all CSV files in current directory</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>csv_files <span class="op">=</span> glob.glob(<span class="st">'*.csv'</span>)</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create ZIP file</span></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> zipfile.ZipFile(<span class="st">'all_csv_files.zip'</span>, <span class="st">'w'</span>) <span class="im">as</span> zipf:</span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>   <span class="cf">for</span> <span class="bu">file</span> <span class="kw">in</span> csv_files:</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>       zipf.write(<span class="bu">file</span>)</span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>       <span class="bu">print</span>(<span class="ss">f"Added: </span><span class="sc">{</span><span class="bu">file</span><span class="sc">}</span><span class="ss">"</span>)  <span class="co"># Show progress</span></span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Total </span><span class="sc">{</span><span class="bu">len</span>(csv_files)<span class="sc">}</span><span class="ss"> files compressed."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>